; /* /bitrix/js/main/json/json2.min.js*/
; /* /bitrix/js/main/core/core_ls.js*/
; /* /bitrix/js/main/core/core_fx.js*/
; /* /bitrix/js/main/core/core_popup.js*/
; /* /bitrix/js/main/core/core.js*/
; /* /bitrix/js/main/session.js*/

; /* Start:/bitrix/js/main/core/core.js*/
!function(window){function bindReady(){if(!readyBound){if(readyBound=!0,"complete"===document.readyState)return runReady();if(document.addEventListener)document.addEventListener("DOMContentLoaded",__readyHandler,!1),window.addEventListener("load",runReady,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",__readyHandler),window.attachEvent("onload",runReady);var t=!1;try{t=null==window.frameElement}catch(e){}document.documentElement.doScroll&&t&&doScrollCheck()}}return null}function runReady(){if(!BX.isReady){if(!document.body)return setTimeout(runReady,15);if(BX.isReady=!0,readyList&&readyList.length>0){for(var t,e=0;readyList&&(t=readyList[e++]);)try{t.call(document)}catch(i){BX.debug("BX.ready error: ",i)}readyList=null}}return null}function doScrollCheck(){if(!BX.isReady){try{document.documentElement.doScroll("left")}catch(t){return void setTimeout(doScrollCheck,1)}runReady()}}function _adjustWait(){if(this.bxmsg){var t=BX.pos(this),e=t.top;e<BX.GetDocElement().scrollTop&&(e=BX.GetDocElement().scrollTop+5),this.bxmsg.style.top=e+5+"px",this==BX.GetDocElement()?this.bxmsg.style.right="5px":this.bxmsg.style.left=t.right-this.bxmsg.offsetWidth-5+"px"}}function _checkDisplay(t,e){"undefined"!=typeof e&&(t.BXDISPLAY=e);var i=t.style.display||BX.style(t,"display");return"none"!=i?(t.BXDISPLAY=t.BXDISPLAY||i,!0):(t.BXDISPLAY=t.BXDISPLAY||"block",!1)}function _processTpl(t,e,i){if(t){i&&t.parentNode.removeChild(t);for(var o={},n=BX.findChildren(t,{attribute:"data-role"},!0),s=0,r=n.length;r>s;s++)o[n[s].getAttribute("data-role")]=n[s];e.apply(t,[o])}}function _checkNode(t,e){if(e=e||{},BX.type.isFunction(e))return e.call(window,t);if(!e.allowTextNodes&&!BX.type.isElementNode(t))return!1;var i,o,n;for(i in e)if(e.hasOwnProperty(i))switch(i){case"tag":case"tagName":if(BX.type.isString(e[i])){if(t.tagName.toUpperCase()!=e[i].toUpperCase())return!1}else if(e[i]instanceof RegExp&&!e[i].test(t.tagName))return!1;break;case"class":case"className":if(BX.type.isString(e[i])){if(!BX.hasClass(t,e[i]))return!1}else if(e[i]instanceof RegExp&&(!BX.type.isString(t.className)||!e[i].test(t.className)))return!1;break;case"attr":case"attribute":if(BX.type.isString(e[i])){if(!t.getAttribute(e[i]))return!1}else if(BX.type.isArray(e[i])){for(o=0,n=e[i].length;n>o;o++)if(e[i]&&!t.getAttribute(e[i]))return!1}else for(o in e[i])if(e[i].hasOwnProperty(o)){var s=t.getAttribute(o);if(e[i][o]instanceof RegExp){if(!BX.type.isString(s)||!e[i][o].test(s))return!1}else if(s!=""+e[i][o])return!1}break;case"property":if(BX.type.isString(e[i])){if(!t[e[i]])return!1}else if(BX.type.isArray(e[i])){for(o=0,n=e[i].length;n>o;o++)if(e[i]&&!t[e[i]])return!1}else for(o in e[i])if(BX.type.isString(e[i][o])){if(t[o]!=e[i][o])return!1}else if(e[i][o]instanceof RegExp&&(!BX.type.isString(t[o])||!e[i][o].test(t[o])))return!1;break;case"callback":return e[i](t)}return!0}function _isCssLoaded(t){if(!cssInit){var e=document.getElementsByTagName("LINK");if(e&&e.length>0)for(var i=0;i<e.length;i++){var o=e[i].getAttribute("href");BX.type.isNotEmptyString(o)&&cssList.push(BX.getCSSPath(o))}cssInit=!0}return BX.util.in_array(t,cssList)}function _getTemplateLink(t){var e=function(e){for(var i=t.getElementsByTagName(e),o=0,n=i.length;n>o;o++){var s=i[o].getAttribute("data-template-style");if(BX.type.isNotEmptyString(s)&&"true"==s)return i[o]}return null},i=e("link");return null===i&&(i=e("style")),i}function _isScriptLoaded(t){if(!jsInit){var e=document.getElementsByTagName("script");if(e&&e.length>0)for(var i=0;i<e.length;i++){var o=e[i].getAttribute("src");BX.type.isNotEmptyString(o)&&jsList.push(BX.getJSPath(o))}jsInit=!0}return BX.util.in_array(t,jsList)}function Trash(){var t,e;for(t=0,e=garbageCollectors.length;e>t;t++)try{garbageCollectors[t].callback.apply(garbageCollectors[t].context||window),delete garbageCollectors[t],garbageCollectors[t]=null}catch(i){}try{BX.unbindAll()}catch(i){}}if(!window.BX||!window.BX.extend){window.BXDEBUG=!1;var _bxtmp;if(window.BX&&(_bxtmp=window.BX),window.BX=function(t,e){if(BX.type.isNotEmptyString(t)){var i;return e&&null!=NODECACHE[t]&&(i=NODECACHE[t]),i=i||document.getElementById(t),e&&(NODECACHE[t]=i),i}return BX.type.isDomNode(t)?t:BX.type.isFunction(t)?BX.ready(t):null},BX.message=function(t){if(BX.type.isString(t))return"undefined"==typeof BX.message[t]&&(BX.onCustomEvent("onBXMessageNotFound",[t]),"undefined"==typeof BX.message[t]&&(BX.debug("message undefined: "+t),BX.message[t]="")),BX.message[t];for(var e in t)t.hasOwnProperty(e)&&(BX.message[e]=t[e]);return!0},_bxtmp){for(var i in _bxtmp)if(_bxtmp.hasOwnProperty(i))if(BX[i]){if("message"==i)for(var j in _bxtmp[i])_bxtmp[i].hasOwnProperty(j)&&(BX.message[j]=_bxtmp[i][j])}else BX[i]=_bxtmp[i];_bxtmp=null}var __readyHandler=null,readyBound=!1,readyList=[],proxySalt=Math.random(),proxyId=1,proxyList=[],deferList=[],NODECACHE={},deniedEvents=[],eventsList=[],customEvents={},garbageCollectors=[],cssList=[],cssInit=!1,jsList=[],jsInit=!1,bSafari=-1!=navigator.userAgent.toLowerCase().indexOf("webkit"),bOpera=-1!=navigator.userAgent.toLowerCase().indexOf("opera"),bFirefox=-1!=navigator.userAgent.toLowerCase().indexOf("firefox"),bChrome=-1!=navigator.userAgent.toLowerCase().indexOf("chrome"),bIE=document.attachEvent&&!bOpera,r={script:/<script([^>]*)>/i,script_src:/src=["\']([^"\']+)["\']/i,space:/\s+/,ltrim:/^[\s\r\n]+/g,rtrim:/[\s\r\n]+$/g,style:/<link.*?(rel="stylesheet"|type="text\/css")[^>]*>/i,style_href:/href=["\']([^"\']+)["\']/i},eventTypes={click:"MouseEvent",dblclick:"MouseEvent",mousedown:"MouseEvent",mousemove:"MouseEvent",mouseout:"MouseEvent",mouseover:"MouseEvent",mouseup:"MouseEvent",focus:"MouseEvent",blur:"MouseEvent"},lastWait=[],CHECK_FORM_ELEMENTS={tagName:/^INPUT|SELECT|TEXTAREA|BUTTON$/i};BX.MSLEFT=1,BX.MSMIDDLE=2,BX.MSRIGHT=4,BX.ext=function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e])},BX.extend=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e)},BX.namespace=function(t){var e=t.split("."),i=BX;"BX"===e[0]&&(e=e.slice(1));for(var o=0;o<e.length;o++)"undefined"==typeof i[e[o]]&&(i[e[o]]={}),i=i[e[o]];return i},BX.debug=function(){window.BXDEBUG&&(window.console&&window.console.log&&window.console.log("BX.debug: ",arguments.length>0?arguments:arguments[0]),window.console&&window.console.trace&&console.trace())},BX.is_subclass_of=function(t,e){return t instanceof e?!0:e.superclass?BX.is_subclass_of(t,e.superclass):!1},BX.clearNodeCache=function(){return NODECACHE={},!1},BX.bitrix_sessid=function(){return BX.message("bitrix_sessid")},BX.create=function(t,e,i){i=i||document,null==e&&"object"==typeof t&&t.constructor!==String&&(e=t,t=t.tag);var o;return o=BX.browser.IsIE()&&!BX.browser.IsIE9()&&null!=e&&null!=e.props&&(e.props.name||e.props.id)?i.createElement("<"+t+(e.props.name?' name="'+e.props.name+'"':"")+(e.props.id?' id="'+e.props.id+'"':"")+">"):i.createElement(t),e?BX.adjust(o,e):o},BX.adjust=function(t,e){var i,o;if(!t.nodeType)return null;if(9==t.nodeType&&(t=t.body),e.attrs)for(i in e.attrs)e.attrs.hasOwnProperty(i)&&("class"==i||"className"==i?t.className=e.attrs[i]:"for"==i?t.htmlFor=e.attrs[i]:""==e.attrs[i]?t.removeAttribute(i):t.setAttribute(i,e.attrs[i]));if(e.style)for(i in e.style)e.style.hasOwnProperty(i)&&(t.style[i]=e.style[i]);if(e.props)for(i in e.props)e.props.hasOwnProperty(i)&&(t[i]=e.props[i]);if(e.events)for(i in e.events)e.events.hasOwnProperty(i)&&BX.bind(t,i,e.events[i]);if(e.children&&e.children.length>0)for(i=0,o=e.children.length;o>i;i++)BX.type.isNotEmptyString(e.children[i])?t.innerHTML+=e.children[i]:BX.type.isElementNode(e.children[i])&&t.appendChild(e.children[i]);else e.text?(BX.cleanNode(t),t.appendChild((t.ownerDocument||document).createTextNode(e.text))):e.html&&(t.innerHTML=e.html);return t},BX.remove=function(t){return t&&null!=t.parentNode&&t.parentNode.removeChild(t),t=null,null},BX.cleanNode=function(t,e){if(t=BX(t),e=!!e,t&&t.childNodes)for(;t.childNodes.length>0;)t.removeChild(t.firstChild);return t&&e&&(t=BX.remove(t)),t},BX.addClass=function(t,e){var i;if(t=BX(t),e=BX.util.trim(e),""==e)return t;if(t)if(t.className)if(t.classList&&e.indexOf(" ")<0)t.classList.add(e);else{i=(e||"").split(r.space);for(var o=" "+t.className+" ",n=0,s=i.length;s>n;n++)o.indexOf(" "+i[n]+" ")<0&&(t.className+=" "+i[n])}else t.className=e;return t},BX.removeClass=function(t,e){if(t=BX(t),t&&t.className&&e)if(BX.type.isString(e))if(t.classList&&e.indexOf(" ")<0)t.classList.remove(e);else{for(var i=e.split(r.space),o=" "+t.className+" ",n=0,s=i.length;s>n;n++)o=o.replace(" "+i[n]+" "," ");t.className=BX.util.trim(o)}else t.className="";return t},BX.toggleClass=function(t,e){var i;if(BX.type.isArray(e)){i=" "+t.className+" ";for(var o=0,n=e.length;n>o;o++)if(BX.hasClass(t,e[o])){i=(" "+i+" ").replace(" "+e[o]+" "," "),i+=" "+e[o>=n-1?0:o+1],o--;break}o==n?t.className+=" "+e[0]:t.className=i,t.className=BX.util.trim(t.className)}else BX.type.isNotEmptyString(e)&&(t.classList?t.classList.toggle(e):(i=t.className,BX.hasClass(t,e)?i=(" "+i+" ").replace(" "+e+" "," "):i+=" "+e,t.className=BX.util.trim(i)));return t},BX.hasClass=function(t,e){return t&&BX.type.isDomNode(t)?t.className&&e?t.classList&&e&&e.indexOf(" ")<0?t.classList.contains(BX.util.trim(e)):(" "+t.className+" ").indexOf(" "+e+" ")>=0:!1:(BX.debug(t),!1)},BX.hoverEvents=function(t){return t?BX.adjust(t,{events:BX.hoverEvents()}):{mouseover:BX.hoverEventsHover,mouseout:BX.hoverEventsHout}},BX.hoverEventsHover=function(){BX.addClass(this,"bx-hover"),this.BXHOVER=!0},BX.hoverEventsHout=function(){BX.removeClass(this,"bx-hover"),this.BXHOVER=!1},BX.focusEvents=function(t){return t?BX.adjust(t,{events:BX.focusEvents()}):{mouseover:BX.focusEventsFocus,mouseout:BX.focusEventsBlur}},BX.focusEventsFocus=function(){BX.addClass(this,"bx-focus"),this.BXFOCUS=!0},BX.focusEventsBlur=function(){BX.removeClass(this,"bx-focus"),this.BXFOCUS=!1},BX.setUnselectable=function(t){BX.addClass(t,"bx-unselectable"),t.setAttribute("unSelectable","on")},BX.setSelectable=function(t){BX.removeClass(t,"bx-unselectable"),t.removeAttribute("unSelectable")},BX.styleIEPropertyName=function(t){if("float"==t)t=BX.browser.IsIE()?"styleFloat":"cssFloat";else{var e=BX.browser.isPropertySupported(t);if(e)t=e;else{var i=/(\-([a-z]){1})/g;i.test(t)&&(t=t.replace(i,function(){return arguments[2].toUpperCase()}))}}return t},BX.style=function(t,e,i){if(!BX.type.isElementNode(t))return null;if(null==i){var o;if(t.currentStyle)o=t.currentStyle[BX.styleIEPropertyName(e)];else if(window.getComputedStyle){var n=BX.browser.isPropertySupported(e,!0);n&&(e=n),o=BX.GetContext(t).getComputedStyle(t,null).getPropertyValue(e)}return o||(o=""),o}return t.style[BX.styleIEPropertyName(e)]=i,t},BX.focus=function(t){try{return t.focus(),!0}catch(e){return!1}},BX.firstChild=function(t){for(var e=t.firstChild;e&&!BX.type.isElementNode(e);)e=e.nextSibling;return e},BX.lastChild=function(t){for(var e=t.lastChild;e&&!BX.type.isElementNode(e);)e=e.previousSibling;return e},BX.previousSibling=function(t){for(var e=t.previousSibling;e&&!BX.type.isElementNode(e);)e=e.previousSibling;return e},BX.nextSibling=function(t){for(var e=t.nextSibling;e&&!BX.type.isElementNode(e);)e=e.nextSibling;return e},BX.findChildren=function(t,e,i){return BX.findChild(t,e,i,!0)},BX.findChild=function(t,e,i,o){if(!t||!t.childNodes)return null;i=!!i,o=!!o;for(var n=t.childNodes.length,s=[],r=0;n>r;r++){var a=t.childNodes[r];if(_checkNode(a,e)){if(!o)return a;s.push(a)}if(1==i){var l=BX.findChild(a,e,i,o);if(l){if(!o)return l;s=BX.util.array_merge(s,l)}}}return o||s.length>0?s:null},BX.findParent=function(t,e,i){if(!t)return null;for(var o=t;o.parentNode;){var n=o.parentNode;if(_checkNode(n,e))return n;if(o=n,i&&(BX.type.isFunction(i)||"object"==typeof i))if(BX.type.isElementNode(i)){if(o==i)break}else if(_checkNode(o,i))break}return null},BX.findNextSibling=function(t,e){if(!t)return null;for(var i=t;i.nextSibling;){var o=i.nextSibling;if(_checkNode(o,e))return o;i=o}return null},BX.findPreviousSibling=function(t,e){if(!t)return null;for(var i=t;i.previousSibling;){var o=i.previousSibling;if(_checkNode(o,e))return o;i=o}return null},BX.findFormElements=function(t){BX.type.isString(t)&&(t=document.forms[t]||BX(t));var e=[];return BX.type.isElementNode(t)&&(e="FORM"==t.tagName.toUpperCase()?t.elements:BX.findChildren(t,CHECK_FORM_ELEMENTS,!0)),e},BX.clone=function(t,e){var i,o,n;if(e!==!1&&(e=!0),null===t)return null;if(BX.type.isDomNode(t))i=t.cloneNode(e);else if("object"==typeof t)if(BX.type.isArray(t))for(i=[],o=0,n=t.length;n>o;o++)"object"==typeof t[o]&&e?i[o]=BX.clone(t[o],e):i[o]=t[o];else{i={},t.constructor&&(i=t.constructor===Date?new Date(t):new t.constructor);for(o in t)"object"==typeof t[o]&&e?i[o]=BX.clone(t[o],e):i[o]=t[o]}else i=t;return i},BX.bind=function(t,e,i){t&&("mousewheel"===e?BX.bind(t,"DOMMouseScroll",i):"transitionend"===e&&(BX.bind(t,"webkitTransitionEnd",i),BX.bind(t,"msTransitionEnd",i),BX.bind(t,"oTransitionEnd",i)),t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent?t.attachEvent("on"+e,BX.proxy(i,t)):t["on"+e]=i,eventsList[eventsList.length]={element:t,event:e,fn:i})},BX.unbind=function(t,e,i){t&&("mousewheel"===e&&BX.unbind(t,"DOMMouseScroll",i),t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent?t.detachEvent("on"+e,BX.proxy(i,t)):t["on"+e]=null)},BX.getEventButton=function(t){t=t||window.event;var e=0;if("undefined"!=typeof t.which)switch(t.which){case 1:e|=BX.MSLEFT;break;case 2:e|=BX.MSMIDDLE;break;case 3:e|=BX.MSRIGHT}else"undefined"!=typeof t.button&&(e=event.button);return e||BX.MSLEFT},BX.unbindAll=function(t){if(t){for(var e=0,i=eventsList.length;i>e;e++)try{!eventsList[e]||null!=t&&t!=eventsList[e].element||(BX.unbind(eventsList[e].element,eventsList[e].event,eventsList[e].fn),eventsList[e]=null)}catch(o){}null==t&&(eventsList=[])}};var captured_events=null,_bind=null;BX.CaptureEvents=function(t,e){return _bind?!1:(_bind=BX.bind,captured_events=[],void(BX.bind=function(i,o,n){i===t&&o===e&&captured_events.push(n),_bind.apply(this,arguments)}))},BX.CaptureEventsGet=function(){if(_bind){BX.bind=_bind;var t=captured_events;return _bind=null,captured_events=null,t}},BX.fireEvent=function(t,e){var i=!1,o=null;if(BX.type.isDomNode(t))if(i=!0,document.createEventObject)"MouseEvent"!=eventTypes[e]&&(o=document.createEventObject(),o.type=e,i=t.fireEvent("on"+e,o)),t[e]&&t[e]();else{switch(o=null,eventTypes[e]){case"MouseEvent":o=document.createEvent("MouseEvent"),o.initMouseEvent(e,!0,!0,top,1,0,0,0,0,0,0,0,0,0,null);break;default:o=document.createEvent("Event"),o.initEvent(e,!0,!0)}i=t.dispatchEvent(o)}return i},BX.getWheelData=function(t){return t=t||window.event,t.wheelData=t.detail?-1*t.detail:t.wheelDelta/40,t.wheelData},BX.proxy_context=null,BX.delegate=function(t,e){return t&&e?function(){var i=BX.proxy_context;BX.proxy_context=this;var o=t.apply(e,arguments);return BX.proxy_context=i,o}:t},BX.delegateLater=function(t,e,i){return function(){if(e[t]){var o=BX.proxy_context;BX.proxy_context=this;var n=e[t].apply(i||e,arguments);return BX.proxy_context=o,n}}},BX._initObjectProxy=function(t){"undefined"==typeof t["__proxy_id_"+proxySalt]&&(t["__proxy_id_"+proxySalt]=proxyList.length,proxyList[t["__proxy_id_"+proxySalt]]={})},BX.proxy=function(t,e){return t&&e?(BX._initObjectProxy(e),"undefined"==typeof t["__proxy_id_"+proxySalt]&&(t["__proxy_id_"+proxySalt]=proxyId++),proxyList[e["__proxy_id_"+proxySalt]][t["__proxy_id_"+proxySalt]]||(proxyList[e["__proxy_id_"+proxySalt]][t["__proxy_id_"+proxySalt]]=BX.delegate(t,e)),proxyList[e["__proxy_id_"+proxySalt]][t["__proxy_id_"+proxySalt]]):t},BX.defer=function(t,e){return e?BX.defer_proxy(t,e):function(){var e=arguments;setTimeout(function(){t.apply(this,e)},10)}},BX.defer_proxy=function(t,e){if(!t||!e)return t;BX.proxy(t,e);return this._initObjectProxy(e),"undefined"==typeof t["__defer_id_"+proxySalt]&&(t["__defer_id_"+proxySalt]=proxyId++),proxyList[e["__proxy_id_"+proxySalt]][t["__defer_id_"+proxySalt]]||(proxyList[e["__proxy_id_"+proxySalt]][t["__defer_id_"+proxySalt]]=BX.defer(BX.delegate(t,e))),proxyList[e["__proxy_id_"+proxySalt]][t["__defer_id_"+proxySalt]]},BX.bindDelegate=function(t,e,i,o){var n=BX.delegateEvent(i,o);return BX.bind(t,e,n),n},BX.delegateEvent=function(t,e){return function(i){i=i||window.event;for(var o=i.target||i.srcElement;o!=this;){if(_checkNode(o,t))return e.call(o,i);if(!o||!o.parentNode)break;o=o.parentNode}}},BX.False=function(){return!1},BX.DoNothing=function(){},BX.denyEvent=function(t,e){deniedEvents.push([t,e,t["on"+e]]),t["on"+e]=BX.DoNothing},BX.allowEvent=function(t,e){for(var i=0,o=deniedEvents.length;o>i;i++)if(deniedEvents[i][0]==t&&deniedEvents[i][1]==e)return t["on"+e]=deniedEvents[i][2],void BX.util.deleteFromArray(deniedEvents,i)},BX.fixEventPageXY=function(t){return BX.fixEventPageX(t),BX.fixEventPageY(t),t},BX.fixEventPageX=function(t){return null==t.pageX&&null!=t.clientX&&(t.pageX=t.clientX+(document.documentElement&&document.documentElement.scrollLeft||document.body&&document.body.scrollLeft||0)-(document.documentElement.clientLeft||0)),t},BX.fixEventPageY=function(t){return null==t.pageY&&null!=t.clientY&&(t.pageY=t.clientY+(document.documentElement&&document.documentElement.scrollTop||document.body&&document.body.scrollTop||0)-(document.documentElement.clientTop||0)),t},BX.PreventDefault=function(t){return t||(t=window.event),t.stopPropagation?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!0,t.returnValue=!1),!1},BX.eventReturnFalse=function(t){return t=t||window.event,t&&t.preventDefault?t.preventDefault():t.returnValue=!1,!1},BX.eventCancelBubble=function(t){t=t||window.event,t&&t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},BX.addCustomEvent=function(t,e,i){BX.type.isString(t)&&(i=e,e=t,t=window),e=e.toUpperCase(),customEvents[e]||(customEvents[e]=[]),customEvents[e].push({handler:i,obj:t})},BX.removeCustomEvent=function(t,e,i){if(BX.type.isString(t)&&(i=e,e=t,t=window),e=e.toUpperCase(),customEvents[e])for(var o=0,n=customEvents[e].length;n>o;o++)if(customEvents[e][o]&&customEvents[e][o].handler==i&&customEvents[e][o].obj==t)return void delete customEvents[e][o]},BX.onCustomEvent=function(t,e,i,o){if(BX.type.isString(t)&&(o=i,i=e,e=t,t=window),e=e.toUpperCase(),customEvents[e]){i||(i=[]);for(var n,s=0,r=customEvents[e].length;r>s;s++)n=customEvents[e][s],n&&n.handler&&(n.obj!=window&&n.obj!=t||n.handler.apply(t,o?BX.clone(i):i))}},BX.parseJSON=function(data,context){var result=null;if(BX.type.isString(data))try{data.indexOf("\n")>=0?eval("result = "+data):result=new Function("return "+data)()}catch(e){BX.onCustomEvent(context,"onParseJSONFailure",[data,context])}return result},BX.isReady=!1,BX.ready=function(t){bindReady(),BX.type.isFunction(t)?BX.isReady?t.call(document):readyList&&readyList.push(t):BX.debug("READY: not a function! ",t)},BX.submit=function(t,e,i,o){e=e||"save",t["BXFormSubmit_"+e]||(t["BXFormSubmit_"+e]=t.appendChild(BX.create("INPUT",{props:{type:"submit",name:e,value:i||"Y"},style:{display:"none"}}))),t.sessid&&(t.sessid.value=BX.bitrix_sessid()),setTimeout(BX.delegate(function(){BX.fireEvent(this,"click"),o&&o()},t["BXFormSubmit_"+e]),10)},BX.browser={IsIE:function(){return bIE},IsIE6:function(){return/MSIE 6/i.test(navigator.userAgent)},IsIE7:function(){return/MSIE 7/i.test(navigator.userAgent)},IsIE8:function(){return/MSIE 8/i.test(navigator.userAgent)},IsIE9:function(){return!!document.documentMode&&document.documentMode>=9},IsIE10:function(){return!!document.documentMode&&document.documentMode>=10},IsIE11:function(){return BX.browser.DetectIeVersion()>=11},IsOpera:function(){return bOpera},IsSafari:function(){return bSafari},IsFirefox:function(){return bFirefox},IsChrome:function(){return bChrome},IsMac:function(){return/Macintosh/i.test(navigator.userAgent)},IsAndroid:function(){return/Android/i.test(navigator.userAgent)},IsIOS:function(){return/(iPad;)|(iPhone;)/i.test(navigator.userAgent)},DetectIeVersion:function(){if(BX.browser.IsOpera()||BX.browser.IsSafari()||BX.browser.IsFirefox()||BX.browser.IsChrome())return-1;var t=-1;if(window.MSStream&&!window.ActiveXObject&&"ActiveXObject"in window?t=11:BX.browser.IsIE10()?t=10:BX.browser.IsIE9()?t=9:BX.browser.IsIE()&&(t=8),-1==t||8==t){var e;"Microsoft Internet Explorer"==navigator.appName?(e=new RegExp("MSIE ([0-9]+[.0-9]*)"),null!=e.exec(navigator.userAgent)&&(t=parseFloat(RegExp.$1))):"Netscape"==navigator.appName&&(t=11,e=new RegExp("Trident/.*rv:([0-9]+[.0-9]*)"),null!=e.exec(navigator.userAgent)&&(t=parseFloat(RegExp.$1)))}return t},IsDoctype:function(t){return t=t||document,t.compatMode?"CSS1Compat"==t.compatMode:!(!t.documentElement||!t.documentElement.clientHeight)},SupportLocalStorage:function(){return!!BX.localStorage&&!!BX.localStorage.checkBrowser()},addGlobalClass:function(){var t="";BX.browser.IsIOS()?t+=" bx-ios":BX.browser.IsMac()?t+=" bx-mac":BX.browser.IsAndroid()&&(t+=" bx-android"),t+=BX.browser.IsIOS()||BX.browser.IsAndroid()?" bx-touch":" bx-no-touch",t+=BX.browser.isRetina()?" bx-retina":" bx-no-retina";var e=-1;/AppleWebKit/.test(navigator.userAgent)?t+=" bx-chrome":(e=BX.browser.DetectIeVersion())>0?(t+=" bx-ie bx-ie"+e,e>7&&10>e&&!BX.browser.IsDoctype()&&(t+=" bx-quirks")):/Opera/.test(navigator.userAgent)?t+=" bx-opera":/Gecko/.test(navigator.userAgent)&&(t+=" bx-firefox"),BX.addClass(document.documentElement,t),BX.browser.addGlobalClass=BX.DoNothing},isPropertySupported:function(t,e){function i(t){return t.replace(/([A-Z])/g,function(){return"-"+arguments[1].toLowerCase()})}function o(t){var e=/(\-([a-z]){1})/g;return e.test(t)?t.replace(e,function(){return arguments[2].toUpperCase()}):t}if(!BX.type.isNotEmptyString(t))return!1;var n=t.indexOf("-")>-1?o(t):t;e=!!e;for(var s=n.charAt(0).toUpperCase()+n.slice(1),r=(n+" "+["Webkit","Moz","O","ms"].join(s+" ")+s).split(" "),a=document.body||document.documentElement,l=0;l<r.length;l++){var h=r[l];if(void 0!==a.style[h]){var d=h==n?"":"-"+h.substr(0,h.length-n.length).toLowerCase()+"-";return e?d+i(n):h}}return!1},addGlobalFeatures:function(t){if(BX.type.isArray(t)){for(var e=[],i=0;i<t.length;i++){var o=!!BX.browser.isPropertySupported(t[i]);e.push("bx-"+(o?"":"no-")+t[i].toLowerCase())}BX.addClass(document.documentElement,e.join(" "))}},isRetina:function(){return window.devicePixelRatio&&window.devicePixelRatio>=2}},BX.show=function(t,e){!t.BXDISPLAY&&_checkDisplay(t,e)||(t.style.display=t.BXDISPLAY)},BX.hide=function(t,e){t.BXDISPLAY||_checkDisplay(t,e),t.style.display="none"},BX.toggle=function(t,e){if(!e&&BX.type.isElementNode(t)){var i=!0;i=t.BXDISPLAY?!_checkDisplay(t):"none"==t.style.display,i?BX.show(t):BX.hide(t)}else if(BX.type.isArray(e)){for(var o=0,n=e.length;n>o;o++)if(t==e[o]){t=e[o==n-1?0:o+1];break}o==n&&(t=e[0])}return t},BX.util={array_values:function(t){if(!BX.type.isArray(t))return BX.util._array_values_ob(t);for(var e=[],i=0,o=t.length;o>i;i++)null!==t[i]&&"undefined"!=typeof t[i]&&e.push(t[i]);return e},_array_values_ob:function(t){var e=[];for(var i in t)null!==t[i]&&"undefined"!=typeof t[i]&&e.push(t[i]);return e},array_keys:function(t){if(!BX.type.isArray(t))return BX.util._array_keys_ob(t);for(var e=[],i=0,o=t.length;o>i;i++)null!==t[i]&&"undefined"!=typeof t[i]&&e.push(i);return e},_array_keys_ob:function(t){var e=[];for(var i in t)null!==t[i]&&"undefined"!=typeof t[i]&&e.push(i);return e},array_merge:function(t,e){BX.type.isArray(t)||(t=[]),BX.type.isArray(e)||(e=[]);var i=t.length,o=0;if("number"==typeof e.length)for(var n=e.length;n>o;o++)t[i++]=e[o];else for(;void 0!==e[o];)t[i++]=e[o++];return t.length=i,t},array_unique:function(t){var e,i=0,o=t.length;if(2>o)return t;for(;o-1>i;i++)for(e=i+1;o>e;e++)t[i]==t[e]&&(t.splice(e--,1),o--);return t},in_array:function(t,e){for(var i=0;i<e.length;i++)if(e[i]==t)return!0;return!1},array_search:function(t,e){for(var i=0;i<e.length;i++)if(e[i]==t)return i;return-1},object_search_key:function(t,e){if("undefined"!=typeof e[t])return e[t];for(var i in e)if("object"==typeof e[i]){var o=BX.util.object_search_key(t,e[i]);if(o!==!1)return o}return!1},trim:function(t){return BX.type.isString(t)?t.replace(r.ltrim,"").replace(r.rtrim,""):t},urlencode:function(t){return encodeURIComponent(t)},deleteFromArray:function(t,e){return t.slice(0,e).concat(t.slice(e+1))},insertIntoArray:function(t,e,i){return t.slice(0,e).concat([i]).concat(t.slice(e))},htmlspecialchars:function(t){return t.replace?t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):t},htmlspecialcharsback:function(t){return t.replace?t.replace(/\&quot;/g,'"').replace(/&#39;/g,"'").replace(/\&lt;/g,"<").replace(/\&gt;/g,">").replace(/\&amp;/g,"&"):t},preg_quote:function(t,e){return t.replace?t.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\"+(e||"")+"-]","g"),"\\$&"):t},jsencode:function(t){if(!t||!t.replace)return t;for(var e=[{c:"\\\\",r:"\\\\"},{c:"\\t",r:"\\t"},{c:"\\n",r:"\\n"},{c:"\\r",r:"\\r"},{c:'"',r:'\\"'},{c:"'",r:"\\'"},{c:"<",r:"\\x3C"},{c:">",r:"\\x3E"},{c:"\\u2028",r:"\\u2028"},{c:"\\u2029",r:"\\u2029"}],i=0;i<e.length;i++)t=t.replace(new RegExp(e[i].c,"g"),e[i].r);return t},str_pad:function(t,e,i,o){return i=i||" ",o=o||"right",t=t.toString(),"left"==o?BX.util.str_pad_left(t,e,i):BX.util.str_pad_right(t,e,i)},str_pad_left:function(t,e,i){var o=t.length,n=i.length;if(o>=e)return t;for(;e>o;o+=n)t=i+t;return t},str_pad_right:function(t,e,i){var o=t.length,n=i.length;if(o>=e)return t;for(;e>o;o+=n)t+=i;return t},strip_tags:function(t){return t.split(/<[^>]+>/g).join("")},strip_php_tags:function(t){return t.replace(/<\?(.|[\r\n])*?\?>/g,"")},popup:function(t,e,i){var o,n;return BX.browser.IsOpera()?(o=document.body.offsetWidth,n=document.body.offsetHeight):(o=screen.width,n=screen.height),window.open(t,"","status=no,scrollbars=yes,resizable=yes,width="+e+",height="+i+",top="+Math.floor((n-i)/2-14)+",left="+Math.floor((o-e)/2-5))},objectSort:function(t,e,i){i="asc"==i?"asc":"desc";var o,n=[];for(o in t)t.hasOwnProperty(o)&&t[o][e]&&n.push([o,t[o][e]]);"asc"==i?n.sort(function(t,e){var i,o;return isNaN(t[1])||isNaN(e[1])?(i=t[1].toString().toLowerCase(),o=e[1].toString().toLowerCase()):(i=parseInt(t[1]),o=parseInt(e[1])),i>o?1:o>i?-1:0}):n.sort(function(t,e){var i,o;return isNaN(t[1])||isNaN(e[1])?(i=t[1].toString().toLowerCase(),o=e[1].toString().toLowerCase()):(i=parseInt(t[1]),o=parseInt(e[1])),o>i?1:i>o?-1:0});var s=Array();for(o=0;o<n.length;o++)s.push(t[n[o][0]]);return s},hex2rgb:function(t){for(var e=t.replace(/[# ]/g,"").replace(/^(.)(.)(.)$/,"$1$1$2$2$3$3").match(/.{2}/g),i=0;3>i;i++)e[i]=parseInt(e[i],16);return{r:e[0],g:e[1],b:e[2]}},remove_url_param:function(t,e){if(BX.type.isArray(e))for(var i=0;i<e.length;i++)t=BX.util.remove_url_param(t,e[i]);else t=t.replace(new RegExp("([?&])"+e+"=[^&]*[&]*","i"),"$1");return t},even:function(t){return parseInt(t)%2==0},hashCode:function(t){if(!BX.type.isNotEmptyString(t))return 0;for(var e=0,i=0;i<t.length;i++){var o=t.charCodeAt(i);e=(e<<5)-e+o,e&=e}return e}},BX.type={isString:function(t){return""===t?!0:t?"string"==typeof t||t instanceof String:!1},isNotEmptyString:function(t){return BX.type.isString(t)?t.length>0:!1},isBoolean:function(t){return t===!0||t===!1},isNumber:function(t){return 0===t?!0:t?"number"==typeof t||t instanceof Number:!1},isFunction:function(t){return null===t?!1:"function"==typeof t||t instanceof Function},isElementNode:function(t){return t&&"object"==typeof t&&"nodeType"in t&&1==t.nodeType&&t.tagName&&"SCRIPT"!=t.tagName.toUpperCase()&&"STYLE"!=t.tagName.toUpperCase()&&"LINK"!=t.tagName.toUpperCase()},isDomNode:function(t){return t&&"object"==typeof t&&"nodeType"in t},isArray:function(t){return t&&"[object Array]"==Object.prototype.toString.call(t)},isDate:function(t){return t&&"[object Date]"==Object.prototype.toString.call(t)},isPlainObject:function(t){if(!t||"object"!=typeof t||t.nodeType)return!1;var e=Object.prototype.hasOwnProperty;try{if(t.constructor&&!e.call(t,"constructor")&&!e.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}var o;for(o in t);return"undefined"==typeof o||e.call(t,o)}},BX.isNodeInDom=function(t,e){return t===(e||document)?!0:t.parentNode?BX.isNodeInDom(t.parentNode):!1},BX.isNodeHidden=function(t){return t===document?!1:"none"==BX.style(t,"display")?!0:t.parentNode?BX.isNodeHidden(t.parentNode):!0},BX.evalPack=function(t){for(;t.length>0;){var e=t.shift();if("SCRIPT_EXT"==e.TYPE||"SCRIPT_SRC"==e.TYPE)return void BX.loadScript(e.DATA,function(){BX.evalPack(t)});"SCRIPT"==e.TYPE&&BX.evalGlobal(e.DATA)}},BX.evalGlobal=function(t){if(t){var e=document.getElementsByTagName("head")[0]||document.documentElement,i=document.createElement("script");i.type="text/javascript",BX.browser.IsIE()?i.text=t:i.appendChild(document.createTextNode(t)),e.insertBefore(i,e.firstChild),e.removeChild(i)}},BX.processHTML=function(t,e){for(var i,o,n,s,a=[],l=[],h=t;null!==(i=h.match(r.script));){var d=h.search(/<\/script>/i);if(-1==d)break;var u=e||"-1"!=i[1].indexOf("bxrunfirst");if(null!==(n=i[1].match(r.script_src)))a.push({bRunFirst:u,isInternal:!1,JS:n[1]});else{var p=i.index+i[0].length,c=h.substr(p,d-p);a.push({bRunFirst:u,isInternal:!0,JS:c})}h=h.substr(0,i.index)+h.substr(d+9)}for(;null!==(o=h.match(r.style));)null!==(s=o[0].match(r.style_href))&&o[0].indexOf('media="')<0&&l.push(s[1]),h=h.replace(o[0],"");return{HTML:h,SCRIPT:a,STYLE:l}},BX.garbage=function(t,e){garbageCollectors.push({callback:t,context:e})},BX.GetDocElement=function(t){return t=t||document,BX.browser.IsDoctype(t)?t.documentElement:t.body},BX.GetContext=function(t){return BX.type.isElementNode(t)?t.ownerDocument.parentWindow||t.ownerDocument.defaultView||window:BX.type.isDomNode(t)?t.parentWindow||t.defaultView||window:window},BX.GetWindowInnerSize=function(t){var e,i;return t=t||document,window.innerHeight?(e=BX.GetContext(t).innerWidth,i=BX.GetContext(t).innerHeight):t.documentElement&&(t.documentElement.clientHeight||t.documentElement.clientWidth)?(e=t.documentElement.clientWidth,i=t.documentElement.clientHeight):t.body&&(e=t.body.clientWidth,i=t.body.clientHeight),{innerWidth:e,innerHeight:i}},BX.GetWindowScrollPos=function(t){var e,i;return t=t||document,window.pageYOffset?(e=BX.GetContext(t).pageXOffset,i=BX.GetContext(t).pageYOffset):t.documentElement&&(t.documentElement.scrollTop||t.documentElement.scrollLeft)?(e=t.documentElement.scrollLeft,i=t.documentElement.scrollTop):t.body&&(e=t.body.scrollLeft,i=t.body.scrollTop),{scrollLeft:e,scrollTop:i}},BX.GetWindowScrollSize=function(t){var e,i;return t||(t=document),t.compatMode&&"CSS1Compat"==t.compatMode?(e=t.documentElement.scrollWidth,i=t.documentElement.scrollHeight):(i=t.body.scrollHeight>t.body.offsetHeight?t.body.scrollHeight:t.body.offsetHeight,e=t.body.scrollWidth>t.body.offsetWidth||t.compatMode&&"BackCompat"==t.compatMode||t.documentElement&&!t.documentElement.clientWidth?t.body.scrollWidth:t.body.offsetWidth),{scrollWidth:e,scrollHeight:i}},BX.GetWindowSize=function(t){var e=this.GetWindowInnerSize(t),i=this.GetWindowScrollPos(t),o=this.GetWindowScrollSize(t);return{innerWidth:e.innerWidth,innerHeight:e.innerHeight,scrollLeft:i.scrollLeft,scrollTop:i.scrollTop,scrollWidth:o.scrollWidth,scrollHeight:o.scrollHeight}},BX.hide_object=function(t){t=BX(t),t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.height="10px",t.style.width="10px"},BX.is_relative=function(t){var e=BX.style(t,"position");return"relative"==e||"absolute"==e},BX.is_float=function(t){var e=BX.style(t,"float");return"right"==e||"left"==e},BX.is_fixed=function(t){var e=BX.style(t,"position");return"fixed"==e},BX.pos=function(t,e){var i={top:0,right:0,bottom:0,left:0,width:0,height:0};if(e=!!e,!t)return i;if("undefined"==typeof t.getBoundingClientRect||t.ownerDocument!=document||e){for(var o=0,n=0,s=t.offsetWidth,r=t.offsetHeight,a=!0;null!=t&&(a||!e||!BX.is_relative(t));t=t.offsetParent)if(o+=t.offsetLeft,
n+=t.offsetTop,a)a=!1;else{var l=parseInt(BX.style(t,"border-left-width")),h=parseInt(BX.style(t,"border-top-width"));!isNaN(l)&&l>0&&(o+=l),!isNaN(h)&&h>0&&(n+=h)}i.top=n,i.left=o,i.width=s,i.height=r,i.right=i.left+s,i.bottom=i.top+r}else{var d={};try{d=t.getBoundingClientRect()}catch(u){d={top:t.offsetTop,left:t.offsetLeft,width:t.offsetWidth,height:t.offsetHeight,right:t.offsetLeft+t.offsetWidth,bottom:t.offsetTop+t.offsetHeight}}var p=document.documentElement,c=document.body;i.top=d.top+(p.scrollTop||c.scrollTop),i.left=d.left+(p.scrollLeft||c.scrollLeft),i.width=d.right-d.left,i.height=d.bottom-d.top,i.right=d.right+(p.scrollLeft||c.scrollLeft),i.bottom=d.bottom+(p.scrollTop||c.scrollTop)}for(var m in i)i.hasOwnProperty(m)&&(i[m]=parseInt(i[m]));return i},BX.align=function(t,e,i,o){o=o?o.toLowerCase():"";var n=document;BX.type.isElementNode(t)&&(n=t.ownerDocument,t=BX.pos(t));var s=t.left,r=t.bottom,a=BX.GetWindowScrollPos(n),l=BX.GetWindowInnerSize(n);return l.innerWidth+a.scrollLeft-(t.left+e)<0&&(s=t.right-e>=0?t.right-e:a.scrollLeft),(l.innerHeight+a.scrollTop-(t.bottom+i)<0||~o.indexOf("top"))&&(r=t.top-i>=0||~o.indexOf("top")?t.top-i:a.scrollTop),{left:s,top:r}},BX.scrollToNode=function(t){var e=BX(t);if(e.scrollIntoView)e.scrollIntoView(!0);else{var i=BX.pos(e);window.scrollTo(i.left,i.top)}},BX.showWait=function(t,e){t=BX(t)||document.body||document.documentElement,e=e||BX.message("JS_CORE_LOADING");var i=t.id||Math.random(),o=t.bxmsg=document.body.appendChild(BX.create("DIV",{props:{id:"wait_"+i,className:"bx-core-waitwindow"},text:e}));return setTimeout(BX.delegate(_adjustWait,t),10),lastWait[lastWait.length]=o,o},BX.closeWait=function(t,e){if(t&&!e&&(e=t.bxmsg),t&&!e&&BX.hasClass(t,"bx-core-waitwindow")&&(e=t),t&&!e&&(e=BX("wait_"+t.id)),e||(e=lastWait.pop()),e&&e.parentNode){for(var i=0,o=lastWait.length;o>i;i++)if(e==lastWait[i]){lastWait=BX.util.deleteFromArray(lastWait,i);break}e.parentNode.removeChild(e),t&&(t.bxmsg=null),BX.cleanNode(e,!0)}},BX.setJSList=function(t){BX.type.isArray(t)&&(jsList=t)},BX.setCSSList=function(t){BX.type.isArray(t)&&(cssList=t)},BX.getJSPath=function(t){return t.replace(/\.js(\?\d*)/,".js").replace(/^(http[s]*:)*\/\/[^\/]+/i,"")},BX.getCSSPath=function(t){return t.replace(/\.css(\?\d*)/,".css").replace(/^(http[s]*:)*\/\/[^\/]+/i,"")},BX.getCDNPath=function(t){return t},BX.loadScript=function(t,e,i){if(!BX.isReady){var o=arguments;return void BX.ready(function(){BX.loadScript.apply(this,o)})}i=i||document,BX.type.isString(t)&&(t=[t]);var n=function(){return e&&BX.type.isFunction(e)?e():null},s=function(e){if(e>=t.length)return n();if(t[e]){var o=BX.getJSPath(t[e]);if(!_isScriptLoaded(o)){var r=i.getElementsByTagName("head")[0]||i.documentElement,a=i.createElement("script");a.src=t[e];var l=!1;return a.onload=a.onreadystatechange=function(){l||a.readyState&&"loaded"!=a.readyState&&"complete"!=a.readyState||(l=!0,setTimeout(function(){s(++e)},50),a.onload=a.onreadystatechange=null,r&&a.parentNode&&r.removeChild(a))},jsList.push(o),r.insertBefore(a,r.firstChild)}s(++e)}else s(++e)};s(0)},BX.loadCSS=function(t,e,i){if(!BX.isReady){var o=arguments;return BX.ready(function(){BX.loadCSS.apply(this,o)}),null}var n=!1;BX.type.isString(t)&&(n=!0,t=[t]);var s=0,r=t.length,a=null,l=[];if(0==r)return null;if(e=e||document,i=i||window,!i.bxhead){var h=e.getElementsByTagName("HEAD");if(i.bxhead=h[0],!i.bxhead)return null}for(s=0;r>s;s++){var d=BX.getCSSPath(t[s]);if(!_isCssLoaded(d)){a=document.createElement("LINK"),a.href=t[s],a.rel="stylesheet",a.type="text/css";var u=_getTemplateLink(i.bxhead);null!==u?u.parentNode.insertBefore(a,u):i.bxhead.appendChild(a),l.push(a),cssList.push(d)}}return n?a:l},BX.reload=function(t,e){t===!0&&(e=!0,t=null);var i=t||top.location.href,o=i.indexOf("#"),n="";-1!=o&&(n=i.substr(o),i=i.substr(0,o)),e&&i.indexOf("clear_cache=Y")<0&&(i+=(-1==i.indexOf("?")?"?":"&")+"clear_cache=Y"),n&&(e&&("view/"==n.substr(0,5)||"#view/"==n.substr(0,6))&&n.indexOf("clear_cache%3DY")<0&&(n+=(-1==n.indexOf("%3F")?"%3F":"%26")+"clear_cache%3DY"),i=i.replace(/(\?|\&)_r=[\d]*/,""),i+=(-1==i.indexOf("?")?"?":"&")+"_r="+Math.round(1e4*Math.random())+n),top.location.href=i},BX.clearCache=function(){BX.showWait(),BX.reload(!0)},BX.template=function(t,e,i){BX.ready(function(){_processTpl(BX(t),e,i)})},BX.isAmPmMode=function(){return null!=BX.message("FORMAT_DATETIME").match("T")},BX.formatDate=function(t,e){t=t||new Date;var i=t.getHours()||t.getMinutes()||t.getSeconds(),o=e?e:i?BX.message("FORMAT_DATETIME"):BX.message("FORMAT_DATE");return o.replace(/YYYY/gi,t.getFullYear()).replace(/MMMM/gi,BX.util.str_pad_left((t.getMonth()+1).toString(),2,"0")).replace(/MM/gi,BX.util.str_pad_left((t.getMonth()+1).toString(),2,"0")).replace(/DD/gi,BX.util.str_pad_left(t.getDate().toString(),2,"0")).replace(/HH/gi,BX.util.str_pad_left(t.getHours().toString(),2,"0")).replace(/MI/gi,BX.util.str_pad_left(t.getMinutes().toString(),2,"0")).replace(/SS/gi,BX.util.str_pad_left(t.getSeconds().toString(),2,"0"))},BX.getNumMonth=function(t){var e=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],o=["january","february","march","april","may","june","july","august","september","october","november","december"],n=t.toUpperCase();for(i=1;12>=i;i++)if(n==BX.message("MON_"+i).toUpperCase()||n==BX.message("MONTH_"+i).toUpperCase()||n==e[i-1].toUpperCase()||n==o[i-1].toUpperCase())return i;return t},BX.parseDate=function(t){if(BX.type.isNotEmptyString(t)){var e="";for(i=1;12>=i;i++)e=e+"|"+BX.message("MON_"+i);var i,o,n=new RegExp("([0-9]+|[a-z]+"+e+")","ig"),s=t.match(n),r=BX.message("FORMAT_DATE").match(/(DD|MI|MMMM|MM|M|YYYY)/gi),a=[],l=[],h={};if(!s)return null;for(s.length>r.length&&(r=BX.message("FORMAT_DATETIME").match(/(DD|MI|MMMM|MM|M|YYYY|HH|H|SS|TT|T|GG|G)/gi)),i=0,o=s.length;o>i;i++)""!=BX.util.trim(s[i])&&(a[a.length]=s[i]);for(i=0,o=r.length;o>i;i++)""!=BX.util.trim(r[i])&&(l[l.length]=r[i]);var d=BX.util.array_search("MMMM",l);for(d>0?(a[d]=BX.getNumMonth(a[d]),l[d]="MM"):(d=BX.util.array_search("M",l),d>0&&(a[d]=BX.getNumMonth(a[d]),l[d]="MM")),i=0,o=l.length;o>i;i++){var u=l[i].toUpperCase();h[u]="T"==u||"TT"==u?a[i]:parseInt(a[i],10)}if(h.DD>0&&h.MM>0&&h.YYYY>0){var p=new Date;if(p.setDate(1),p.setFullYear(h.YYYY),p.setMonth(h.MM-1),p.setDate(h.DD),p.setHours(0,0,0),!(isNaN(h.HH)&&isNaN(h.GG)&&isNaN(h.H)&&isNaN(h.G)||isNaN(h.MI))){if(isNaN(h.H)&&isNaN(h.G))h.HH=parseInt(h.HH||h.GG||0,10);else{var c="PM"==(h.T||h.TT||"am").toUpperCase();h.HH=parseInt(h.H||h.G||0,10)+(c?12:0)}isNaN(h.SS)&&(h.SS=0),p.setHours(h.HH,h.MI,h.SS)}return p}}return null},BX.selectUtils={addNewOption:function(t,e,i,o,n){if(t=BX(t)){var s=t.length;if(n!==!1)for(var r=0;s>r;r++)if(t[r].value==e)return;var a=new Option(i,e,!1,!1);t.options[s]=a}o===!0&&this.sortSelect(t)},deleteOption:function(t,e){if(t=BX(t))for(var i=0;i<t.length;i++)if(t[i].value==e){t.remove(i);break}},deleteSelectedOptions:function(t){if(t=BX(t))for(var e=0;e<t.length;)t[e].selected?(t[e].selected=!1,t.remove(e)):e++},deleteAllOptions:function(t){if(t=BX(t))for(var e=t.length-1;e>=0;e--)t.remove(e)},optionCompare:function(t,e){var i=t.optText.toLowerCase(),o=e.optText.toLowerCase();return i>o?1:o>i?-1:0},sortSelect:function(t){if(t=BX(t)){var e=[],i=t.options.length,o=0;for(o=0;i>o;o++)e[o]={optText:t[o].text,optValue:t[o].value};for(e.sort(this.optionCompare),t.length=0,i=e.length,o=0;i>o;o++)t[o]=new Option(e[o].optText,e[o].optValue,!1,!1)}},selectAllOptions:function(t){if(t=BX(t))for(var e=t.length,i=0;e>i;i++)t[i].selected=!0},selectOption:function(t,e){if(t=BX(t))for(var i=t.length,o=0;i>o;o++)t[o].selected=t[o].value==e},addSelectedOptions:function(t,e,i,o){if(t=BX(t))for(var n=t.length,s=0;n>s;s++)t[s].selected&&this.addNewOption(e,t[s].value,t[s].text,o,i)},moveOptionsUp:function(t){if(t=BX(t))for(var e=t.length,i=0;e>i;i++)if(t[i].selected&&i>0&&0==t[i-1].selected){var o=new Option(t[i].text,t[i].value),n=new Option(t[i-1].text,t[i-1].value);t[i]=n,t[i].selected=!1,t[i-1]=o,t[i-1].selected=!0}},moveOptionsDown:function(t){if(t=BX(t))for(var e=t.length,i=e-1;i>=0;i--)if(t[i].selected&&e-1>i&&0==t[i+1].selected){var o=new Option(t[i].text,t[i].value),n=new Option(t[i+1].text,t[i+1].value);t[i]=n,t[i].selected=!1,t[i+1]=o,t[i+1].selected=!0}}},BX.hint=function(t,e,i,o){null==i&&(i=e,e=""),null==t.BXHINT&&(t.BXHINT=new BX.CHint({parent:t,hint:i,title:e,id:o}),t.BXHINT.Show())},BX.hint_replace=function(t,e,i){if(null==i&&(i=e,e=""),!t||!t.parentNode||!i)return null;var o=new BX.CHint({hint:i,title:e});return o.CreateParent(),t.parentNode.insertBefore(o.PARENT,t),t.parentNode.removeChild(t),o.PARENT.style.marginLeft="5px",t},BX.CHint=function(t){this.PARENT=BX(t.parent),this.HINT=t.hint,this.HINT_TITLE=t.title,this.PARAMS={};for(var e in this.defaultSettings)null==t[e]?this.PARAMS[e]=this.defaultSettings[e]:this.PARAMS[e]=t[e];null!=t.id&&(this.ID=t.id),this.timer=null,this.bInited=!1,this.msover=!0,this.PARAMS.showOnce?(this.__show(),this.msover=!1,this.timer=setTimeout(BX.proxy(this.__hide,this),this.PARAMS.hide_timeout)):this.PARENT&&(BX.bind(this.PARENT,"mouseover",BX.proxy(this.Show,this)),BX.bind(this.PARENT,"mouseout",BX.proxy(this.Hide,this))),BX.addCustomEvent("onMenuOpen",BX.delegate(this.disable,this)),BX.addCustomEvent("onMenuClose",BX.delegate(this.enable,this))},BX.CHint.prototype.defaultSettings={show_timeout:1e3,hide_timeout:500,dx:2,showOnce:!1,preventHide:!0,min_width:250},BX.CHint.prototype.CreateParent=function(t,e){this.PARENT&&(BX.unbind(this.PARENT,"mouseover",BX.proxy(this.Show,this)),BX.unbind(this.PARENT,"mouseout",BX.proxy(this.Hide,this))),e||(e={});var i="icon";return!e.type||"link"!=e.type&&"icon"!=e.type||(i=e.type),t&&(i="element"),"icon"==i?t=BX.create("IMG",{props:{src:e.iconSrc?e.iconSrc:"/bitrix/js/main/core/images/hint.gif"}}):"link"==i&&(t=BX.create("A",{props:{href:"javascript:void(0)"},html:"[?]"})),this.PARENT=t,BX.bind(this.PARENT,"mouseover",BX.proxy(this.Show,this)),BX.bind(this.PARENT,"mouseout",BX.proxy(this.Hide,this)),this.PARENT},BX.CHint.prototype.Show=function(){this.msover=!0,null!=this.timer&&clearTimeout(this.timer),this.timer=setTimeout(BX.proxy(this.__show,this),this.PARAMS.show_timeout)},BX.CHint.prototype.Hide=function(){this.msover=!1,null!=this.timer&&clearTimeout(this.timer),this.timer=setTimeout(BX.proxy(this.__hide,this),this.PARAMS.hide_timeout)},BX.CHint.prototype.__show=function(){this.msover&&!this.disabled&&(this.bInited||this.Init(),this.prepareAdjustPos()&&(this.DIV.style.display="block",this.adjustPos(),BX.bind(window,"scroll",BX.proxy(this.__onscroll,this)),this.PARAMS.showOnce&&(this.timer=setTimeout(BX.proxy(this.__hide,this),this.PARAMS.hide_timeout))))},BX.CHint.prototype.__onscroll=function(){BX.admin&&BX.admin.panel&&BX.admin.panel.isFixed()&&(this.scrollTimer&&clearTimeout(this.scrollTimer),this.DIV.style.display="none",this.scrollTimer=setTimeout(BX.proxy(this.Reopen,this),this.PARAMS.show_timeout))},BX.CHint.prototype.Reopen=function(){null!=this.timer&&clearTimeout(this.timer),this.timer=setTimeout(BX.proxy(this.__show,this),50)},BX.CHint.prototype.__hide=function(){this.msover||this.bInited&&(BX.unbind(window,"scroll",BX.proxy(this.Reopen,this)),this.PARAMS.showOnce?this.Destroy():this.DIV.style.display="none")},BX.CHint.prototype.__hide_immediately=function(){this.msover=!1,this.__hide()},BX.CHint.prototype.Init=function(){this.DIV=document.body.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip"},style:{display:"none"},children:[BX.create("DIV",{props:{className:"bx-panel-tooltip-top-border"},html:'<div class="bx-panel-tooltip-corner bx-panel-tooltip-left-corner"></div><div class="bx-panel-tooltip-border"></div><div class="bx-panel-tooltip-corner bx-panel-tooltip-right-corner"></div>'}),this.CONTENT=BX.create("DIV",{props:{className:"bx-panel-tooltip-content"},children:[BX.create("DIV",{props:{className:"bx-panel-tooltip-underlay"},children:[BX.create("DIV",{props:{className:"bx-panel-tooltip-underlay-bg"}})]})]}),BX.create("DIV",{props:{className:"bx-panel-tooltip-bottom-border"},html:'<div class="bx-panel-tooltip-corner bx-panel-tooltip-left-corner"></div><div class="bx-panel-tooltip-border"></div><div class="bx-panel-tooltip-corner bx-panel-tooltip-right-corner"></div>'})]})),this.ID&&this.CONTENT.insertBefore(BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-panel-tooltip-close"},events:{click:BX.delegate(this.Close,this)}}),this.CONTENT.firstChild),this.HINT_TITLE&&this.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip-title"},text:this.HINT_TITLE})),this.HINT&&(this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip-text"}})).appendChild(BX.create("SPAN",{html:this.HINT}))),this.PARAMS.preventHide&&(BX.bind(this.DIV,"mouseout",BX.proxy(this.Hide,this)),BX.bind(this.DIV,"mouseover",BX.proxy(this.Show,this))),this.bInited=!0},BX.CHint.prototype.setContent=function(t){this.HINT=t,this.CONTENT_TEXT?this.CONTENT_TEXT.innerHTML=this.HINT:this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip-text"}})).appendChild(BX.create("SPAN",{html:this.HINT}))},BX.CHint.prototype.prepareAdjustPos=function(){return this._wnd={scrollPos:BX.GetWindowScrollPos(),scrollSize:BX.GetWindowScrollSize()},"none"!=BX.style(this.PARENT,"display")},BX.CHint.prototype.getAdjustPos=function(){var t={},e=BX.pos(this.PARENT),i=0;if(t.top=e.bottom+this.PARAMS.dx,BX.admin&&BX.admin.panel.DIV&&(i=BX.admin.panel.DIV.offsetHeight+this.PARAMS.dx,BX.admin.panel.isFixed()&&(i+=this._wnd.scrollPos.scrollTop)),t.top<i?t.top=i:t.top+this.DIV.offsetHeight>this._wnd.scrollSize.scrollHeight&&(t.top=e.top-this.PARAMS.dx-this.DIV.offsetHeight),t.left=e.left,e.left<this.PARAMS.dx)e.left=this.PARAMS.dx;else{var o=this.DIV.offsetWidth,n=this._wnd.scrollSize.scrollWidth-o-this.PARAMS.dx;t.left>n&&(t.left=n)}return t},BX.CHint.prototype.adjustWidth=function(){if(!this.bWidthAdjusted){var t=this.DIV.offsetWidth,e=this.DIV.offsetHeight;t>this.PARAMS.min_width&&(t=Math.round(Math.sqrt(1.618*t*e))),t<this.PARAMS.min_width&&(t=this.PARAMS.min_width),this.DIV.style.width=t+"px",this._adjustWidthInt&&clearInterval(this._adjustWidthInt),this._adjustWidthInt=setInterval(BX.delegate(this._adjustWidthInterval,this),5),this.bWidthAdjusted=!0}},BX.CHint.prototype._adjustWidthInterval=function(){this.DIV&&"none"!=this.DIV.style.display||clearInterval(this._adjustWidthInt);var t=20,e=1500,i=this.DIV.offsetWidth,o=this.CONTENT_TEXT.offsetWidth;return i>0&&o>0&&t>i-o&&e>i?void(this.DIV.style.width=i+t+"px"):void clearInterval(this._adjustWidthInt)},BX.CHint.prototype.adjustPos=function(){this.adjustWidth();var t=this.getAdjustPos();this.DIV.style.top=t.top+"px",this.DIV.style.left=t.left+"px"},BX.CHint.prototype.Close=function(){this.ID&&BX.WindowManager&&BX.WindowManager.saveWindowOptions(this.ID,{display:"off"}),this.__hide_immediately(),this.Destroy()},BX.CHint.prototype.Destroy=function(){this.PARENT&&(BX.unbind(this.PARENT,"mouseover",BX.proxy(this.Show,this)),BX.unbind(this.PARENT,"mouseout",BX.proxy(this.Hide,this))),this.DIV&&(BX.unbind(this.DIV,"mouseover",BX.proxy(this.Show,this)),BX.unbind(this.DIV,"mouseout",BX.proxy(this.Hide,this)),BX.cleanNode(this.DIV,!0))},BX.CHint.prototype.enable=function(){this.disabled=!1},BX.CHint.prototype.disable=function(){this.__hide_immediately(),this.disabled=!0},document.addEventListener?__readyHandler=function(){document.removeEventListener("DOMContentLoaded",__readyHandler,!1),runReady()}:document.attachEvent&&(__readyHandler=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",__readyHandler),runReady())}),window.attachEvent?window.attachEvent("onunload",Trash):window.addEventListener?window.addEventListener("unload",Trash,!1):window.onunload=Trash,BX(BX.DoNothing),window.BX=BX,BX.browser.addGlobalClass(),BX.browser.addGlobalFeatures(["boxShadow","borderRadius","flexWrap","boxDirection","transition","transform"])}}(window),function(t){if(!t.BX.ajax){var e=t.BX,i={},o={method:"GET",dataType:"html",timeout:0,async:!0,processData:!0,scriptsRunFirst:!1,emulateOnload:!0,skipAuthCheck:!1,start:!0,cache:!0,preparePost:!0,headers:!1,lsTimeout:30,lsForce:!1},n=null,s={},r={url_utf:/[^\034-\254]+/g,script_self:/\/bitrix\/js\/main\/core\/core(_ajax)*.js$/i,script_self_window:/\/bitrix\/js\/main\/core\/core_window.js$/i,script_self_admin:/\/bitrix\/js\/main\/core\/core_admin.js$/i,script_onload:/window.onload/g};e.ajax=function(t){var n;if(!t||!t.url||!e.type.isString(t.url))return!1;for(var s in i)"undefined"==typeof t[s]&&(t[s]=i[s]);i={};for(s in o)"undefined"==typeof t[s]&&(t[s]=o[s]);if(t.method=t.method.toUpperCase(),e.localStorage||(t.lsId=null),e.browser.IsIE()){var a=r.url_utf.exec(t.url);if(a)do t.url=t.url.replace(a,e.util.urlencode(a)),a=r.url_utf.exec(t.url);while(a)}"json"==t.dataType&&(t.emulateOnload=!1),t.cache||"GET"!=t.method||(t.url=e.ajax._uncache(t.url)),"POST"==t.method&&t.preparePost&&(t.data=e.ajax.prepareData(t.data));var l=!0;if(t.lsId&&!t.lsForce){var h=e.localStorage.get("ajax-"+t.lsId);if(null!==h){l=!1;var d=function(i){if(i.key=="ajax-"+t.lsId&&"BXAJAXWAIT"!=i.value){var o=i.value,n=!!i.oldValue&&null==o;n?t.onfailure&&t.onfailure("timeout"):e.ajax.__run(t,o),e.removeCustomEvent("onLocalStorageChange",d)}};"BXAJAXWAIT"==h?e.addCustomEvent("onLocalStorageChange",d):setTimeout(function(){d({key:"ajax-"+t.lsId,value:h})},10)}}if(l){if(t.xhr=e.ajax.xhr(),!t.xhr)return;if(t.lsId&&e.localStorage.set("ajax-"+t.lsId,"BXAJAXWAIT",t.lsTimeout),t.xhr.open(t.method,t.url,t.async),t.skipBxHeader||e.ajax.isCrossDomain(t.url)||t.xhr.setRequestHeader("Bx-ajax","true"),"POST"==t.method&&t.preparePost&&t.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),"object"==typeof t.headers)for(s=0;s<t.headers.length;s++)t.xhr.setRequestHeader(t.headers[s].name,t.headers[s].value);var u=!1,p=t.xhr.onreadystatechange=function(i){if(!u)if("timeout"===i)t.onfailure&&t.onfailure("timeout"),e.onCustomEvent(t.xhr,"onAjaxFailure",["timeout","",t]),t.xhr.onreadystatechange=e.DoNothing,t.xhr.abort(),t.async&&(t.xhr=null);else if(4==t.xhr.readyState||"run"==i){if(n=e.ajax.xhrSuccess(t.xhr)?"success":"error",u=!0,t.xhr.onreadystatechange=e.DoNothing,"success"==n){var o=t.skipAuthCheck||e.ajax.isCrossDomain(t.url)?!1:t.xhr.getResponseHeader("X-Bitrix-Ajax-Status");if(o&&"Authorize"==o)t.onfailure&&t.onfailure("auth",t.xhr.status),e.onCustomEvent(t.xhr,"onAjaxFailure",["auth",t.xhr.status,t]);else{var s=t.xhr.responseText;t.lsId&&e.localStorage.set("ajax-"+t.lsId,s,t.lsTimeout),e.ajax.__run(t,s)}}else t.onfailure&&t.onfailure("status",t.xhr.status),e.onCustomEvent(t.xhr,"onAjaxFailure",["status",t.xhr.status,t]);t.async&&(t.xhr=null)}};return t.async&&t.timeout>0&&setTimeout(function(){t.xhr&&!u&&p("timeout")},1e3*t.timeout),t.start&&(t.xhr.send(t.data),t.async||p("run")),t.xhr}},e.ajax.xhr=function(){if(t.XMLHttpRequest)try{return new XMLHttpRequest}catch(e){}else if(t.ActiveXObject){try{return new t.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new t.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new t.ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}throw new Error("This browser does not support XMLHttpRequest.")}return null},e.ajax.isCrossDomain=function(i,o){if(o=o||t.location,0===i.indexOf("//")&&(i=o.protocol+i),0!==i.indexOf("http"))return!1;var n=t.document.createElement("a");return n.href=i,n.protocol!==o.protocol||n.hostname!==o.hostname||e.ajax.getHostPort(n.protocol,n.host)!==e.ajax.getHostPort(o.protocol,o.host)},e.ajax.getHostPort=function(t,e){var i=/:(\d+)$/.exec(e);return i?i[1]:"http:"===t?"80":"https:"===t?"443":""},e.ajax.__prepareOnload=function(i){if(i.length>0){e.ajax["onload_"+n]=null;for(var o=0,s=i.length;s>o;o++)i[o].isInternal&&(i[o].JS=i[o].JS.replace(r.script_onload,"BX.ajax.onload_"+n))}e.CaptureEventsGet(),e.CaptureEvents(t,"load")},e.ajax.__runOnload=function(){null!=e.ajax["onload_"+n]&&(e.ajax["onload_"+n].apply(t),e.ajax["onload_"+n]=null);var i=e.CaptureEventsGet();if(i)for(var o=0;o<i.length;o++)i[o].apply(t)},e.ajax.__run=function(t,i){t.processData?i=e.ajax.processRequestData(i,t):(t.onsuccess&&t.onsuccess(i),e.onCustomEvent(t.xhr,"onAjaxSuccess",[i,t]))},e.ajax._onParseJSONFailure=function(t){this.jsonFailure=!0,this.jsonResponse=t,this.jsonProactive=/^\[WAF\]/.test(t)},e.ajax.processRequestData=function(t,i){var o,s=[],r=[];switch(i.dataType.toUpperCase()){case"JSON":e.addCustomEvent(i.xhr,"onParseJSONFailure",e.proxy(e.ajax._onParseJSONFailure,i)),o=e.parseJSON(t,i.xhr),e.removeCustomEvent(i.xhr,"onParseJSONFailure",e.proxy(e.ajax._onParseJSONFailure,i));break;case"SCRIPT":s.push({isInternal:!0,JS:t,bRunFirst:i.scriptsRunFirst}),i.processScriptsConsecutive=!0,o=t;break;default:var a=e.processHTML(t,i.scriptsRunFirst);o=a.HTML,s=a.SCRIPT,r=a.STYLE}var l=!1;null==n&&(n=parseInt(1e6*Math.random()),l=!0),r.length>0&&e.loadCSS(r),i.emulateOnload&&e.ajax.__prepareOnload(s);var h=e.DoNothing;(i.emulateOnload||l)&&(h=e.defer(function(){i.emulateOnload&&e.ajax.__runOnload(),l&&(n=null),e.onCustomEvent(i.xhr,"onAjaxSuccessFinish",[i])}));try{if(i.jsonFailure)throw{type:"json_failure",data:i.jsonResponse,bProactive:i.jsonProactive};i.scripts=s,e.ajax.processScripts(i.scripts,!0),i.onsuccess&&i.onsuccess(o),e.onCustomEvent(i.xhr,"onAjaxSuccess",[o,i]),i.processScriptsConsecutive?(e.ajax.processScriptsConsecutive(i.scripts,!1),h()):e.ajax.processScripts(i.scripts,!1,h)}catch(d){i.onfailure&&i.onfailure("processing",d),e.onCustomEvent(i.xhr,"onAjaxFailure",["processing",d,i])}},e.ajax.processScripts=function(t,i,o){var n=[],s="";o=o||e.DoNothing;for(var r=0,a=t.length;a>r;r++)"undefined"!=typeof i&&i!=!!t[r].bRunFirst||(t[r].isInternal?s+=";"+t[r].JS:n.push(t[r].JS));n=e.util.array_unique(n);var l=n.length,h=l,d=s.length>0?function(){e.evalGlobal(s)}:e.DoNothing;if(l>0){var u=function(){--h<=0&&(d(),o(),d=e.DoNothing)};for(r=0;l>r;r++)e.loadScript(n[r],u)}else d(),o()},e.ajax.processScriptsConsecutive=function(t,i){for(var o=0,n=t.length;n>o;o++)null!=i&&i!=!!t[o].bRunFirst||(t[o].isInternal?e.evalGlobal(t[o].JS):e.ajax.loadScriptAjax([t[o].JS]))},e.ajax.prepareData=function(t,i){var o="";if(e.type.isString(t))o=t;else if(null!=t)for(var n in t)if(t.hasOwnProperty(n)){o.length>0&&(o+="&");var s=e.util.urlencode(n);i&&(s=i+"["+s+"]"),o+="object"==typeof t[n]?e.ajax.prepareData(t[n],s):s+"="+e.util.urlencode(t[n])}return o},e.ajax.xhrSuccess=function(t){return t.status>=200&&t.status<300||304===t.status||1223===t.status||0===t.status},e.ajax.Setup=function(t,e){e=!!e;for(var n in t)e?i[n]=t[n]:o[n]=t[n]},e.ajax.replaceLocalStorageValue=function(t,i,o){e.localStorage&&e.localStorage.set("ajax-"+t,i,o)},e.ajax._uncache=function(t){return t+((-1!==t.indexOf("?")?"&":"?")+"_="+(new Date).getTime())},e.ajax.get=function(t,i,o){return e.type.isFunction(i)&&(o=i,i=""),i=e.ajax.prepareData(i),i&&(t+=(-1!==t.indexOf("?")?"&":"?")+i,i=""),e.ajax({method:"GET",dataType:"html",url:t,data:"",onsuccess:o})},e.ajax.getCaptcha=function(t){return e.ajax.loadJSON("/bitrix/tools/ajax_captcha.php",t)},e.ajax.insertToNode=function(t,o){if(o=e(o)){e.onCustomEvent("onAjaxInsertToNode",[{url:t,node:o}]);var n=null;return i.denyShowWait||(n=e.showWait(o),delete i.denyShowWait),e.ajax.get(t,function(t){o.innerHTML=t,e.closeWait(o,n)})}},e.ajax.post=function(t,i,o){return i=e.ajax.prepareData(i),e.ajax({method:"POST",dataType:"html",url:t,data:i,onsuccess:o})},e.ajax.loadScriptAjax=function(t,i,o){if(e.type.isArray(t))for(var n=0,a=t.length;a>n;n++)e.ajax.loadScriptAjax(t[n],i,o);else{var l=t.replace(/\.js\?.*/,".js");if(r.script_self.test(l))return;if(r.script_self_window.test(l)&&e.CWindow)return;if(r.script_self_admin.test(l)&&e.admin)return;if("undefined"==typeof s[l])return o?(s[l]="",e.loadScript(t)):e.ajax({url:t,method:"GET",dataType:"script",processData:!0,emulateOnload:!1,scriptsRunFirst:!0,async:!1,start:!0,onsuccess:function(t){s[l]=t,i&&i(t)}});i&&i(s[l])}},e.ajax.loadJSON=function(t,i,o,n){return e.type.isFunction(i)&&(n=o,o=i,i=""),i=e.ajax.prepareData(i),i&&(t+=(-1!==t.indexOf("?")?"&":"?")+i,i=""),e.ajax({method:"GET",dataType:"json",url:t,onsuccess:o,onfailure:n})},e.ajax.load=function(t,i){e.type.isArray(t)||(t=[t]);var o=0;e.type.isFunction(i)||(i=e.DoNothing);for(var n=function(t){e.type.isFunction(this.callback)&&this.callback(t),++o>=r&&i()},s=0,r=t.length;r>s;s++)switch(t.type.toUpperCase()){case"SCRIPT":e.loadScript([t[s].url],e.proxy(n,t[s]));break;case"CSS":e.loadCSS([t[s].url]),++o>=r&&i();break;case"JSON":e.ajax.loadJSON(t.url,e.proxy(n,t[s]));break;default:e.ajax.get(t.url,"",e.proxy(n,t[s]))}},e.ajax.submit=function(t,i){if(!t.target){if(null==t.BXFormTarget){var o="formTarget_"+Math.random();t.BXFormTarget=document.body.appendChild(e.create("IFRAME",{props:{name:o,id:o,src:"javascript:void(0)"},style:{display:"none"}}))}t.target=t.BXFormTarget.name}return t.BXFormCallback=i,e.bind(t.BXFormTarget,"load",e.proxy(e.ajax._submit_callback,t)),e.submit(t),!1},e.ajax.submitComponentForm=function(i,o,n){if(!i.target){if(null==i.BXFormTarget){var s="formTarget_"+Math.random();i.BXFormTarget=document.body.appendChild(e.create("IFRAME",{props:{name:s,id:s,src:"javascript:void(0)"},style:{display:"none"}}))}i.target=i.BXFormTarget.name}if(n)var r=e.showWait(o);return i.BXFormCallback=function(i){n&&e.closeWait(r);var s=function(){t.bxcompajaxframeonload&&setTimeout(function(){t.bxcompajaxframeonload(),t.bxcompajaxframeonload=null},10)};e(o).innerHTML=i,e.onCustomEvent("onAjaxSuccess",[null,null,s])},e.bind(i.BXFormTarget,"load",e.proxy(e.ajax._submit_callback,i)),!0},e.ajax._submit_callback=function(){try{if(0!=this.BXFormTarget.contentWindow.location.href.indexOf("http"))return}catch(t){return}this.BXFormCallback&&this.BXFormCallback.apply(this,[this.BXFormTarget.contentWindow.document.body.innerHTML]),e.unbindAll(this.BXFormTarget)},e.ajax.submitAjax=function(){},e.ajax.UpdatePageData=function(t){if(t.TITLE&&e.ajax.UpdatePageTitle(t.TITLE),t.NAV_CHAIN&&e.ajax.UpdatePageNavChain(t.NAV_CHAIN),t.CSS&&t.CSS.length>0&&e.loadCSS(t.CSS),t.SCRIPTS&&t.SCRIPTS.length>0){var i=function(o,n,s){if(n&&e.type.isArray(n.scripts))for(var r=0,a=t.SCRIPTS.length;a>r;r++)n.scripts.push({isInternal:!1,JS:t.SCRIPTS[r]});else e.loadScript(t.SCRIPTS,s);e.removeCustomEvent("onAjaxSuccess",i)};e.addCustomEvent("onAjaxSuccess",i)}else{var o=function(t,i,n){e.type.isFunction(n)&&n(),e.removeCustomEvent("onAjaxSuccess",o)};e.addCustomEvent("onAjaxSuccess",o)}},e.ajax.UpdatePageTitle=function(t){var i=e("pagetitle");i&&(i.removeChild(i.firstChild),i.firstChild?i.insertBefore(document.createTextNode(t),i.firstChild):i.appendChild(document.createTextNode(t))),document.title=t},e.ajax.UpdatePageNavChain=function(t){var i=e("navigation");i&&(i.innerHTML=t)},e.userOptions={options:null,bSend:!1,delay:5e3},e.userOptions.save=function(t,i,o,n,s){null==e.userOptions.options&&(e.userOptions.options={}),s=!!s,e.userOptions.options[t+"."+i+"."+o]=[t,i,o,n,s];var r=e.userOptions.__get();""!=r&&(document.cookie=e.message("COOKIE_PREFIX")+"_LAST_SETTINGS="+r+"&sessid="+e.bitrix_sessid()+"; expires=Thu, 31 Dec 2020 23:59:59 GMT; path=/;"),e.userOptions.bSend||(e.userOptions.bSend=!0,setTimeout(function(){e.userOptions.send(null)},e.userOptions.delay))},e.userOptions.send=function(t){var i=e.userOptions.__get();e.userOptions.options=null,e.userOptions.bSend=!1,""!=i&&(document.cookie=e.message("COOKIE_PREFIX")+"_LAST_SETTINGS=; path=/;",e.ajax({method:"GET",dataType:"html",processData:!1,cache:!1,url:"/bitrix/admin/user_options.php?"+i+"&sessid="+e.bitrix_sessid(),onsuccess:t}))},e.userOptions.del=function(t,i,o,n){e.ajax.get("/bitrix/admin/user_options.php?action=delete&c="+t+"&n="+i+(1==o?"&common=Y":"")+"&sessid="+e.bitrix_sessid(),n)},e.userOptions.__get=function(){if(!e.userOptions.options)return"";var t,i,o="",n=-1,s="";for(i in e.userOptions.options)e.userOptions.options.hasOwnProperty(i)&&(t=e.userOptions.options[i],s!=t[0]+"."+t[1]&&(n++,o+="&p["+n+"][c]="+e.util.urlencode(t[0]),o+="&p["+n+"][n]="+e.util.urlencode(t[1]),1==t[4]&&(o+="&p["+n+"][d]=Y"),s=t[0]+"."+t[1]),o+="&p["+n+"][v]["+e.util.urlencode(t[2])+"]="+e.util.urlencode(t[3]));return o.substr(1)},e.ajax.history={expected_hash:"",obParams:null,obFrame:null,obImage:null,obTimer:null,bInited:!1,bHashCollision:!1,bPushState:!(!history.pushState||!e.type.isFunction(history.pushState)),startState:null,init:function(i){if(!e.ajax.history.bInited){this.obParams=i;var o=this.obParams.getState();e.ajax.history.bPushState?(e.ajax.history.expected_hash=t.location.pathname,t.location.search&&(e.ajax.history.expected_hash+=t.location.search),e.ajax.history.put(o,e.ajax.history.expected_hash,"",!0),setTimeout(function(){e.bind(t,"popstate",e.ajax.history.__hashListener)},500)):(e.ajax.history.expected_hash=t.location.hash,e.ajax.history.expected_hash&&"#"!=e.ajax.history.expected_hash||(e.ajax.history.expected_hash="__bx_no_hash__"),a.put(e.ajax.history.expected_hash,o),e.ajax.history.obTimer=setTimeout(e.ajax.history.__hashListener,500),e.browser.IsIE()?(e.ajax.history.obFrame=document.createElement("IFRAME"),e.hide_object(e.ajax.history.obFrame),document.body.appendChild(e.ajax.history.obFrame),e.ajax.history.obFrame.contentWindow.document.open(),e.ajax.history.obFrame.contentWindow.document.write(e.ajax.history.expected_hash),e.ajax.history.obFrame.contentWindow.document.close()):e.browser.IsOpera()&&(e.ajax.history.obImage=document.createElement("IMG"),e.hide_object(e.ajax.history.obImage),document.body.appendChild(e.ajax.history.obImage),e.ajax.history.obImage.setAttribute("src","javascript:location.href = 'javascript:BX.ajax.history.__hashListener();';"))),e.ajax.history.bInited=!0}},__hashListener:function(i){if(i=i||t.event||{state:!1},e.ajax.history.bPushState)e.ajax.history.obParams.setState(i.state||e.ajax.history.startState);else{e.ajax.history.obTimer&&(t.clearTimeout(e.ajax.history.obTimer),e.ajax.history.obTimer=null);var o;if(o=null!=e.ajax.history.obFrame?e.ajax.history.obFrame.contentWindow.document.body.innerText:t.location.hash,o&&"#"!=o||(o="__bx_no_hash__"),0==o.indexOf("#")&&(o=o.substring(1)),o!=e.ajax.history.expected_hash){var n=a.get(o);if(n&&(e.ajax.history.obParams.setState(n),e.ajax.history.expected_hash=o,null!=e.ajax.history.obFrame)){var s="__bx_no_hash__"==o?"":o;t.location.hash!=s&&t.location.hash!="#"+s&&(t.location.hash=s)}}e.ajax.history.obTimer=setTimeout(e.ajax.history.__hashListener,500)}},put:function(i,o,n,s){this.bPushState?s?e.ajax.history.startState=i:history.pushState(i,"",o):(o="undefined"!=typeof n?n:"view"+o,a.put(o,i),e.ajax.history.expected_hash=o,t.location.hash=e.util.urlencode(o),null!=e.ajax.history.obFrame&&(e.ajax.history.obFrame.contentWindow.document.open(),e.ajax.history.obFrame.contentWindow.document.write(o),e.ajax.history.obFrame.contentWindow.document.close()))},checkRedirectStart:function(i,o){var n=t.location.hash;"#"==n.substring(0,1)&&(n=n.substring(1));var s=n.substring(0,5);"view/"!=s&&"view%"!=s||(e.ajax.history.bHashCollision=!0,document.write('<div id="__ajax_hash_collision_'+o+'" style="display: none;">'))},checkRedirectFinish:function(i,o){document.write("</div>");var n=t.location.hash;"#"==n.substring(0,1)&&(n=n.substring(1)),e.ready(function(){var t=n.substring(0,5);if("view/"==t||"view%"==t){var s=e("__ajax_hash_collision_"+o),r=s.firstChild;e.cleanNode(r),s.style.display="block","view%"!=t&&(n=e.util.urlencode(n)),n+=(-1==n.indexOf("%3F")?"%3F":"%26")+i+"="+o;var a="/bitrix/tools/ajax_redirector.php?hash="+n;e.ajax.insertToNode(a,r)}})}},e.ajax.component=function(t){this.node=t},e.ajax.component.prototype.getState=function(){var i={node:this.node,title:t.document.title,data:e(this.node).innerHTML},o=e("navigation");return null!=o&&(i.nav_chain=o.innerHTML),i},e.ajax.component.prototype.setState=function(t){
e(t.node).innerHTML=t.data,e.ajax.UpdatePageTitle(t.title),t.nav_chain&&e.ajax.UpdatePageNavChain(t.nav_chain)};var a={arHistory:{},put:function(t,e){this.arHistory[t]=e},get:function(t){return this.arHistory[t]}};e.ajax.FormData=function(){this.elements=[],this.files=[],this.features={},this.isSupported(),this.log("BX FormData init")},e.ajax.FormData.isSupported=function(){var t=new e.ajax.FormData,i=t.features.supported;return t=null,i},e.ajax.FormData.prototype.log=function(t){},e.ajax.FormData.prototype.isSupported=function(){var e={};return e.fileReader=t.FileReader&&t.FileReader.prototype.readAsBinaryString,e.readFormData=e.sendFormData=!!t.FormData,e.supported=!(!e.readFormData||!e.sendFormData),this.features=e,this.log("features:"),this.log(e),e.supported},e.ajax.FormData.prototype.append=function(t,e){"object"==typeof e?this.files.push({name:t,value:e}):this.elements.push({name:t,value:e})},e.ajax.FormData.prototype.send=function(t,i,o,n){if(this.log("FD send"),this.xhr=e.ajax({method:"POST",dataType:"html",url:t,onsuccess:i,onfailure:n,start:!1,preparePost:!1}),o&&this.xhr.upload.addEventListener("progress",function(t){t.lengthComputable&&o(t.loaded/(t.total||t.totalSize))},!1),this.features.readFormData&&this.features.sendFormData){var s=new FormData;this.log("use browser formdata");for(var r in this.elements)this.elements.hasOwnProperty(r)&&s.append(this.elements[r].name,this.elements[r].value);for(r in this.files)this.files.hasOwnProperty(r)&&s.append(this.files[r].name,this.files[r].value);this.xhr.send(s)}return this.xhr},e.addCustomEvent("onAjaxFailure",e.debug)}}(window),function(window){BX.WindowManager||(BX.WindowManager={_stack:[],_runtime_resize:{},_delta:2,_delta_start:1e3,currently_loaded:null,settings_category:"BX.WindowManager.9.5",register:function(t){this.currently_loaded=null;var e=t.Get();e.style.zIndex=t.zIndex=this.GetZIndex(),t.WM_REG_INDEX=this._stack.length,this._stack.push(t),this._stack.length<2&&BX.bind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},unregister:function(t){if(null==t.WM_REG_INDEX)return null;var e;if(this._stack.length>0){for(;(e=this.__pop_stack())!=t;)if(!e){e=null;break}return this._stack.length<=0&&this.enableKeyCheck(),e}return null},__pop_stack:function(t){if(this._stack.length>0){var e=this._stack.pop();return e.WM_REG_INDEX=null,BX.onCustomEvent(e,"onWindowUnRegister",[t===!0]),e}return null},clean:function(){for(;this.__pop_stack(!0););this._stack=null,this.disableKeyCheck()},Get:function(){return this.currently_loaded?this.currently_loaded:this._stack.length>0?this._stack[this._stack.length-1]:null},setStartZIndex:function(t){this._delta_start=t},restoreStartZIndex:function(){this._delta_start=1e3},GetZIndex:function(){var t;return null!=(t=this._stack[this._stack.length-1])?parseInt(t.Get().style.zIndex)+this._delta:this._delta_start},__get_check_url:function(t){var e=t.indexOf("?");return-1==e?t:t.substring(0,e)},saveWindowSize:function(t,e){var i=this.__get_check_url(t);BX.userOptions&&(BX.userOptions.save(this.settings_category,"size_"+i,"width",e.width),BX.userOptions.save(this.settings_category,"size_"+i,"height",e.height)),this._runtime_resize[i]=e},saveWindowOptions:function(t,e){if(BX.userOptions)for(var i in e)e.hasOwnProperty(i)&&BX.userOptions.save(this.settings_category,"options_"+t,i,e[i])},getRuntimeWindowSize:function(t){return this._runtime_resize[this.__get_check_url(t)]},disableKeyCheck:function(){BX.unbind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},enableKeyCheck:function(){BX.bind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},__checkKeyPress:function(t){if(null==t&&(t=window.event),27==t.keyCode){var e=BX.WindowManager.Get();e&&!e.unclosable&&e.Close()}}},BX.garbage(BX.WindowManager.clean,BX.WindowManager),BX.CWindowButton=function(t){t.btn?(this.btn=t.btn,this.parentWindow=t.parentWindow,/save|apply/i.test(this.btn.name)&&BX.bind(this.btn,"click",BX.delegate(this.disableUntilError,this))):(this.title=t.title,this.hint=t.hint,this.id=t.id,this.name=t.name,this.className=t.className,this.action=t.action,this.onclick=t.onclick,t.Button&&BX.type.isFunction(t.Button)&&(this.Button=t.Button),this.btn=null)},BX.CWindowButton.prototype.disable=function(){this.btn&&this.parentWindow.showWait(this.btn)},BX.CWindowButton.prototype.enable=function(){this.btn&&this.parentWindow.closeWait(this.btn)},BX.CWindowButton.prototype.emulate=function(){if(!this.btn||!this.btn.disabled){var t=this.action?BX.delegate(this.action,this):this.onclick?this.onclick:this.btn?this.btn.getAttribute("onclick"):"";t&&(setTimeout(t,50),this.btn&&/save|apply/i.test(this.btn.name)&&!this.action&&this.disableUntilError())}},BX.CWindowButton.prototype.Button=function(parentWindow){this.parentWindow=parentWindow;var btn={props:{type:"button",name:this.id?this.id:this.name,value:this.title?this.title:this.name,id:this.id}};return this.hint&&(btn.props.title=this.hint),this.className&&(btn.props.className=this.className),this.action?btn.events={click:BX.delegate(this.action,this)}:this.onclick&&(BX.browser.IsIE()?btn.events={click:BX.delegate(function(){eval(this.onclick)},this)}:btn.attrs={onclick:this.onclick}),this.btn=BX.create("INPUT",btn),this.btn},BX.CWindowButton.prototype.disableUntilError=function(){this.disable(),this.__window_error_handler_set||(BX.addCustomEvent(this.parentWindow,"onWindowError",BX.delegate(this.enable,this)),this.__window_error_handler_set=!0)},BX.CWindow=function(t,e){this.DIV=t||document.createElement("DIV"),this.SETTINGS={resizable:!1,min_height:0,min_width:0,top:0,left:0,draggable:!1,drag_restrict:!0,resize_restrict:!0},this.ELEMENTS={draggable:[],resizer:[],close:[]},this.type="float"==e?"float":"dialog",BX.adjust(this.DIV,{props:{className:"bx-core-window"},style:{zIndex:0,position:"absolute",display:"none",top:this.SETTINGS.top+"px",left:this.SETTINGS.left+"px",height:"100px",width:"100px"}}),this.isOpen=!1,BX.addCustomEvent(this,"onWindowRegister",BX.delegate(this.onRegister,this)),BX.addCustomEvent(this,"onWindowUnRegister",BX.delegate(this.onUnRegister,this)),this.MOUSEOVER=null,BX.bind(this.DIV,"mouseover",BX.delegate(this.__set_msover,this)),BX.bind(this.DIV,"mouseout",BX.delegate(this.__unset_msover,this)),BX.ready(BX.delegate(function(){document.body.appendChild(this.DIV)},this))},BX.CWindow.prototype.Get=function(){return this.DIV},BX.CWindow.prototype.visible=function(){return this.isOpen},BX.CWindow.prototype.Show=function(t){this.DIV.style.display="block",t||(BX.WindowManager.register(this),BX.onCustomEvent(this,"onWindowRegister"))},BX.CWindow.prototype.Hide=function(){BX.WindowManager.unregister(this),this.DIV.style.display="none"},BX.CWindow.prototype.onRegister=function(){this.isOpen=!0},BX.CWindow.prototype.onUnRegister=function(t){this.isOpen=!1,t||this.PARAMS&&this.PARAMS.content_url?(t&&BX.onCustomEvent(this,"onWindowClose",[this,!0]),this.DIV.parentNode&&this.DIV.parentNode.removeChild(this.DIV)):this.DIV.style.display="none"},BX.CWindow.prototype.CloseDialog=BX.CWindow.prototype.Close=function(t){if(BX.onCustomEvent(this,"onBeforeWindowClose",[this]),t!==!0&&this.denyClose)return!1;if(BX.onCustomEvent(this,"onWindowClose",[this]),this.bExpanded){var e=BX.GetDocElement();BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this)),e.style.overflow=this.__expand_settings.overflow}return BX.WindowManager.unregister(this),!0},BX.CWindow.prototype.SetResize=function(t){t.style.cursor="se-resize",BX.bind(t,"mousedown",BX.proxy(this.__startResize,this)),this.ELEMENTS.resizer.push(t),this.SETTINGS.resizable=!0},BX.CWindow.prototype.SetExpand=function(t,e){e=e||"click",BX.bind(t,e,BX.proxy(this.__expand,this))},BX.CWindow.prototype.__expand_onresize=function(){var t=BX.GetWindowInnerSize();this.DIV.style.width=t.innerWidth+"px",this.DIV.style.height=t.innerHeight+"px",BX.onCustomEvent(this,"onWindowResize")},BX.CWindow.prototype.__expand=function(){var t=BX.GetDocElement();if(this.bExpanded)BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this)),this.SETTINGS.resizable=this.__expand_settings.resizable,this.SETTINGS.draggable=this.__expand_settings.draggable,t.style.overflow=this.__expand_settings.overflow,this.DIV.style.top=this.__expand_settings.top,this.DIV.style.left=this.__expand_settings.left,this.DIV.style.width=this.__expand_settings.width,this.DIV.style.height=this.__expand_settings.height,window.scrollTo(this.__expand_settings.scrollLeft,this.__expand_settings.scrollTop),this.bExpanded=!1,BX.onCustomEvent(this,"onWindowNarrow"),BX.onCustomEvent(this,"onWindowResize");else{var e=BX.GetWindowScrollPos(),i=BX.GetWindowInnerSize();this.__expand_settings={resizable:this.SETTINGS.resizable,draggable:this.SETTINGS.draggable,width:this.DIV.style.width,height:this.DIV.style.height,left:this.DIV.style.left,top:this.DIV.style.top,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,overflow:BX.style(t,"overflow")},this.SETTINGS.resizable=!1,this.SETTINGS.draggable=!1,window.scrollTo(0,0),t.style.overflow="hidden",this.DIV.style.top="0px",this.DIV.style.left="0px",this.DIV.style.width=i.innerWidth+"px",this.DIV.style.height=i.innerHeight+"px",this.bExpanded=!0,BX.onCustomEvent(this,"onWindowExpand"),BX.onCustomEvent(this,"onWindowResize"),BX.bind(window,"resize",BX.proxy(this.__expand_onresize,this))}},BX.CWindow.prototype.Resize=function(t,e){var i=Math.max(t-this.pos.left+this.dx,this.SETTINGS.min_width),o=Math.max(e-this.pos.top+this.dy,this.SETTINGS.min_height);if(this.SETTINGS.resize_restrict){var n=BX.GetWindowScrollSize();this.pos.left+i>n.scrollWidth-this.dw&&(i=n.scrollWidth-this.pos.left-this.dw)}this.DIV.style.width=i+"px",this.DIV.style.height=o+"px",BX.onCustomEvent(this,"onWindowResize")},BX.CWindow.prototype.__startResize=function(t){if(!this.SETTINGS.resizable)return!1;t||(t=window.event),this.wndSize=BX.GetWindowScrollPos(),this.wndSize.innerWidth=BX.GetWindowInnerSize().innerWidth,this.pos=BX.pos(this.DIV),this.x=t.clientX+this.wndSize.scrollLeft,this.y=t.clientY+this.wndSize.scrollTop,this.dx=this.pos.left+this.pos.width-this.x,this.dy=this.pos.top+this.pos.height-this.y,this.dw=this.pos.width-parseInt(this.DIV.style.width),BX.bind(document,"mousemove",BX.proxy(this.__moveResize,this)),BX.bind(document,"mouseup",BX.proxy(this.__stopResize,this)),document.body.setCapture&&document.body.setCapture(),document.onmousedown=BX.False;var e=document.body;return e.ondrag=e.onselectstart=BX.False,e.style.MozUserSelect=this.DIV.style.MozUserSelect="none",e.style.cursor="se-resize",BX.onCustomEvent(this,"onWindowResizeStart"),!0},BX.CWindow.prototype.__moveResize=function(t){t||(t=window.event);var e=BX.GetWindowScrollPos(),i=t.clientX+e.scrollLeft,o=t.clientY+e.scrollTop;this.x==i&&this.y==o||(this.Resize(i,o),this.x=i,this.y=o)},BX.CWindow.prototype.__stopResize=function(){document.body.releaseCapture&&document.body.releaseCapture(),BX.unbind(document,"mousemove",BX.proxy(this.__moveResize,this)),BX.unbind(document,"mouseup",BX.proxy(this.__stopResize,this)),document.onmousedown=null;var t=document.body;t.ondrag=t.onselectstart=null,t.style.MozUserSelect=this.DIV.style.MozUserSelect="",t.style.cursor="",BX.onCustomEvent(this,"onWindowResizeFinished")},BX.CWindow.prototype.SetClose=function(t){BX.bind(t,"click",BX.proxy(this.Close,this)),this.ELEMENTS.close.push(t)},BX.CWindow.prototype.SetDraggable=function(t){BX.bind(t,"mousedown",BX.proxy(this.__startDrag,this)),t.style.cursor="move",this.ELEMENTS.draggable.push(t),this.SETTINGS.draggable=!0},BX.CWindow.prototype.Move=function(t,e){var i=1,o=parseInt(this.DIV.style.left)+t,n=parseInt(this.DIV.style.top)+e;if(this.SETTINGS.drag_restrict){0>o&&(o=0);var s=BX.GetWindowScrollSize(),r=this.DIV.offsetWidth,a=this.DIV.offsetHeight;o>s.scrollWidth-r-i&&(o=s.scrollWidth-r-i),n>s.scrollHeight-a-i&&(n=s.scrollHeight-a-i),0>n&&(n=0)}this.DIV.style.left=o+"px",this.DIV.style.top=n+"px"},BX.CWindow.prototype.__startDrag=function(t){if(!this.SETTINGS.draggable)return!1;t||(t=window.event),this.x=t.clientX+document.body.scrollLeft,this.y=t.clientY+document.body.scrollTop,this.__bWasDragged=!1,BX.bind(document,"mousemove",BX.proxy(this.__moveDrag,this)),BX.bind(document,"mouseup",BX.proxy(this.__stopDrag,this)),document.body.setCapture&&document.body.setCapture(),document.onmousedown=BX.False;var e=document.body;return e.ondrag=e.onselectstart=BX.False,e.style.MozUserSelect=this.DIV.style.MozUserSelect="none",e.style.cursor="move",BX.PreventDefault(t)},BX.CWindow.prototype.__moveDrag=function(t){t||(t=window.event);var e=t.clientX+document.body.scrollLeft,i=t.clientY+document.body.scrollTop;this.x==e&&this.y==i||(this.Move(e-this.x,i-this.y),this.x=e,this.y=i,this.__bWasDragged||(BX.onCustomEvent(this,"onWindowDragStart"),this.__bWasDragged=!0,BX.bind(BX.proxy_context,"click",BX.PreventDefault)),BX.onCustomEvent(this,"onWindowDrag"))},BX.CWindow.prototype.__stopDrag=function(t){document.body.releaseCapture&&document.body.releaseCapture(),BX.unbind(document,"mousemove",BX.proxy(this.__moveDrag,this)),BX.unbind(document,"mouseup",BX.proxy(this.__stopDrag,this)),document.onmousedown=null;var e=document.body;if(e.ondrag=e.onselectstart=null,e.style.MozUserSelect=this.DIV.style.MozUserSelect="",e.style.cursor="",this.__bWasDragged){BX.onCustomEvent(this,"onWindowDragFinished");var i=BX.proxy_context;setTimeout(function(){BX.unbind(i,"click",BX.PreventDefault)},100),this.__bWasDragged=!1}return BX.PreventDefault(t)},BX.CWindow.prototype.DenyClose=function(){this.denyClose=!0},BX.CWindow.prototype.AllowClose=function(){this.denyClose=!1},BX.CWindow.prototype.ShowError=function(t){BX.onCustomEvent(this,"onWindowError",[t]),this._wait&&BX.closeWait(this._wait),window.alert(t)},BX.CWindow.prototype.__set_msover=function(){this.MOUSEOVER=!0},BX.CWindow.prototype.__unset_msover=function(){this.MOUSEOVER=!1},BX.CWindowDialog=function(){var t=arguments;t[1]="dialog",BX.CWindowDialog.superclass.constructor.apply(this,t),this.DIV.style.top="10px",this.OVERLAY=null},BX.extend(BX.CWindowDialog,BX.CWindow),BX.CWindowDialog.prototype.__resizeOverlay=function(){var t=BX.GetWindowScrollSize();this.OVERLAY.style.width=t.scrollWidth+"px"},BX.CWindowDialog.prototype.CreateOverlay=function(t){if(null==this.OVERLAY){var e=BX.GetWindowScrollSize();this.OVERLAY=document.body.appendChild(BX.create("DIV",{style:{position:"absolute",top:"0px",left:"0px",zIndex:t||parseInt(this.DIV.style.zIndex)-2,width:e.scrollWidth+"px",height:e.scrollHeight+"px"}}))}return this.OVERLAY},BX.CWindowDialog.prototype.Show=function(){BX.CWindowDialog.superclass.Show.apply(this,arguments),this.CreateOverlay(),this.OVERLAY.style.display="block",this.OVERLAY.style.zIndex=parseInt(this.DIV.style.zIndex)-2,BX.unbind(window,"resize",BX.proxy(this.__resizeOverlay,this)),BX.bind(window,"resize",BX.proxy(this.__resizeOverlay,this))},BX.CWindowDialog.prototype.onUnRegister=function(){BX.CWindowDialog.superclass.onUnRegister.apply(this,arguments),this.clean?this.OVERLAY.parentNode&&this.OVERLAY.parentNode.removeChild(this.OVERLAY):this.OVERLAY.style.display="none",BX.unbind(window,"resize",BX.proxy(this.__resizeOverlay,this))},BX.CDialog=function(t){BX.CDialog.superclass.constructor.apply(this),this._sender="core_window_cdialog",this.PARAMS=t||{};for(var e in this.defaultParams)"undefined"==typeof this.PARAMS[e]&&(this.PARAMS[e]=this.defaultParams[e]);if(this.PARAMS.width=isNaN(parseInt(this.PARAMS.width))?this.defaultParams.width:this.PARAMS.width,this.PARAMS.height=isNaN(parseInt(this.PARAMS.height))?this.defaultParams.height:this.PARAMS.height,this.PARAMS.resize_id||this.PARAMS.content_url){var i=BX.WindowManager.getRuntimeWindowSize(this.PARAMS.resize_id||this.PARAMS.content_url);i&&(this.PARAMS.width=i.width,this.PARAMS.height=i.height)}BX.addClass(this.DIV,"bx-core-adm-dialog"),this.DIV.id="bx-admin-prefix",this.PARTS={},this.DIV.style.height=null,this.DIV.style.width=null,this.PARTS.TITLEBAR=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head"}})),this.PARTS.TITLE_CONTAINER=this.PARTS.TITLEBAR.appendChild(BX.create("SPAN",{props:{className:"bx-core-adm-dialog-head-inner"},text:this.PARAMS.title})),this.PARTS.TITLEBAR_ICONS=this.PARTS.TITLEBAR.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head-icons"},children:this.PARAMS.resizable?[BX.create("SPAN",{props:{className:"bx-core-adm-icon-expand",title:BX.message("JS_CORE_WINDOW_EXPAND")}}),BX.create("SPAN",{props:{className:"bx-core-adm-icon-close",title:BX.message("JS_CORE_WINDOW_CLOSE")}})]:[BX.create("SPAN",{props:{className:"bx-core-adm-icon-close",title:BX.message("JS_CORE_WINDOW_CLOSE")}})]})),this.PARTS.CONTENT=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-content-wrap adm-workarea"}})),this.PARTS.CONTENT_DATA=this.PARTS.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-content"},style:{height:this.PARAMS.height+"px",width:this.PARAMS.width+"px"}})),this.PARTS.HEAD=this.PARTS.CONTENT_DATA.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head-block"+(this.PARAMS.icon?" "+this.PARAMS.icon:"")}})),this.SetHead(this.PARAMS.head),this.SetContent(this.PARAMS.content),this.SetTitle(this.PARAMS.title),this.SetClose(this.PARTS.TITLEBAR_ICONS.lastChild),this.PARAMS.resizable&&(this.SetExpand(this.PARTS.TITLEBAR_ICONS.firstChild),this.SetExpand(this.PARTS.TITLEBAR,"dblclick"),BX.addCustomEvent(this,"onWindowExpand",BX.proxy(this.__onexpand,this)),BX.addCustomEvent(this,"onWindowNarrow",BX.proxy(this.__onexpand,this))),this.PARTS.FOOT=this.PARTS.BUTTONS_CONTAINER=this.PARTS.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-buttons"},children:this.ShowButtons()})),this.PARAMS.draggable&&this.SetDraggable(this.PARTS.TITLEBAR),this.PARAMS.resizable&&(this.PARTS.RESIZER=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-resizer"}})),this.SetResize(this.PARTS.RESIZER),this.SETTINGS.min_width=this.PARAMS.min_width,this.SETTINGS.min_height=this.PARAMS.min_height),this.auth_callback=BX.delegate(function(){this.PARAMS.content="",this.hideNotify(),this.Show()},this)},BX.extend(BX.CDialog,BX.CWindowDialog),BX.CDialog.prototype.defaultParams={width:700,height:400,min_width:500,min_height:300,resizable:!0,draggable:!0,title:"",icon:""},BX.CDialog.prototype.showWait=function(t){if(BX.type.isElementNode(t)&&("button"==t.type||"submit"==t.type)){BX.defer(function(){t.disabled=!0})();var e=BX.hasClass(t,"adm-btn-save")||BX.hasClass(t,"adm-btn-save"),i=BX.pos(t,!0);return t.bxwaiter=this.PARTS.FOOT.appendChild(BX.create("DIV",{props:{className:"adm-btn-load-img"+(e?"-green":"")},style:{top:parseInt((i.bottom+i.top)/2-10)+"px",left:parseInt((i.right+i.left)/2-10)+"px"}})),BX.addClass(t,"adm-btn-load"),this.lastWaitElement=t,t.bxwaiter}return null},BX.CDialog.prototype.closeWait=function(t){t=t||this.lastWaitElement,BX.type.isElementNode(t)&&(t.bxwaiter&&(t.bxwaiter.parentNode&&t.bxwaiter.parentNode.removeChild(t.bxwaiter),t.bxwaiter=null),t.disabled=!1,BX.removeClass(t,"adm-btn-load"),this.lastWaitElement==t&&(this.lastWaitElement=null))},BX.CDialog.prototype.Authorize=function(t){this.bSkipReplaceContent=!0,this.ShowError(BX.message("JSADM_AUTH_REQ")),BX.onCustomEvent(this,"onWindowError",[]),BX.closeWait(),new BX.CAuthDialog({content_url:this.PARAMS.content_url,auth_result:t,callback:BX.delegate(function(){this.auth_callback&&this.auth_callback()},this)}).Show()},BX.CDialog.prototype.ShowError=function(t){BX.onCustomEvent(this,"onWindowError",[t]),this.closeWait(),this._wait&&BX.closeWait(this._wait),this.Notify(t,!0)},BX.CDialog.prototype.__expandGetSize=function(){var t=BX.GetDocElement();t.style.overflow="hidden";var e=BX.GetWindowInnerSize();return t.scrollTop=0,this.DIV.style.top="-"+this.dxShadow+"px",this.DIV.style.left="-"+this.dxShadow+"px",{width:e.innerWidth-parseInt(BX.style(this.PARTS.CONTENT,"padding-right"))-parseInt(BX.style(this.PARTS.CONTENT,"padding-left"))+this.dxShadow,height:e.innerHeight-this.PARTS.TITLEBAR.offsetHeight-this.PARTS.FOOT.offsetHeight-parseInt(BX.style(this.PARTS.CONTENT,"padding-top"))-parseInt(BX.style(this.PARTS.CONTENT,"padding-bottom"))+this.dxShadow}},BX.CDialog.prototype.__expand=function(){var t=BX.GetDocElement();if(this.dxShadow=2,this.bExpanded)BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this)),this.SETTINGS.resizable=this.__expand_settings.resizable,this.SETTINGS.draggable=this.__expand_settings.draggable,t.style.overflow=this.__expand_settings.overflow,this.DIV.style.top=this.__expand_settings.top,this.DIV.style.left=this.__expand_settings.left,this.PARTS.CONTENT_DATA.style.width=this.__expand_settings.width,this.PARTS.CONTENT_DATA.style.height=this.__expand_settings.height,window.scrollTo(this.__expand_settings.scrollLeft,this.__expand_settings.scrollTop),this.bExpanded=!1,BX.onCustomEvent(this,"onWindowNarrow"),BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[{width:parseInt(this.__expand_settings.width),height:parseInt(this.__expand_settings.height)}]);else{var e=BX.GetWindowScrollPos();this.__expand_settings={resizable:this.SETTINGS.resizable,draggable:this.SETTINGS.draggable,width:this.PARTS.CONTENT_DATA.style.width,height:this.PARTS.CONTENT_DATA.style.height,left:this.DIV.style.left,top:this.DIV.style.top,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,overflow:BX.style(t,"overflow")},this.SETTINGS.resizable=!1,this.SETTINGS.draggable=!1;var i=this.__expandGetSize();this.PARTS.CONTENT_DATA.style.width=i.width+"px",this.PARTS.CONTENT_DATA.style.height=i.height+"px",window.scrollTo(0,0),t.style.overflow="hidden",this.bExpanded=!0,BX.onCustomEvent(this,"onWindowExpand"),BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[{width:i.width,height:i.height}]),BX.bind(window,"resize",BX.proxy(this.__expand_onresize,this))}},BX.CDialog.prototype.__expand_onresize=function(){var t=this.__expandGetSize();this.PARTS.CONTENT_DATA.style.width=t.width+"px",this.PARTS.CONTENT_DATA.style.height=t.height+"px",BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[t])},BX.CDialog.prototype.__onexpand=function(){var t=this.PARTS.TITLEBAR_ICONS.firstChild;t.className=BX.toggle(t.className,["bx-core-adm-icon-expand","bx-core-adm-icon-narrow"]),t.title=BX.toggle(t.title,[BX.message("JS_CORE_WINDOW_EXPAND"),BX.message("JS_CORE_WINDOW_NARROW")]),this.PARTS.RESIZER&&(this.PARTS.RESIZER.style.display=this.bExpanded?"none":"block")},BX.CDialog.prototype.__startResize=function(t){if(!this.SETTINGS.resizable)return!1;t||(t=window.event),this.wndSize=BX.GetWindowScrollPos(),this.wndSize.innerWidth=BX.GetWindowInnerSize().innerWidth,this.pos=BX.pos(this.PARTS.CONTENT_DATA),this.x=t.clientX+this.wndSize.scrollLeft,this.y=t.clientY+this.wndSize.scrollTop,this.dx=this.pos.left+this.pos.width-this.x,this.dy=this.pos.top+this.pos.height-this.y,this.dw=this.pos.width-parseInt(this.PARTS.CONTENT_DATA.style.width)+parseInt(BX.style(this.PARTS.CONTENT,"padding-right")),BX.bind(document,"mousemove",BX.proxy(this.__moveResize,this)),BX.bind(document,"mouseup",BX.proxy(this.__stopResize,this)),document.body.setCapture&&document.body.setCapture(),document.onmousedown=BX.False;var e=document.body;return e.ondrag=e.onselectstart=BX.False,e.style.MozUserSelect=this.DIV.style.MozUserSelect="none",e.style.cursor="se-resize",BX.onCustomEvent(this,"onWindowResizeStart"),!0},BX.CDialog.prototype.Resize=function(t,e){var i=Math.max(t-this.pos.left+this.dx,this.SETTINGS.min_width),o=Math.max(e-this.pos.top+this.dy,this.SETTINGS.min_height);if(this.SETTINGS.resize_restrict){var n=BX.GetWindowScrollSize();this.pos.left+i>n.scrollWidth-this.dw&&(i=n.scrollWidth-this.pos.left-this.dw)}this.PARTS.CONTENT_DATA.style.width=i+"px",this.PARTS.CONTENT_DATA.style.height=o+"px",BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[{height:o,width:i}])},BX.CDialog.prototype.SetSize=function(t){this.PARTS.CONTENT_DATA.style.width=t.width+"px",this.PARTS.CONTENT_DATA.style.height=t.height+"px",BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[t])},BX.CDialog.prototype.GetParameters=function(t){var e=this.GetForm();if(!e)return"";var i,o="",n=e.elements.length,s="";for(i=0;n>i;i++){""!=o&&(s="&");var r=e.elements[i];if(!r.disabled)switch(r.type.toLowerCase()){case"text":case"textarea":case"password":case"hidden":if(null==t&&"_alt"==r.name.substr(r.name.length-4)&&e.elements[r.name.substr(0,r.name.length-4)])break;o+=s+r.name+"="+BX.util.urlencode(r.value);break;case"radio":r.checked&&(o+=s+r.name+"="+BX.util.urlencode(r.value));break;case"checkbox":o+=s+r.name+"="+BX.util.urlencode(r.checked?"Y":"N");break;case"select-one":var a="";a=null==t&&e.elements[r.name+"_alt"]&&0==r.selectedIndex?e.elements[r.name+"_alt"].value:r.value,o+=s+r.name+"="+BX.util.urlencode(a);break;case"select-multiple":var l,h=!1,d=r.options.length;for(l=0;d>l;l++)r.options[l].selected&&(o+=s+r.name+"="+BX.util.urlencode(r.options[l].value),h=!0);h||(o+=s+r.name+"=")}}return o},BX.CDialog.prototype.PostParameters=function(t){var e=this.PARAMS.content_url;null==t&&(t=""),t+=(""==t?"":"&")+"bxsender="+this._sender;var i=e.indexOf("?");-1==i?e+="?"+t:e=e.substring(0,i)+"?"+t+"&"+e.substring(i+1),BX.showWait(),this.auth_callback=BX.delegate(function(){this.hideNotify(),this.PostParameters(t)},this),BX.ajax.Setup({skipAuthCheck:!0},!0),BX.ajax.post(e,this.GetParameters(),BX.delegate(function(t){BX.closeWait(),this.bSkipReplaceContent||(this.ClearButtons(),this.SetContent(t),this.Show(!0)),this.bSkipReplaceContent=!1},this))},BX.CDialog.prototype.Submit=function(t,e){var i=this.GetForm();if(i){if(i.onsubmit=null,i.method="POST",!i.action||e){if(e=e||this.PARAMS.content_url,null!=t){var o=e.indexOf("?");-1==o?e+="?"+t:e=e.substring(0,o)+"?"+t+"&"+e.substring(o+1)}i.action=e}i._bxsender||(i._bxsender=i.appendChild(BX.create("INPUT",{attrs:{type:"hidden",name:"bxsender",value:this._sender}}))),this._wait=BX.showWait(),this.auth_callback=BX.delegate(function(){this.hideNotify(),this.Submit(t)},this),BX.ajax.submit(i,BX.delegate(function(){this.closeWait()},this))}else window.alert("no form registered!")},BX.CDialog.prototype.GetForm=function(){if(null==this.__form){var t=this.PARTS.CONTENT_DATA.getElementsByTagName("FORM");this.__form=t[0]?t[0]:null}return this.__form},BX.CDialog.prototype.GetRealForm=function(){if(null==this.__rform){var t=this.PARTS.CONTENT_DATA.getElementsByTagName("FORM");this.__rform=t[1]?t[1]:t[0]?t[0]:null}return this.__rform},BX.CDialog.prototype._checkButton=function(t){for(var e=["btnSave","btnCancel","btnClose"],i=0;i<e.length;i++)if(this[e[i]]&&t==this[e[i]])return e[i];return!1},BX.CDialog.prototype.ShowButtons=function(){var t=[];if(this.PARAMS.buttons){this.PARAMS.buttons.title&&(this.PARAMS.buttons=[this.PARAMS.buttons]);for(var e=0,i=this.PARAMS.buttons.length;i>e;e++)if(BX.type.isNotEmptyString(this.PARAMS.buttons[e]))t.push(this.PARAMS.buttons[e]);else if(this.PARAMS.buttons[e]){if(!BX.is_subclass_of(this.PARAMS.buttons[e],BX.CWindowButton)){var o=this._checkButton(this.PARAMS.buttons[e]);this.PARAMS.buttons[e]=new BX.CWindowButton(this.PARAMS.buttons[e]),o&&(this[o]=this.PARAMS.buttons[e])}t.push(this.PARAMS.buttons[e].Button(this))}}return t},BX.CDialog.prototype.setAutosave=function(){this.bSetAutosaveDelay||(this.bSetAutosaveDelay=!0,setTimeout(BX.proxy(this.setAutosave,this),10))},BX.CDialog.prototype.SetTitle=function(t){this.PARAMS.title=t,BX.cleanNode(this.PARTS.TITLE_CONTAINER).appendChild(document.createTextNode(this.PARAMS.title))},BX.CDialog.prototype.SetHead=function(t){this.PARAMS.head=BX.util.trim(t),this.PARTS.HEAD.innerHTML=this.PARAMS.head||"&nbsp;",this.PARTS.HEAD.style.display=this.PARAMS.head?"block":"none",this.adjustSize()},BX.CDialog.prototype.Notify=function(t,e){this.PARTS.NOTIFY||(this.PARTS.NOTIFY=this.DIV.insertBefore(BX.create("DIV",{props:{className:"adm-warning-block"},children:[BX.create("SPAN",{props:{className:"adm-warning-text"}}),BX.create("SPAN",{props:{className:"adm-warning-icon"}}),BX.create("SPAN",{props:{className:"adm-warning-close"},events:{click:BX.proxy(this.hideNotify,this)}})]}),this.DIV.firstChild)),e?BX.addClass(this.PARTS.NOTIFY,"adm-warning-block-red"):BX.removeClass(this.PARTS.NOTIFY,"adm-warning-block-red"),this.PARTS.NOTIFY.firstChild.innerHTML=t||"&nbsp;",this.PARTS.NOTIFY.firstChild.style.width=this.PARAMS.width-50+"px",BX.removeClass(this.PARTS.NOTIFY,"adm-warning-animate")},BX.CDialog.prototype.hideNotify=function(){BX.addClass(this.PARTS.NOTIFY,"adm-warning-animate")},BX.CDialog.prototype.__adjustHeadToIcon=function(){this.PARTS.HEAD.offsetHeight?(this.icon_image&&this.icon_image.height&&this.icon_image.height>this.PARTS.HEAD.offsetHeight-5&&(this.PARTS.HEAD.style.height=this.icon_image.height+5+"px",this.adjustSize()),this.icon_image.onload=null,this.icon_image=null):setTimeout(BX.delegate(this.__adjustHeadToIcon,this),50)},BX.CDialog.prototype.SetIcon=function(t){if(this.PARAMS.icon!=t&&(this.PARAMS.icon&&BX.removeClass(this.PARTS.HEAD,this.PARAMS.icon),this.PARAMS.icon=t,this.PARAMS.icon)){BX.addClass(this.PARTS.HEAD,this.PARAMS.icon);var e=BX.style(this.PARTS.HEAD,"background-image")||BX.style(this.PARTS.HEAD,"backgroundImage");if(BX.type.isNotEmptyString(e)&&"none"!=e){var i=e.match(new RegExp("url\\s*\\(\\s*('|\"|)(.+?)(\\1)\\s*\\)"));i&&(e=i[2],BX.type.isNotEmptyString(e)&&(this.icon_image=new Image,this.icon_image.onload=BX.delegate(this.__adjustHeadToIcon,this),this.icon_image.src=e))}}this.adjustSize()},BX.CDialog.prototype.SetIconFile=function(t){this.icon_image=new Image,this.icon_image.onload=BX.delegate(this.__adjustHeadToIcon,this),this.icon_image.src=t,BX.adjust(this.PARTS.HEAD,{style:{backgroundImage:"url("+t+")",backgroundPosition:"right 9px"}}),this.adjustSize()},BX.CDialog.prototype.SetButtons=function(t){if(BX.type.isString(t)){if(t.length>0){this.PARTS.BUTTONS_CONTAINER.innerHTML+=t;var e=this.PARTS.BUTTONS_CONTAINER.getElementsByTagName("INPUT");if(e.length>0){this.PARAMS.buttons=[];for(var i=0;i<e.length;i++)this.PARAMS.buttons.push(new BX.CWindowButton({btn:e[i],parentWindow:this}))}}}else this.PARAMS.buttons=t,BX.adjust(this.PARTS.BUTTONS_CONTAINER,{children:this.ShowButtons()});this.adjustSize()},BX.CDialog.prototype.ClearButtons=function(){BX.cleanNode(this.PARTS.BUTTONS_CONTAINER),this.adjustSize()},BX.CDialog.prototype.SetContent=function(t){this.__form=null,BX.type.isElementNode(t)?t.parentNode&&t.parentNode.removeChild(t):BX.type.isString(t)&&(t=BX.create("DIV",{html:t})),this.PARAMS.content=t,BX.cleanNode(this.PARTS.CONTENT_DATA),BX.adjust(this.PARTS.CONTENT_DATA,{children:[this.PARTS.HEAD,BX.create("DIV",{props:{className:"bx-core-adm-dialog-content-wrap-inner"},children:[this.PARAMS.content]})]}),this.PARAMS.content_url&&this.GetForm()&&(this.__form.submitbtn=this.__form.appendChild(BX.create("INPUT",{props:{type:"submit"},style:{display:"none"}})),this.__form.onsubmit=BX.delegate(this.__submit,this))},BX.CDialog.prototype.__submit=function(t){for(var e=0,i=this.PARAMS.buttons.length;i>e;e++)if(this.PARAMS.buttons[e]&&(this.PARAMS.buttons[e].name&&/save|apply/i.test(this.PARAMS.buttons[e].name)||this.PARAMS.buttons[e].btn&&this.PARAMS.buttons[e].btn.name&&/save|apply/i.test(this.PARAMS.buttons[e].btn.name))){this.PARAMS.buttons[e].emulate();break}return BX.PreventDefault(t)},BX.CDialog.prototype.SwapContent=function(t){t=BX(t),BX.cleanNode(this.PARTS.CONTENT_DATA),t.parentNode.removeChild(t),this.PARTS.CONTENT_DATA.appendChild(t),t.style.display="block",this.SetContent(t.innerHTML)},BX.CDialog.prototype.adjustSize=function(){},BX.CDialog.prototype.__adjustSize=function(){},BX.CDialog.prototype.adjustSizeEx=function(){BX.defer(this.__adjustSizeEx,this)()},BX.CDialog.prototype.__adjustSizeEx=function(){for(var t=this.PARTS.CONTENT_DATA.firstChild,e=0;t;)e+=t.offsetHeight+parseInt(BX.style(t,"margin-top"))+parseInt(BX.style(t,"margin-bottom")),t=BX.nextSibling(t);
e&&(this.PARTS.CONTENT_DATA.style.height=e+"px")},BX.CDialog.prototype.__onResizeFinished=function(){BX.WindowManager.saveWindowSize(this.PARAMS.resize_id||this.PARAMS.content_url,{height:parseInt(this.PARTS.CONTENT_DATA.style.height),width:parseInt(this.PARTS.CONTENT_DATA.style.width)})},BX.CDialog.prototype.Show=function(t){if(!this.PARAMS.content&&this.PARAMS.content_url&&BX.ajax&&!t){var e=BX.showWait();BX.WindowManager.currently_loaded=this,this.CreateOverlay(parseInt(BX.style(e,"z-index"))-1),this.OVERLAY.style.display="block",this.OVERLAY.className="bx-core-dialog-overlay";var i="",o="GET";this.PARAMS.content_post&&(i=this.PARAMS.content_post,o="POST");var n=this.PARAMS.content_url+(this.PARAMS.content_url.indexOf("?")<0?"?":"&")+"bxsender="+this._sender;this.auth_callback=BX.delegate(function(){this.PARAMS.content="",this.hideNotify(),this.Show()},this),BX.ajax({method:o,dataType:"html",url:n,data:i,skipAuthCheck:!0,onsuccess:BX.delegate(function(t){BX.closeWait(null,e),this.SetContent(t||"&nbsp;"),this.Show()},this),processScriptsConsecutive:!0})}else BX.WindowManager.currently_loaded=null,BX.CDialog.superclass.Show.apply(this,arguments),this.adjustPos(),this.OVERLAY.className="bx-core-dialog-overlay",this.__adjustSize(),BX.addCustomEvent(this,"onWindowResize",BX.proxy(this.__adjustSize,this)),this.PARAMS.resizable&&(this.PARAMS.content_url||this.PARAMS.resize_id)&&BX.addCustomEvent(this,"onWindowResizeFinished",BX.delegate(this.__onResizeFinished,this))},BX.CDialog.prototype.GetInnerPos=function(){return{width:parseInt(this.PARTS.CONTENT_DATA.style.width),height:parseInt(this.PARTS.CONTENT_DATA.style.height)}},BX.CDialog.prototype.adjustPos=function(){if(!this.bExpanded){var t=BX.GetWindowInnerSize(),e=BX.GetWindowScrollPos();BX.adjust(this.DIV,{style:{left:parseInt(e.scrollLeft+t.innerWidth/2-parseInt(this.DIV.offsetWidth)/2)+"px",top:Math.max(parseInt(e.scrollTop+t.innerHeight/2-parseInt(this.DIV.offsetHeight)/2),0)+"px"}})}},BX.CDialog.prototype.GetContent=function(){return this.PARTS.CONTENT_DATA},BX.CDialog.prototype.btnSave=BX.CDialog.btnSave={title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",className:BX.browser.IsIE()&&BX.browser.IsDoctype()&&!BX.browser.IsIE10()?"":"adm-btn-save",action:function(){this.disableUntilError(),this.parentWindow.PostParameters()}},BX.CDialog.prototype.btnCancel=BX.CDialog.btnCancel={title:BX.message("JS_CORE_WINDOW_CANCEL"),id:"cancel",name:"cancel",action:function(){this.parentWindow.Close()}},BX.CDialog.prototype.btnClose=BX.CDialog.btnClose={title:BX.message("JS_CORE_WINDOW_CLOSE"),id:"close",name:"close",action:function(){this.parentWindow.Close()}},BX.CAdminDialog=function(){BX.CAdminDialog.superclass.constructor.apply(this,arguments),this._sender="core_window_cadmindialog",BX.addClass(this.DIV,"bx-core-adm-admin-dialog"),this.PARTS.CONTENT.insertBefore(this.PARTS.HEAD,this.PARTS.CONTENT.firstChild),this.PARTS.HEAD.className="bx-core-adm-dialog-tabs"},BX.extend(BX.CAdminDialog,BX.CDialog),BX.CAdminDialog.prototype.SetHead=function(){if(BX.CAdminDialog.superclass.SetHead.apply(this,arguments),this.PARTS.HEAD.firstChild&&BX.type.isElementNode(this.PARTS.HEAD.firstChild)){for(var t=this.PARTS.HEAD.firstChild,e=0;t;)e+=t.offsetWidth+parseInt(BX.style(t,"margin-left"))+parseInt(BX.style(t,"margin-right")),t=BX.nextSibling(t);this.SETTINGS.min_width=Math.max(e,this.SETTINGS.min_width)-2,this.PARAMS.width<this.SETTINGS.min_width&&BX.adjust(this.PARTS.CONTENT_DATA,{style:{width:this.SETTINGS.min_width+"px"}})}},BX.CAdminDialog.prototype.SetContent=function(t){this.__form=null,BX.type.isElementNode(t)&&t.parentNode&&t.parentNode.removeChild(t),this.PARAMS.content=t,BX.cleanNode(this.PARTS.CONTENT_DATA),BX.adjust(this.PARTS.CONTENT_DATA,{children:[this.PARAMS.content||"&nbsp;"]}),this.PARAMS.content_url&&this.GetForm()&&(this.__form.appendChild(BX.create("INPUT",{props:{type:"submit"},style:{display:"none"}})),this.__form.onsubmit=BX.delegate(this.__submit,this))},BX.CAdminDialog.prototype.__adjustSizeEx=function(){var t=BX.firstChild(this.PARTS.CONTENT_DATA).offsetHeight;t&&(this.PARTS.CONTENT_DATA.style.height=t+"px")},BX.CAdminDialog.prototype.__expandGetSize=function(){var t=BX.CAdminDialog.superclass.__expandGetSize.apply(this,arguments);return t.width-=parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-right"))+parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-left")),t.height-=parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-top"))+parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-bottom")),t.height-=this.PARTS.HEAD.offsetHeight,t},BX.CAdminDialog.prototype.Submit=function(){var t=this.GetForm();return!t||t.bxpublic||/bxpublic=/.test(t.action)||t.appendChild(BX.create("INPUT",{props:{type:"hidden",name:"bxpublic",value:"Y"}})),BX.CAdminDialog.superclass.Submit.apply(this,arguments)},BX.CAdminDialog.prototype.btnSave=BX.CAdminDialog.btnSave={title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",className:"adm-btn-save",action:function(){this.disableUntilError(),this.parentWindow.Submit()}},BX.CAdminDialog.btnCancel=BX.CAdminDialog.superclass.btnCancel,BX.CAdminDialog.btnClose=BX.CAdminDialog.superclass.btnClose,BX.CDebugDialog=function(){BX.CDebugDialog.superclass.constructor.apply(this,arguments)},BX.extend(BX.CDebugDialog,BX.CDialog),BX.CDebugDialog.prototype.ShowDetails=function(t){var e=BX(t);e&&(this.div_detail_current&&(this.div_detail_current.style.display="none"),e.style.display="block",this.div_detail_current=e)},BX.CDebugDialog.prototype.SetContent=function(t){if(t){var e=t.split("#DIVIDER#");e.length>1?(this.PARAMS.content=e[1],this.PARTS.CONTENT_DATA.style.overflow="hidden",BX.CDebugDialog.superclass.SetContent.apply(this,[e[1]]),this.PARTS.CONTENT_INNER=this.PARTS.CONTENT_DATA.firstChild.nextSibling,this.PARTS.CONTENT_TOP=this.PARTS.CONTENT_DATA.insertBefore(BX.create("DIV",{props:{className:"bx-debug-content-top"},html:e[0]}),this.PARTS.CONTENT_INNER),this.PARTS.CONTENT_INNER.style.overflow="auto"):BX.CDebugDialog.superclass.SetContent.apply(this,arguments)}},BX.CDebugDialog.prototype.__adjustSize=function(){if(BX.CDebugDialog.superclass.__adjustSize.apply(this,arguments),this.PARTS.CONTENT_TOP){var t=this.PARTS.CONTENT_DATA.offsetHeight-this.PARTS.HEAD.offsetHeight-this.PARTS.CONTENT_TOP.offsetHeight-38;t>0&&(this.PARTS.CONTENT_INNER.style.height=t+"px")}},BX.CEditorDialog=function(){BX.CEditorDialog.superclass.constructor.apply(this,arguments),BX.removeClass(this.PARTS.CONTENT,"bx-core-adm-dialog-content-wrap"),BX.removeClass(this.PARTS.CONTENT_DATA,"bx-core-adm-dialog-content"),BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner"),BX.removeClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-adm-dialog-buttons"),BX.addClass(this.PARTS.CONTENT,"bx-core-editor-dialog-content-wrap"),BX.addClass(this.PARTS.CONTENT_DATA,"bx-core-editor-dialog-content"),BX.addClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-editor-dialog-buttons")},BX.extend(BX.CEditorDialog,BX.CDialog),BX.CEditorDialog.prototype.SetContent=function(){BX.CEditorDialog.superclass.SetContent.apply(this,arguments),BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner")},BX.CWizardDialog=function(){BX.CWizardDialog.superclass.constructor.apply(this,arguments),BX.removeClass(this.PARTS.CONTENT,"bx-core-adm-dialog-content-wrap"),BX.removeClass(this.PARTS.CONTENT_DATA,"bx-core-adm-dialog-content"),BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner"),BX.removeClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-adm-dialog-buttons"),BX.addClass(this.PARTS.CONTENT,"bx-core-wizard-dialog-content-wrap")},BX.extend(BX.CWizardDialog,BX.CDialog),BX.CAuthDialog=function(t){t.resizable=!1,t.width=350,t.height=200,t.buttons=[this.btnSave],BX.CAuthDialog.superclass.constructor.apply(this,arguments),this._sender="core_window_cauthdialog",BX.addClass(this.DIV,"bx-core-auth-dialog"),BX.AUTHAGENT=this},BX.extend(BX.CAuthDialog,BX.CDialog),BX.CAuthDialog.prototype.btnSave=BX.CAuthDialog.btnSave={title:BX.message("JS_CORE_WINDOW_AUTH"),id:"savebtn",name:"savebtn",className:"adm-btn-save",action:function(){this.disableUntilError(),this.parentWindow.Submit("",this.parentWindow.PARAMS.content_url)}},BX.CAuthDialog.prototype.SetError=function(t){BX.closeWait(),t&&this.ShowError(t.MESSAGE||t)},BX.CAuthDialog.prototype.setAuthResult=function(t){BX.closeWait(),t===!1?(this.Close(),this.PARAMS.callback&&this.PARAMS.callback()):this.SetError(t)},BX.CWindowFloat=function(t){BX.CWindowFloat.superclass.constructor.apply(this,[t,"float"]),this.SETTINGS.resizable=!1},BX.extend(BX.CWindowFloat,BX.CWindow),BX.CWindowFloat.prototype.adjustPos=function(){this.PARAMS.parent?this.adjustToNode():this.PARAMS.x&&this.PARAMS.y&&this.adjustToPos([this.PARAMS.x,this.PARAMS.y])},BX.CWindowFloat.prototype.adjustToPos=function(t){this.DIV.style.left=parseInt(t[0])+"px",this.DIV.style.top=parseInt(t[1])+"px"},BX.CWindowFloat.prototype.adjustToNodeGetPos=function(){return BX.pos(this.PARAMS.parent)},BX.CWindowFloat.prototype.adjustToNode=function(t){if(t=t||this.PARAMS.parent,this.PARAMS.parent=BX(t),this.PARAMS.parent){var e=this.adjustToNodeGetPos();this.DIV.style.top=e.top+"px",this.DIV.style.left=e.left+"px",this.PARAMS.parent.OPENER=this}},BX.CWindowFloat.prototype.Show=function(){this.adjustToPos([-1e3,-1e3]),BX.CWindowFloat.superclass.Show.apply(this,arguments),this.adjustPos()},BX.COpener=function(t){this.PARAMS=t||{},this.MENU=t.MENU||[],this.DIV=t.DIV,this.ATTACH=t.ATTACH||t.DIV,this.ATTACH_MODE=t.ATTACH_MODE||"bottom",this.ACTIVE_CLASS=t.ACTIVE_CLASS||"",this.LEVEL=t.LEVEL||0,this.CLOSE_ON_CLICK="undefined"!=typeof t.CLOSE_ON_CLICK?!!t.CLOSE_ON_CLICK:!0,this.ADJUST_ON_CLICK="undefined"!=typeof t.ADJUST_ON_CLICK?!!t.ADJUST_ON_CLICK:!0,this.TYPE="hover"==this.PARAMS.TYPE?"hover":"click",this._openTimeout=null,"hover"==this.PARAMS.TYPE&&0!==t.TIMEOUT?this.TIMEOUT=t.TIMEOUT||1e3:this.TIMEOUT=0,this.PARAMS.MENU_URL&&(this.bMenuLoaded=!1,this.bMenuLoading=!1,this.MENU=[{TEXT:BX.message("JS_CORE_LOADING"),CLOSE_ON_CLICK:!1}],this.PARAMS.MENU_PRELOAD&&BX.defer(this.Load,this)()),BX.ready(BX.defer(this.Init,this))},BX.COpener.prototype.Init=function(){switch(this.DIV=BX(this.DIV),this.TYPE){case"hover":BX.bind(this.DIV,"mouseover",BX.proxy(this.Open,this)),BX.bind(this.DIV,"click",BX.proxy(this.Toggle,this));break;case"click":BX.bind(this.DIV,"click",BX.proxy(this.Toggle,this))}this.bMenuInit=!1},BX.COpener.prototype.Load=function(){if(this.PARAMS.MENU_URL&&!this.bMenuLoaded&&!this.bMenuLoading){var t=this.PARAMS.MENU_URL;t.indexOf("sessid=")<=0&&(t+=(t.indexOf("?")>0?"&":"?")+"sessid="+BX.bitrix_sessid()),this.bMenuLoading=!0,BX.ajax.loadJSON(t,BX.proxy(this.SetMenu,this),BX.proxy(this.LoadFailed,this))}},BX.COpener.prototype.SetMenu=function(t){this.bMenuLoaded=!0,this.bMenuLoading=!1,this.bMenuInit?this.MENU.setItems(t):this.MENU=t},BX.COpener.prototype.LoadFailed=function(){this.bMenuLoading=!1,this.SetMenu([{TEXT:BX.message("JS_CORE_NO_DATA"),CLOSE_ON_CLICK:!0}]),BX.debug(arguments)},BX.COpener.prototype.checkAdminMenu=function(){return"bx-admin-prefix"==document.documentElement.id?!0:!!BX.findParent(this.DIV,{property:{id:"bx-admin-prefix"}})},BX.COpener.prototype.Toggle=function(t){if(this.__clear_timeout(),this.bMenuInit&&this.MENU.visible())this.MENU.Close();else{var e=this.TIMEOUT;this.TIMEOUT=0,this.Open(t),this.TIMEOUT=e}return!(!t&&!window.event)&&BX.PreventDefault(t)},BX.COpener.prototype.GetMenu=function(){return this.bMenuInit||(BX.type.isArray(this.MENU)&&(this.MENU=new BX.CMenu({ITEMS:this.MENU,ATTACH_MODE:this.ATTACH_MODE,SET_ID:this.checkAdminMenu()?"bx-admin-prefix":"",CLOSE_ON_CLICK:!!this.CLOSE_ON_CLICK,ADJUST_ON_CLICK:!!this.ADJUST_ON_CLICK,LEVEL:this.LEVEL,parent:BX(this.DIV),parent_attach:BX(this.ATTACH)}),this.LEVEL>0&&(BX.bind(this.MENU.DIV,"mouseover",BX.proxy(this._on_menu_hover,this)),BX.bind(this.MENU.DIV,"mouseout",BX.proxy(this._on_menu_hout,this)))),BX.addCustomEvent(this.MENU,"onMenuOpen",BX.proxy(this.handler_onopen,this)),BX.addCustomEvent(this.MENU,"onMenuClose",BX.proxy(this.handler_onclose,this)),BX.addCustomEvent("onMenuItemHover",BX.proxy(this.handler_onover,this)),this.bMenuInit=!0),this.MENU},BX.COpener.prototype.Open=function(){return this.GetMenu(),this.bOpen=!0,this.__clear_timeout(),this.TIMEOUT>0?(BX.bind(this.DIV,"mouseout",BX.proxy(this.__clear_timeout,this)),this._openTimeout=setTimeout(BX.proxy(this.__open,this),this.TIMEOUT)):this.__open(),this.PARAMS.MENU_URL&&!this.bMenuLoaded&&(this._loadTimeout=setTimeout(BX.proxy(this.Load,this),parseInt(this.TIMEOUT/2))),!0},BX.COpener.prototype.__clear_timeout=function(){this._openTimeout&&clearTimeout(this._openTimeout),this._loadTimeout&&clearTimeout(this._loadTimeout),BX.unbind(this.DIV,"mouseout",BX.proxy(this.__clear_timeout,this))},BX.COpener.prototype._on_menu_hover=function(){this.bMenuHover=!0,this.__clear_timeout(),this.ACTIVE_CLASS&&BX.addClass(this.DIV,this.ACTIVE_CLASS)},BX.COpener.prototype._on_menu_hout=function(){this.bMenuHover=!1},BX.COpener.prototype.handler_onover=function(t,e){this.bMenuHover||(e!=this&&t==this.LEVEL-1&&this.ACTIVE_CLASS&&BX.removeClass(this.DIV,this.ACTIVE_CLASS),this.bMenuInit&&t<=this.LEVEL-1&&this.MENU.visible()&&e!=this&&(this.__clear_timeout(),this._openTimeout=setTimeout(BX.proxy(this.Close,this),this.TIMEOUT)))},BX.COpener.prototype.handler_onopen=function(){this.bOpen=!0,this.ACTIVE_CLASS&&BX.addClass(this.DIV,this.ACTIVE_CLASS),BX.defer(function(){BX.onCustomEvent(this,"onOpenerMenuOpen")},this)()},BX.COpener.prototype.handler_onclose=function(){this.bOpen=!1,BX.onCustomEvent(this,"onOpenerMenuClose"),this.ACTIVE_CLASS&&BX.removeClass(this.DIV,this.ACTIVE_CLASS)},BX.COpener.prototype.Close=function(){this.bMenuInit&&(this._openTimeout&&clearTimeout(this._openTimeout),this.bOpen=!1,this.__close())},BX.COpener.prototype.__open=function(){this.__clear_timeout(),this.bMenuInit&&this.bOpen&&!this.MENU.visible()&&this.MENU.Show()},BX.COpener.prototype.__close=function(){this.bMenuInit&&!this.bOpen&&this.MENU.visible()&&this.MENU.Hide()},BX.COpener.prototype.__close_immediately=function(){this.bOpen=!1,this.__close()},BX.COpener.prototype.isMenuVisible=function(){return null!=this.MENU.visible&&this.MENU.visible()},BX.CMenu=function(t){BX.CMenu.superclass.constructor.apply(this),this.DIV.style.width="auto",this.DIV.style.height="auto",this.PARAMS=t||{},this.PARTS={},this.PARAMS.ATTACH_MODE=this.PARAMS.ATTACH_MODE||"bottom",this.PARAMS.CLOSE_ON_CLICK="undefined"==typeof this.PARAMS.CLOSE_ON_CLICK?!0:this.PARAMS.CLOSE_ON_CLICK,this.PARAMS.ADJUST_ON_CLICK="undefined"==typeof this.PARAMS.ADJUST_ON_CLICK?!0:this.PARAMS.ADJUST_ON_CLICK,this.PARAMS.LEVEL=this.PARAMS.LEVEL||0,this.DIV.className="bx-core-popup-menu bx-core-popup-menu-"+this.PARAMS.ATTACH_MODE+" bx-core-popup-menu-level"+this.PARAMS.LEVEL+("undefined"!=typeof this.PARAMS.ADDITIONAL_CLASS?" "+this.PARAMS.ADDITIONAL_CLASS:""),this.PARAMS.SET_ID&&(this.DIV.id=this.PARAMS.SET_ID),0==this.PARAMS.LEVEL&&(this.ARROW=this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-core-popup-menu-angle"},style:{left:"15px"}}))),this.PARAMS.CLASS_NAME&&(this.DIV.className+=" "+this.PARAMS.CLASS_NAME),BX.bind(this.DIV,"click",BX.eventCancelBubble),this.ITEMS=[],this.setItems(this.PARAMS.ITEMS),BX.addCustomEvent("onMenuOpen",BX.proxy(this._onMenuOpen,this)),BX.addCustomEvent("onMenuItemSelected",BX.proxy(this.Hide,this))},BX.extend(BX.CMenu,BX.CWindowFloat),BX.CMenu.broadcastCloseEvent=function(){BX.onCustomEvent("onMenuItemSelected")},BX.CMenu._toggleChecked=function(){BX.toggleClass(this,"bx-core-popup-menu-item-checked")},BX.CMenu._itemDblClick=function(){window.location.href=this.href},BX.CMenu.prototype.toggleArrow=function(t){this.ARROW&&("undefined"==typeof t&&(t="hidden"==this.ARROW.style.visibility),this.ARROW.style.visibility=t?"visible":"hidden")},BX.CMenu.prototype.visible=function(){return"none"!==this.DIV.style.display},BX.CMenu.prototype._onMenuOpen=function(t,e){this.visible()&&e==this.PARAMS.LEVEL&&t!=this&&this.Hide()},BX.CMenu.prototype.onUnRegister=function(){this.visible()&&this.Hide()},BX.CMenu.prototype.setItems=function(t){if(this.PARAMS.ITEMS=t,BX.cleanNode(this.DIV),this.ARROW&&this.DIV.appendChild(this.ARROW),this.PARAMS.ITEMS){this.PARAMS.ITEMS=BX.util.array_values(this.PARAMS.ITEMS);for(var e=!1,i=0,o=0,n=this.PARAMS.ITEMS.length;n>o;o++)(0!=o&&o!=n-1||!this.PARAMS.ITEMS[o].SEPARATOR)&&(i++,e||(e=!!this.PARAMS.ITEMS[o].GLOBAL_ICON),this.addItem(this.PARAMS.ITEMS[o],o));1===i?BX.addClass(this.DIV,"bx-core-popup-menu-single-item"):BX.removeClass(this.DIV,"bx-core-popup-menu-single-item"),e?BX.removeClass(this.DIV,"bx-core-popup-menu-no-icons"):BX.addClass(this.DIV,"bx-core-popup-menu-no-icons")}},BX.CMenu.prototype.addItem=function(t){if(this.ITEMS.push(t),t.SEPARATOR)t.NODE=BX.create("DIV",{props:{className:"bx-core-popup-menu-separator"}});else{var e=!!t.MENU&&(BX.type.isArray(t.MENU)&&t.MENU.length>0||t.MENU instanceof BX.CMenu)||!!t.MENU_URL;t.DISABLED&&(t.CLOSE_ON_CLICK=!1,t.LINK=null,t.ONCLICK=null,t.ACTION=null),t.NODE=BX.create(t.LINK||BX.browser.IsIE()&&!BX.browser.IsDoctype()?"A":"SPAN",{props:{className:"bx-core-popup-menu-item"+(e?" bx-core-popup-menu-item-opener":"")+(t.DEFAULT?" bx-core-popup-menu-item-default":"")+(t.DISABLED?" bx-core-popup-menu-item-disabled":"")+(t.CHECKED?" bx-core-popup-menu-item-checked":""),title:BX.message.MENU_ENABLE_TOOLTIP||t.SHOW_TITLE?t.TITLE||"":"",BXMENULEVEL:this.PARAMS.LEVEL},attrs:t.LINK||BX.browser.IsIE()&&!BX.browser.IsDoctype()?{href:t.LINK||"javascript:void(0)"}:{},events:{mouseover:function(){BX.onCustomEvent("onMenuItemHover",[this.BXMENULEVEL,this.OPENER])}},html:'<span class="bx-core-popup-menu-item-icon'+(t.GLOBAL_ICON?" "+t.GLOBAL_ICON:"")+'"></span><span class="bx-core-popup-menu-item-text">'+t.TEXT+"</span>"}),e&&!t.DISABLED?t.NODE.OPENER=new BX.COpener({DIV:t.NODE,ACTIVE_CLASS:"bx-core-popup-menu-item-opened",TYPE:"hover",MENU:t.MENU,MENU_URL:t.MENU_URL,MENU_PRELOAD:!!t.MENU_PRELOAD,LEVEL:this.PARAMS.LEVEL+1,ATTACH_MODE:"right",TIMEOUT:500}):this.PARAMS.CLOSE_ON_CLICK&&("undefined"==typeof t.CLOSE_ON_CLICK||t.CLOSE_ON_CLICK)?BX.bind(t.NODE,"click",BX.CMenu.broadcastCloseEvent):this.PARAMS.ADJUST_ON_CLICK&&("undefined"==typeof t.ADJUST_ON_CLICK||t.ADJUST_ON_CLICK)&&BX.bind(t.NODE,"click",BX.defer(this.adjustPos,this)),e&&t.LINK&&BX.bind(t.NODE,"dblclick",BX.CMenu._itemDblClick),"undefined"!=typeof t.CHECKED&&BX.bind(t.NODE,"click",BX.CMenu._toggleChecked),t.ONCLICK=t.ACTION||t.ONCLICK,t.ONCLICK&&(BX.type.isString(t.ONCLICK)&&(t.ONCLICK=new Function("event",t.ONCLICK)),BX.bind(t.NODE,"click",t.ONCLICK))}this.DIV.appendChild(t.NODE)},BX.CMenu.prototype._documentClickBind=function(){this._documentClickUnBind(),BX.bind(document,"click",BX.proxy(this._documentClick,this))},BX.CMenu.prototype._documentClickUnBind=function(){BX.unbind(document,"click",BX.proxy(this._documentClick,this))},BX.CMenu.prototype._documentClick=function(t){t=t||window.event,(!t||BX.getEventButton(t)&BX.MSLEFT)&&this.Close()},BX.CMenu.prototype.Show=function(){BX.onCustomEvent(this,"onMenuOpen",[this,this.PARAMS.LEVEL]),BX.CMenu.superclass.Show.apply(this,[]),this.bCloseEventFired=!1,BX.addCustomEvent(this.PARAMS.parent_attach,"onChangeNodePosition",BX.proxy(this.adjustToNode,this)),BX.defer(this._documentClickBind,this)()},BX.CMenu.prototype.Close=BX.CMenu.prototype.Hide=function(){this.visible()&&(BX.removeCustomEvent(this.PARAMS.parent_attach,"onChangeNodePosition",BX.proxy(this.adjustToNode,this)),this._documentClickUnBind(),this.bCloseEventFired||(BX.onCustomEvent(this,"onMenuClose",[this,this.PARAMS.LEVEL]),this.bCloseEventFired=!0),BX.CMenu.superclass.Hide.apply(this,arguments))},BX.CMenu.prototype.__adjustMenuToNode=function(){var t=BX.pos(this.PARAMS.parent_attach),e=!!BX.findParent(this.PARAMS.parent_attach,BX.is_fixed);if(e?this.DIV.style.position="fixed":this.DIV.style.position="absolute",t.top||(this.DIV.style.top="-1000px",this.DIV.style.left="-1000px"),!this.bTimeoutSet){var i=this.DIV.offsetWidth,o=this.DIV.offsetHeight;if(!i)return setTimeout(BX.delegate(function(){this.bTimeoutSet=!1,this.__adjustMenuToNode()},this),100),void(this.bTimeoutSet=!0);var n={},s=BX.GetWindowSize();switch(this.PARAMS.ATTACH_MODE){case"bottom":n.top=t.bottom+9,n.left=t.left;var r=0;if(this.ARROW&&(r=t.width>i?parseInt(i/2-7):parseInt(Math.min(i,t.width)/2-7),7>r&&(n.left-=15,r+=15)),n.left>s.scrollWidth-i-10){var a=n.left;n.left=s.scrollWidth-i-10,this.ARROW&&(r+=a-n.left)}e&&(n.left-=s.scrollLeft),this.ARROW&&(this.ARROW.style.left=r+"px");break;case"right":n.top=t.top-1,n.left=t.right,n.left>s.scrollWidth-i-10&&(n.left=t.left-i-1)}if(e&&(n.top-=s.scrollTop),this.ARROW&&(this.ARROW.className="bx-core-popup-menu-angle"),n.top+o>s.scrollTop+s.innerHeight||n.top+o>s.scrollHeight){var l="bottom"==this.PARAMS.ATTACH_MODE?t.top-o-9:t.bottom-o+1;(l>s.scrollTop||n.top+o>s.scrollHeight)&&(n.top+o>s.scrollHeight?(n.top=Math.max(0,s.scrollHeight-o),this.toggleArrow(!1)):(n.top=l,this.ARROW&&(this.ARROW.className="bx-core-popup-menu-angle-bottom")))}n.top+n.left==0?this.Hide():(this.DIV.style.top=n.top+"px",this.DIV.style.left=n.left+"px")}},BX.CMenu.prototype.adjustToNode=function(t){this.PARAMS.parent_attach=BX(t)||this.PARAMS.parent_attach||this.PARAMS.parent,this.__adjustMenuToNode()},BX.CMenuOpener=function(t){BX.CMenuOpener.superclass.constructor.apply(this),this.PARAMS=t||{},this.setParent(this.PARAMS.parent),this.PARTS={},this.SETTINGS.drag_restrict=!0,this.defaultAction=null,this.timeout=500,this.DIV.className="bx-component-opener",this.DIV.ondblclick=BX.PreventDefault,this.PARAMS.component_id&&(this.PARAMS.transform=!!this.PARAMS.transform),this.OPENERS=[],this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar"+(this.PARAMS.transform?" bx-context-toolbar-vertical-mode":"")}})),this.PARTS.INNER=this.DIV.firstChild.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-inner"},html:'<span class="bx-context-toolbar-drag-icon"></span><span class="bx-context-toolbar-vertical-line"></span><br>'})),this.EXTRA_BUTTONS={};for(var e=0,i=0,o=this.PARAMS.menu.length;o>i;i++){var n=this.addItem(this.PARAMS.menu[i]);null!=n&&(e++,this.PARTS.INNER.appendChild(n),this.PARTS.INNER.appendChild(BX.create("BR")))}var s=e>0;if(this.PARTS.ICONS=this.PARTS.INNER.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-icons"}})),this.PARAMS.component_id&&(this.PARAMS.pin=!!this.PARAMS.pin,s&&this.PARTS.ICONS.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-separator"}})),this.PARTS.ICON_PIN=this.PARTS.ICONS.appendChild(BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:this.PARAMS.pin?"bx-context-toolbar-pin-fixed":"bx-context-toolbar-pin"},events:{click:BX.delegate(this.__pin_btn_clicked,this)}}))),this.EXTRA_BUTTONS.components2_props){var r=this.EXTRA_BUTTONS.components2_props||{URL:"javascript:void(0)"};null==this.defaultAction&&(this.defaultAction=r.ONCLICK,this.defaultActionTitle=r.TITLE||r.TEXT),r.URL="javascript:"+BX.util.urlencode(r.ONCLICK),this.ATTACH=this.PARTS.ICONS.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button bx-context-toolbar-button-settings"},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-inner"},children:[BX.create("A",{attrs:{href:r.URL},events:{mouseover:BX.proxy(this.__msover_text,this),mouseout:BX.proxy(this.__msout_text,this),mousedown:BX.proxy(this.__msdown_text,this)},html:'<span class="bx-context-toolbar-button-icon bx-context-toolbar-settings-icon"></span>'}),BX.create("A",{attrs:{href:"javascript: void(0)"},props:{className:"bx-context-toolbar-button-arrow"},events:{mouseover:BX.proxy(this.__msover_arrow,this),mouseout:BX.proxy(this.__msout_arrow,this),mousedown:BX.proxy(this.__msdown_arrow,this)},html:'<span class="bx-context-toolbar-button-arrow"></span>'})]})]})),this.OPENER=this.ATTACH.firstChild.lastChild;var a=this.attachMenu(this.EXTRA_BUTTONS.components2_submenu.MENU);BX.addCustomEvent(a,"onOpenerMenuOpen",BX.proxy(this.__menu_open,this)),BX.addCustomEvent(a,"onOpenerMenuClose",BX.proxy(this.__menu_close,this))}if(e>1&&(this.PARTS.ICONS.appendChild(BX.create("span",{props:{className:"bx-context-toolbar-separator bx-context-toolbar-separator-switcher"}})),this.ICON_TRANSFORM=this.PARTS.ICONS.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},props:{className:"bx-context-toolbar-switcher"},events:{click:BX.delegate(this.__trf_btn_clicked,this)}}))),this.PARAMS.HINT&&(this.DIV.BXHINT=this.HINT=new BX.CHint({parent:this.DIV,hint:this.PARAMS.HINT.TEXT||"",title:this.PARAMS.HINT.TITLE||"",hide_timeout:this.timeout/2,preventHide:!1})),BX.addCustomEvent(this,"onWindowDragFinished",BX.delegate(this.__onMoveFinished,this)),BX.addCustomEvent("onDynamicModeChange",BX.delegate(this.__onDynamicModeChange,this)),BX.addCustomEvent("onTopPanelCollapse",BX.delegate(this.__onPanelCollapse,this)),BX.addCustomEvent("onMenuOpenerMoved",BX.delegate(this.checkPosition,this)),BX.addCustomEvent("onMenuOpenerUnhide",BX.delegate(this.checkPosition,this)),this.OPENERS)for(i=0,o=this.OPENERS.length;o>i;i++)BX.addCustomEvent(this.OPENERS[i],"onOpenerMenuOpen",BX.proxy(this.__hide_hint,this))},BX.extend(BX.CMenuOpener,BX.CWindowFloat),BX.CMenuOpener.prototype.setParent=function(t){t=BX(t),t.OPENER&&t.OPENER!=this&&(t.OPENER.Close(),t.OPENER.clearHoverHoutEvents()),this.PARAMS.parent&&this.PARAMS.parent!=t&&(this.clearHoverHoutEvents(),this.PARAMS.parent.OPENER=null),this.PARAMS.parent=t,this.PARAMS.parent.OPENER=this},BX.CMenuOpener.prototype.setHoverHoutEvents=function(t,e){this.__opener_events_set||(BX.bind(this.Get(),"mouseover",t),BX.bind(this.Get(),"mouseout",e),this.__opener_events_set=!0)},BX.CMenuOpener.prototype.clearHoverHoutEvents=function(){this.Get()&&(BX.unbindAll(this.Get()),this.__opener_events_set=!1)},BX.CMenuOpener.prototype.unclosable=!0,BX.CMenuOpener.prototype.__check_intersection=function(t,e){return!(e.right<=t.left||e.left>=t.right||e.bottom<=t.top||e.top>=t.bottom)},BX.CMenuOpener.prototype.__msover_text=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.ATTACH,"bx-context-toolbar-button-text-hover")},BX.CMenuOpener.prototype.__msout_text=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.ATTACH,"bx-context-toolbar-button-text-hover bx-context-toolbar-button-text-active")},BX.CMenuOpener.prototype.__msover_arrow=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.ATTACH,"bx-context-toolbar-button-arrow-hover")},BX.CMenuOpener.prototype.__msout_arrow=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.ATTACH,"bx-context-toolbar-button-arrow-hover bx-context-toolbar-button-arrow-active")},BX.CMenuOpener.prototype.__msdown_text=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.ATTACH,"bx-context-toolbar-button-text-active")},BX.CMenuOpener.prototype.__msdown_arrow=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.ATTACH,"bx-context-toolbar-button-arrow-active")},BX.CMenuOpener.prototype.__menu_close=function(){this._menu_open=!1,this.bx_active=!1,BX.removeClass(this.ATTACH,"bx-context-toolbar-button-active bx-context-toolbar-button-text-active bx-context-toolbar-button-arrow-active"),this.bx_hover||(BX.removeClass(this.ATTACH,"bx-context-toolbar-button-hover bx-context-toolbar-button-text-hover bx-context-toolbar-button-arrow-hover"),this.bx_hover=!1)},BX.CMenuOpener.prototype.__menu_open=function(){this._menu_open=!0},BX.CMenuOpener.prototype.checkPosition=function(){this.isMenuVisible()||"none"==this.DIV.style.display||this==BX.proxy_context||BX.proxy_context.zIndex>this.zIndex||this.correctPosition(BX.proxy_context)},BX.CMenuOpener.prototype.correctPosition=function(t){var e=BX.pos(this.DIV),i=BX.pos(t.Get());if(this.__check_intersection(e,i)){var o=i.top-e.height;0>o&&(o=i.bottom),this.DIV.style.top=o+"px",BX.addCustomEvent(t,"onMenuOpenerHide",BX.proxy(this.restorePosition,this)),BX.onCustomEvent(this,"onMenuOpenerMoved")}},BX.CMenuOpener.prototype.restorePosition=function(){this.MOUSEOVER||this.isMenuVisible()?this.restore_pos_timeout=setTimeout(BX.proxy(this.restorePosition,this),this.timeout):(this.originalPos&&(this.DIV.style.top=this.originalPos.top+"px"),BX.removeCustomEvent(BX.proxy_context,"onMenuOpenerHide",BX.proxy(this.restorePosition,this)),this.restore_pos_timeout&&clearTimeout(this.restore_pos_timeout))},BX.CMenuOpener.prototype.Show=function(){BX.CMenuOpener.superclass.Show.apply(this,arguments),this.SetDraggable(this.PARTS.INNER.firstChild),this.DIV.style.width="auto",this.DIV.style.height="auto",this.PARAMS.pin?(this.bPosAdjusted=!0,this.bMoved=!0,this.PARAMS.top&&(this.DIV.style.top=this.PARAMS.top+"px"),this.PARAMS.left&&(this.DIV.style.left=this.PARAMS.left+"px"),this.DIV.style.display=!BX.admin.dynamic_mode||BX.admin.dynamic_mode_show_borders?"block":"none","block"==this.DIV.style.display&&setTimeout(BX.delegate(function(){BX.onCustomEvent(this,"onMenuOpenerUnhide")},this),50)):(this.DIV.style.left="-1000px",this.DIV.style.top="-1000px",this.Hide())},BX.CMenuOpener.prototype.executeDefaultAction=function(){this.defaultAction&&(BX.type.isFunction(this.defaultAction)?this.defaultAction():BX.type.isString(this.defaultAction)&&BX.evalGlobal(this.defaultAction))},BX.CMenuOpener.prototype.__onDynamicModeChange=function(t){this.DIV.style.display=t?"block":"none"},BX.CMenuOpener.prototype.__onPanelCollapse=function(t,e){this.DIV.style.top=parseInt(this.DIV.style.top)+e+"px",this.PARAMS.pin&&this.__savePosition()},BX.CMenuOpener.prototype.__onMoveFinished=function(){BX.onCustomEvent(this,"onMenuOpenerMoved"),this.bMoved=!0,this.PARAMS.pin&&this.__savePosition()},BX.CMenuOpener.prototype.__savePosition=function(){var t={};t.pin=this.PARAMS.pin,this.PARAMS.pin?(t.transform=this.PARAMS.transform,this.bMoved&&(t.left=parseInt(this.DIV.style.left),t.top=parseInt(this.DIV.style.top))):(t.top=!1,t.left=!1,t.transform=!1),BX.WindowManager.saveWindowOptions(this.PARAMS.component_id,t)},BX.CMenuOpener.prototype.__pin_btn_clicked=function(){this.Pin()},BX.CMenuOpener.prototype.Pin=function(t){null==t?this.PARAMS.pin=!this.PARAMS.pin:this.PARAMS.pin=!!t,this.PARTS.ICON_PIN.className=this.PARAMS.pin?"bx-context-toolbar-pin-fixed":"bx-context-toolbar-pin",this.__savePosition()},BX.CMenuOpener.prototype.__trf_btn_clicked=function(){this.Transform()},BX.CMenuOpener.prototype.Transform=function(t){var e={};null==t?this.PARAMS.transform=!this.PARAMS.transform:this.PARAMS.transform=!!t,this.bMoved&&(e=BX.pos(this.DIV)),this.PARAMS.transform?BX.addClass(this.DIV.firstChild,"bx-context-toolbar-vertical-mode"):BX.removeClass(this.DIV.firstChild,"bx-context-toolbar-vertical-mode"),this.bMoved?this.DIV.style.left=e.right-this.DIV.offsetWidth-(BX.browser.IsIE()&&!BX.browser.IsDoctype()?2:0)+"px":this.adjustPos(),this.__savePosition()},BX.CMenuOpener.prototype.adjustToNodeGetPos=function(){var t=BX.pos(this.PARAMS.parent),e=BX.GetWindowScrollSize(),i=this.DIV.offsetWidth;return t.left-=BX.admin.__border_dx,t.top-=BX.admin.__border_dx,t.top-=45,t.left>e.scrollWidth-i&&(t.left=e.scrollWidth-i),t},BX.CMenuOpener.prototype.addItem=function(t){if(t.TYPE)return this.EXTRA_BUTTONS[t.TYPE]=t,null;var e=new BX.CMenuOpenerItem(t);return null==this.defaultAction&&(e.item.ONCLICK?this.defaultAction=t.ONCLICK:e.item.MENU&&(this.defaultAction=BX.delegate(function(){this.Open()},e.item.OPENER)),this.defaultActionTitle=t.TITLE||t.TEXT,BX.addClass(e.Get(),"bx-content-toolbar-default")),e.item.OPENER&&(this.OPENERS[this.OPENERS.length]=e.item.OPENER),e.Get()},BX.CMenuOpener.prototype.attachMenu=function(t){var e=new BX.COpener({DIV:this.OPENER,ATTACH:this.ATTACH,MENU:t,TYPE:"click"});return this.OPENERS[this.OPENERS.length]=e,e},BX.CMenuOpener.prototype.__hide_hint=function(){this.HINT&&this.HINT.__hide_immediately()},BX.CMenuOpener.prototype.isMenuVisible=function(){for(var t=0,e=this.OPENERS.length;e>t;t++)if(this.OPENERS[t].isMenuVisible())return!0;
return!1},BX.CMenuOpener.prototype.Hide=function(){this.PARAMS.pin||(this.DIV.style.display="none",BX.onCustomEvent(this,"onMenuOpenerHide"))},BX.CMenuOpener.prototype.UnHide=function(){this.DIV.style.display="block",this.bPosAdjusted||this.PARAMS.pin||(this.adjustPos(),this.bPosAdjusted=!0),null!=this.originalPos||this.bMoved||(this.originalPos=BX.pos(this.DIV)),BX.onCustomEvent(this,"onMenuOpenerUnhide")},BX.CMenuOpenerItem=function(t){this.item=t,this.item.ACTION&&!this.item.ONCLICK&&(this.item.ONCLICK=this.item.ACTION),this.DIV=BX.create("SPAN"),this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button-underlay"}})),this.WRAPPER=this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button-wrapper"},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button",title:t.TITLE},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-inner"}})]})]}));var e=BX.create("SPAN",{props:{className:"bx-context-toolbar-button-icon"+(this.item.ICON||this.item.ICONCLASS?" "+(this.item.ICON||this.item.ICONCLASS):"")},attrs:this.item.ICON||this.item.ICONCLASS||!this.item.SRC&&!this.item.IMAGE?{}:{style:"background: scroll transparent url("+(this.item.SRC||this.item.IMAGE)+") no-repeat center center !important;"}}),i=BX.create("SPAN",{props:{className:"bx-context-toolbar-button-text"},text:this.item.TEXT});this.item.ACTION&&!this.item.ONCLICK&&(this.item.ONCLICK=this.item.ACTION),this.bHasMenu=!!this.item.MENU,this.bHasAction=!!this.item.ONCLICK,this.bHasAction?(this.LINK=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},events:{mouseover:this.bHasMenu?BX.proxy(this.__msover_text,this):BX.proxy(this.__msover,this),mouseout:this.bHasMenu?BX.proxy(this.__msout_text,this):BX.proxy(this.__msout,this),mousedown:this.bHasMenu?BX.proxy(this.__msdown_text,this):BX.proxy(this.__msdown,this)},children:[e,i]})),this.bHasMenu&&(this.LINK_MENU=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{props:{className:"bx-context-toolbar-button-arrow"},attrs:{href:"javascript: void(0)"},events:{mouseover:BX.proxy(this.__msover_arrow,this),mouseout:BX.proxy(this.__msout_arrow,this),mousedown:BX.proxy(this.__msdown_arrow,this)},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-arrow"}})]})))):this.bHasMenu&&(this.item.ONCLICK=null,this.LINK=this.LINK_MENU=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},events:{mouseover:BX.proxy(this.__msover,this),mouseout:BX.proxy(this.__msout,this),mousedown:BX.proxy(this.__msdown,this)},children:[e,i]})),this.LINK.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-single-button-arrow"}}))),this.bHasMenu&&(this.item.SUBMENU=new BX.CMenu({ATTACH_MODE:"bottom",ITEMS:this.item.MENU,parent:this.LINK_MENU,parent_attach:this.WRAPPER.firstChild}),this.item.OPENER=new BX.COpener({DIV:this.LINK_MENU,TYPE:"click",MENU:this.item.SUBMENU}),BX.addCustomEvent(this.item.OPENER,"onOpenerMenuOpen",BX.proxy(this.__menu_open,this)),BX.addCustomEvent(this.item.OPENER,"onOpenerMenuClose",BX.proxy(this.__menu_close,this))),this.bHasAction&&BX.bind(this.LINK,"click",BX.delegate(this.__click,this))},BX.CMenuOpenerItem.prototype.Get=function(){return this.DIV},BX.CMenuOpenerItem.prototype.__msover=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover")},BX.CMenuOpenerItem.prototype.__msout=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover bx-context-toolbar-button-active")},BX.CMenuOpenerItem.prototype.__msover_text=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-hover")},BX.CMenuOpenerItem.prototype.__msout_text=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-hover bx-context-toolbar-button-text-active")},BX.CMenuOpenerItem.prototype.__msover_arrow=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-hover")},BX.CMenuOpenerItem.prototype.__msout_arrow=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-hover bx-context-toolbar-button-arrow-active")},BX.CMenuOpenerItem.prototype.__msdown=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-active")},BX.CMenuOpenerItem.prototype.__msdown_text=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-active")},BX.CMenuOpenerItem.prototype.__msdown_arrow=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-active")},BX.CMenuOpenerItem.prototype.__menu_close=function(){this._menu_open=!1,this.bx_active=!1,BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-active bx-context-toolbar-button-text-active bx-context-toolbar-button-arrow-active"),this.bx_hover||(BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover bx-context-toolbar-button-text-hover bx-context-toolbar-button-arrow-hover"),this.bx_hover=!1)},BX.CMenuOpenerItem.prototype.__menu_open=function(){this._menu_open=!0},BX.CMenuOpenerItem.prototype.__click=function(){BX.evalGlobal(this.item.ONCLICK)},BX.CPageOpener=function(){BX.CPageOpener.superclass.constructor.apply(this,arguments),this.timeout=505,window.PAGE_EDIT_CONTROL=this},BX.extend(BX.CPageOpener,BX.CMenuOpener),BX.CPageOpener.prototype.checkPosition=function(){this!=BX.proxy_context&&this.correctPosition(BX.proxy_context)},BX.CPageOpener.prototype.correctPosition=function(t){if(!this.bPosCorrected){var e;"none"==this.DIV.style.display?(e=this.adjustToNodeGetPos(),e.bottom=e.top+30,e.right=e.left+300):e=BX.pos(this.DIV);var i=BX.pos(t.Get());this.__check_intersection(e,i)&&(this.DIV.style.display="none",BX.addCustomEvent(t,"onMenuOpenerHide",BX.proxy(this.restorePosition,this)),this.bPosCorrected=!0)}},BX.CPageOpener.prototype.restorePosition=function(){BX.proxy_context&&"none"==BX.proxy_context.Get().style.display&&(this.bPosCorrected=!1,(this.PARAMS.parent.bx_over||this.PARAMS.pin)&&this.UnHide(),BX.removeCustomEvent("onMenuOpenerHide",BX.proxy(this.restorePosition,this)))},BX.CPageOpener.prototype.UnHide=function(){this.bPosCorrected||BX.CPageOpener.superclass.UnHide.apply(this,arguments)},BX.CPageOpener.prototype.Remove=function(){BX.admin.removeComponentBorder(this.PARAMS.parent),BX.userOptions.save("global","settings","page_edit_control_enable","N"),this.DIV.style.display="none"},BX.CHintSimple=function(){BX.CHintSimple.superclass.constructor.apply(this,arguments)},BX.extend(BX.CHintSimple,BX.CHint),BX.CHintSimple.prototype.Init=function(){this.DIV=document.body.appendChild(BX.create("DIV",{props:{className:"bx-tooltip-simple"},style:{display:"none"},children:[this.CONTENT=BX.create("DIV")]})),this.HINT_TITLE&&this.CONTENT.appendChild(BX.create("B",{text:this.HINT_TITLE})),this.HINT&&(this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV")).appendChild(BX.create("SPAN",{html:this.HINT}))),this.PARAMS.preventHide&&(BX.bind(this.DIV,"mouseout",BX.proxy(this.Hide,this)),BX.bind(this.DIV,"mouseover",BX.proxy(this.Show,this))),this.bInited=!0},BX.adminInformer={itemsShow:3,Init:function(t){t&&(BX.adminInformer.itemsShow=t);var e=BX("admin-informer");e&&document.body.appendChild(e),BX.addCustomEvent("onTopPanelCollapse",BX.proxy(BX.adminInformer.Close,BX.adminInformer))},Toggle:function(t){var e=BX("admin-informer");if(!e)return!1;var i=BX.pos(t);return e.style.top=parseInt(i.top)+parseInt(i.height)+7+"px",e.style.left=i.left+"px",BX.hasClass(e,"adm-informer-active")?BX.adminInformer.Hide(e):BX.adminInformer.Show(e),!1},Close:function(){BX.adminInformer.Hide(BX("admin-informer"))},OnInnerClick:function(t){var e=t.target||t.srcElement;return"a"!=e.nodeName.toLowerCase()||BX.hasClass(e,"adm-informer-footer")?BX.PreventDefault(t):!0},ToggleExtra:function(){var t=BX("adm-informer-footer");return BX.hasClass(t,"adm-informer-footer-collapsed")?this.ShowAll():this.HideExtra(),!1},ShowAll:function(){for(var t=BX("admin-informer"),e=0;e<t.children.length;e++)BX.hasClass(t.children[e],"adm-informer-item")&&"none"==t.children[e].style.display&&(t.children[e].style.display="block");var i=BX("adm-informer-footer");return void 0!==i.textContent?i.textContent=BX.message("JSADM_AI_HIDE_EXTRA"):i.innerText=BX.message("JSADM_AI_HIDE_EXTRA"),BX.removeClass(i,"adm-informer-footer-collapsed"),!1},HideExtra:function(){for(var t=BX("admin-informer"),e=0,i=BX.adminInformer.itemsShow+1;i<t.children.length;i++)BX.hasClass(t.children[i],"adm-informer-item")&&"block"==t.children[i].style.display&&(t.children[i].style.display="none",e++);var o=BX("adm-informer-footer"),n=BX.message("JSADM_AI_ALL_NOTIF")+" ("+(BX.adminInformer.itemsShow+parseInt(e))+")";return void 0!==o.textContent?o.textContent=n:o.innerText=n,BX.addClass(o,"adm-informer-footer-collapsed"),!1},Show:function(t){var e=BX("adm-header-notif-block");e&&BX.addClass(e,"adm-header-notif-block-active"),BX.onCustomEvent(t,"onBeforeAdminInformerShow"),setTimeout(BX.proxy(function(){BX.bind(document,"click",BX.proxy(BX.adminInformer.Close,BX.adminInformer))},BX.adminInformer),0),BX.addClass(t,"adm-informer-active"),setTimeout(function(){BX.addClass(t,"adm-informer-animate")},0)},Hide:function(t){var e=BX("adm-header-notif-block");e&&BX.removeClass(e,"adm-header-notif-block-active"),BX.unbind(document,"click",BX.proxy(BX.adminInformer.Close,BX.adminInformer)),BX.removeClass(t,"adm-informer-animate"),this.IsAnimationSupported()?setTimeout(function(){BX.removeClass(t,"adm-informer-active")},300):BX.removeClass(t,"adm-informer-active"),BX.onCustomEvent(t,"onAdminInformerHide")},IsAnimationSupported:function(){var t=document.body||document.documentElement;return"string"==typeof t.style.transition?!0:"string"==typeof t.style.MozTransition?!0:"string"==typeof t.style.OTransition?!0:"string"==typeof t.style.WebkitTransition?!0:"string"==typeof t.style.msTransition},SetItemHtml:function(t,e){var i=BX("adm-informer-item-html-"+t);return i?(i.innerHTML=e,!0):!1},SetItemFooter:function(t,e){var i=BX("adm-informer-item-footer-"+t);return i?(i.innerHTML=e,e?i.style.display="block":i.style.display="none",!0):!1}})}(window);
/* End */
;
; /* Start:/bitrix/js/main/session.js*/
function CBXSession()
{
	var _this = this;
	this.mess = {};
	this.timeout = null;
	this.sessid = null;
	this.bShowMess = true;
	this.dateStart = new Date();
	this.dateInput = new Date();
	this.dateCheck = new Date();
	this.activityInterval = 0;
	this.notifier = null;
	
	this.Expand = function(timeout, sessid, bShowMess, key)
	{
		this.timeout = timeout;
		this.sessid = sessid;
		this.bShowMess = bShowMess;
		this.key = key;
		
		BX.ready(function(){
			BX.bind(document, "keypress", _this.OnUserInput);
			BX.bind(document.body, "mousemove", _this.OnUserInput);
			BX.bind(document.body, "click", _this.OnUserInput);
			
			setTimeout(_this.CheckSession, (_this.timeout-60)*1000);
		})
	};
		
	this.OnUserInput = function()
	{
		var curr = new Date();
		_this.dateInput.setTime(curr.valueOf());
	};
	
	this.CheckSession = function()
	{
		var curr = new Date();
		if(curr.valueOf() - _this.dateCheck.valueOf() < 30000)
			return;

		_this.activityInterval = Math.round((_this.dateInput.valueOf() - _this.dateStart.valueOf())/1000);
		_this.dateStart.setTime(_this.dateInput.valueOf());
		var interval = (_this.activityInterval > _this.timeout? (_this.timeout-60) : _this.activityInterval);
		BX.ajax.get('/bitrix/tools/public_session.php?sessid='+_this.sessid+'&interval='+interval+'&k='+_this.key, function(data){_this.CheckResult(data)});
	};
	
	this.CheckResult = function(data)
	{
		if(data == 'SESSION_EXPIRED')
		{
			if(_this.bShowMess)
			{
				if(!_this.notifier)
				{
					_this.notifier = document.body.appendChild(BX.create('DIV', {
						props: {className: 'bx-session-message'},
						style: {top: '0px'},
						html: '<a class="bx-session-message-close" href="javascript:bxSession.Close()"></a>'+_this.mess.messSessExpired
					}));

					var windowScroll = BX.GetWindowScrollPos();
					var windowSize = BX.GetWindowInnerSize();

					_this.notifier.style.left = parseInt(windowScroll.scrollLeft + windowSize.innerWidth / 2 - parseInt(_this.notifier.clientWidth) / 2) + 'px';

					if(BX.browser.IsIE())
					{
						_this.notifier.style.top = windowScroll.scrollTop + 'px';

						BX.bind(window, 'scroll', function()
						{
							var windowScroll = BX.GetWindowScrollPos();
							_this.notifier.style.top = windowScroll.scrollTop + 'px';
						});
					}
					else
					{
						_this.notifier.style.position='fixed';
					}
				}

				_this.notifier.style.display = '';
			}
		}
		else
		{
			var timeout;
			if(data == 'SESSION_CHANGED')
				timeout = (_this.timeout-60);
			else
				timeout = (_this.activityInterval < 60? 60 : (_this.activityInterval > _this.timeout? (_this.timeout-60) : _this.activityInterval));

			var curr = new Date();
			_this.dateCheck.setTime(curr.valueOf());
			setTimeout(_this.CheckSession, timeout*1000);
		}
	};
	
	this.Close = function()
	{
		this.notifier.style.display = 'none';
	}
}

var bxSession = new CBXSession();
/* End */
;
; /* Start:/bitrix/js/main/core/core_fx.js*/
!function(t){var i={time:1,step:.05,type:"linear",allowFloat:!1};BX.fx=function(t){return this.options=t,null!=this.options.time&&(this.options.originalTime=this.options.time),null!=this.options.step&&(this.options.originalStep=this.options.step),this.__checkOptions()?(this.__go=BX.delegate(this.go,this),void(this.PARAMS={})):!1},BX.fx.prototype.__checkOptions=function(){if(typeof this.options.start!=typeof this.options.finish)return!1;null==this.options.time&&(this.options.time=i.time),null==this.options.step&&(this.options.step=i.step),null==this.options.type&&(this.options.type=i.type),null==this.options.allowFloat&&(this.options.allowFloat=i.allowFloat),this.options.time*=1e3,this.options.step*=1e3,"object"!=typeof this.options.start&&(this.options.start={_param:this.options.start},this.options.finish={_param:this.options.finish});var e;for(e in this.options.start)null==this.options.finish[e]&&(this.options.start[e]=null,delete this.options.start[e]);return BX.type.isFunction(this.options.type)||(BX.type.isFunction(t[this.options.type])?this.options.type=t[this.options.type]:BX.type.isFunction(BX.fx.RULES[this.options.type])?this.options.type=BX.fx.RULES[this.options.type]:this.options.type=BX.fx.RULES[i.type]),!0},BX.fx.prototype.go=function(){var t=(new Date).valueOf();if(t<this.PARAMS.timeFinish){for(var i in this.PARAMS.current)this.PARAMS.current[i][0]=this.options.type.apply(this,[{start_value:this.PARAMS.start[i][0],finish_value:this.PARAMS.finish[i][0],current_value:this.PARAMS.current[i][0],current_time:t-this.PARAMS.timeStart,total_time:this.options.time}]);this._callback(this.options.callback),this.paused||(this.PARAMS.timer=setTimeout(this.__go,this.options.step))}else this.stop()},BX.fx.prototype._callback=function(t){var i={};t=t||this.options.callback;for(var e in this.PARAMS.current)i[e]=(this.options.allowFloat?this.PARAMS.current[e][0]:Math.round(this.PARAMS.current[e][0]))+this.PARAMS.current[e][1];return t.apply(this,[null!=i._param?i._param:i])},BX.fx.prototype.start=function(){var t,i,e;this.PARAMS.start={},this.PARAMS.current={},this.PARAMS.finish={};for(t in this.options.start)i=+this.options.start[t],e=(this.options.start[t]+"").substring((i+"").length),this.PARAMS.start[t]=[i,e],this.PARAMS.current[t]=[i,e],this.PARAMS.finish[t]=[+this.options.finish[t],e];return this._callback(this.options.callback_start),this._callback(this.options.callback),this.PARAMS.timeStart=(new Date).valueOf(),this.PARAMS.timeFinish=this.PARAMS.timeStart+this.options.time,this.PARAMS.timer=setTimeout(BX.delegate(this.go,this),this.options.step),this},BX.fx.prototype.pause=function(){this.paused?(this.PARAMS.timer=setTimeout(this.__go,this.options.step),this.paused=!1):(clearTimeout(this.PARAMS.timer),this.paused=!0)},BX.fx.prototype.stop=function(t){t=!!t,this.PARAMS.timer&&clearTimeout(this.PARAMS.timer),null!=this.options.originalTime&&(this.options.time=this.options.originalTime),null!=this.options.originalStep&&(this.options.step=this.options.originalStep),this.PARAMS.current=this.PARAMS.finish,t||(this._callback(this.options.callback),this._callback(this.options.callback_complete))},BX.fx.RULES={linear:function(t){return t.start_value+t.current_time/t.total_time*(t.finish_value-t.start_value)},decelerated:function(t){return t.start_value+Math.sqrt(t.current_time/t.total_time)*(t.finish_value-t.start_value)},accelerated:function(t){var i=t.current_time/t.total_time;return t.start_value+i*i*(t.finish_value-t.start_value)}},BX.fx.hide=function(t,i,e){if(t=BX(t),"object"==typeof i&&null==e&&(e=i,i=e.type),!BX.type.isNotEmptyString(i))return void(t.style.display="none");var s=BX.fx.EFFECTS[i](t,e,0);return s.callback_complete=function(){e.hide!==!1&&(t.style.display="none"),e.callback_complete&&e.callback_complete.apply(this,arguments)},new BX.fx(s).start()},BX.fx.show=function(t,i,e){if(t=BX(t),"object"==typeof i&&null==e&&(e=i,i=e.type),e||(e={}),!BX.type.isNotEmptyString(i))return void(t.style.display="block");var s=BX.fx.EFFECTS[i](t,e,1);return s.callback_complete=function(){e.show!==!1&&(t.style.display="block"),e.callback_complete&&e.callback_complete.apply(this,arguments)},new BX.fx(s).start()},BX.fx.EFFECTS={scroll:function(t,e,s){e.direction||(e.direction="vertical");var o="horizontal"==e.direction?"width":"height",n=parseInt(BX.style(t,o));if(isNaN(n)&&(n=BX.pos(t)[o]),0==s)var a=n,r=e.min_height?parseInt(e.min_height):0;else var r=n,a=e.min_height?parseInt(e.min_height):0;return{start:a,finish:r,time:e.time||i.time,type:"linear",callback_start:function(){"static"==BX.style(t,"position")&&(t.style.position="relative"),t.style.overflow="hidden",t.style[o]=a+"px",t.style.display="block"},callback:function(i){t.style[o]=i+"px"}}},fade:function(t,e,s){var o={time:e.time||i.time,type:0==s?"decelerated":"linear",start:0==s?1:0,finish:0==s?0:1,allowFloat:!0};return BX.browser.IsIE()&&!BX.browser.IsIE9()?(o.start*=100,o.finish*=100,o.allowFloat=!1,o.callback_start=function(){t.style.display="block",t.style.filter+="progid:DXImageTransform.Microsoft.Alpha(opacity="+o.start+")"},o.callback=function(i){(t.filters["DXImageTransform.Microsoft.alpha"]||t.filters.alpha).opacity=i}):(o.callback_start=function(){t.style.display="block"},o.callback=function(i){t.style.opacity=t.style.KhtmlOpacity=t.style.MozOpacity=i}),o},fold:function(t,e,s){if(0==s){var o=BX.pos(t),n=o.height/(o.width+o.height),a={time:e.time||i.time,callback_complete:e.callback_complete,hide:e.hide};return e.type="scroll",e.direction="vertical",e.min_height=e.min_height||10,e.hide=!1,e.time=n*a.time,e.callback_complete=function(){t.style.whiteSpace="nowrap",e.direction="horizontal",e.min_height=null,e.time=a.time-e.time,e.hide=a.hide,e.callback_complete=a.callback_complete,BX.fx.hide(t,e)},BX.fx.EFFECTS.scroll(t,e,s)}},scale:function(t,e,s){var o={width:parseInt(BX.style(t,"width")),height:parseInt(BX.style(t,"height"))};if(isNaN(o.width)||isNaN(o.height)){var n=BX.pos(t);o={width:n.width,height:n.height}}if(0==s)var a=o,r={width:0,height:0};else var r=o,a={width:0,height:0};return{start:a,finish:r,time:e.time||i.time,type:"linear",callback_start:function(){t.style.position="relative",t.style.overflow="hidden",t.style.display="block",t.style.height=a.height+"px",t.style.width=a.width+"px"},callback:function(i){t.style.height=i.height+"px",t.style.width=i.width+"px"}}}};var e={arStack:{},arRules:{},globalAnimationId:0};BX.fx.colorAnimate=function(t,i,s){if(null!=t){animationId=t.getAttribute("data-animation-id"),null==animationId&&(animationId=e.globalAnimationId,t.setAttribute("data-animation-id",e.globalAnimationId++));for(var o=i.split(/\s*,\s*/),n=0;n<o.length;n++)if(i=o[n],e.arRules[i]){var a=0;e.arStack[animationId]?e.arStack[animationId][i]&&(a=e.arStack[animationId][i].i,clearInterval(e.arStack[animationId][i].tId)):e.arStack[animationId]={},0==a&&s||a==e.arRules[i][3]&&!s||(e.arStack[animationId][i]={i:a,element:t,tId:setInterval('BX.fx.colorAnimate.run("'+animationId+'","'+i+'")',e.arRules[i][4]),back:Boolean(s)})}}},BX.fx.colorAnimate.addRule=function(t,i,s,o,n,a,r){e.arRules[t]=[BX.util.hex2rgb(i),BX.util.hex2rgb(s),o.replace(/\-(.)/g,function(){return arguments[1].toUpperCase()}),n,a||1,r||!1]},BX.fx.colorAnimate.run=function(t,i){element=e.arStack[t][i].element,e.arStack[t][i].i+=e.arStack[t][i].back?-1:1;var s=e.arStack[t][i].i/e.arRules[i][3],o=1-s,n=e.arRules[i][0],a=e.arRules[i][1];element.style[e.arRules[i][2]]="rgb("+Math.floor(n.r*o+a.r*s)+","+Math.floor(n.g*o+a.g*s)+","+Math.floor(n.b*o+a.b*s)+")",e.arStack[t][i].i!=e.arRules[i][3]&&0!=e.arStack[t][i].i||(clearInterval(e.arStack[t][i].tId),e.arRules[i][5]&&BX.fx.colorAnimate(e.arStack[t][i].element,i,!0))},BX.easing=function(t){this.options=t,this.timer=null},BX.easing.prototype.animate=function(){if(!this.options||!this.options.start||!this.options.finish||"object"!=typeof this.options.start||"object"!=typeof this.options.finish)return null;for(var t in this.options.start)"undefined"==typeof this.options.finish[t]&&delete this.options.start[t];this.options.progress=function(t){var i={};for(var e in this.start)i[e]=Math.round(this.start[e]+(this.finish[e]-this.start[e])*t);this.step&&this.step(i)},this.animateProgress()},BX.easing.prototype.stop=function(t){this.timer&&(clearInterval(this.timer),this.timer=null,t&&this.options.complete&&this.options.complete())},BX.easing.prototype.animateProgress=function(){var t=new Date,i=this.options.transition||BX.easing.transitions.linear,e=this.options.duration||1e3;this.timer=setInterval(BX.proxy(function(){var s=(new Date-t)/e;s>1&&(s=1),this.options.progress(i(s)),1==s&&this.stop(!0)},this),this.options.delay||13)},BX.easing.makeEaseInOut=function(t){return function(i){return.5>i?t(2*i)/2:(2-t(2*(1-i)))/2}},BX.easing.makeEaseOut=function(t){return function(i){return 1-t(1-i)}},BX.easing.transitions={linear:function(t){return t},quad:function(t){return Math.pow(t,2)},cubic:function(t){return Math.pow(t,3)},quart:function(t){return Math.pow(t,4)},quint:function(t){return Math.pow(t,5)},circ:function(t){return 1-Math.sin(Math.acos(t))},back:function(t){return Math.pow(t,2)*(2.5*t-1.5)},elastic:function(t){return Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*1.5/3*t)},bounce:function(t){for(var i=0,e=1;1;i+=e,e/=2)if(t>=(7-4*i)/11)return-Math.pow((11-6*i-11*t)/4,2)+Math.pow(e,2)}}}(window);
/* End */
;
; /* Start:/bitrix/js/main/core/core_popup.js*/
!function(t){function e(t,n){if(t===!1){if(i&&i.length>0){for(var s=0;s<i.length;s++)i[s]();i=null,o=-1}}else null===i&&(i=[],o=-1,BX.defer(e)(!1)),t>o?(o=t,i=[n]):t==o&&i.push(n)}if(!BX.PopupWindowManager){BX.PopupWindowManager={_popups:[],_currentPopup:null,create:function(t,e,o){var i=-1;if(-1!==(i=this._getPopupIndex(t)))return this._popups[i];var n=new BX.PopupWindow(t,e,o);return BX.addCustomEvent(n,"onPopupShow",BX.delegate(this.onPopupShow,this)),BX.addCustomEvent(n,"onPopupClose",BX.delegate(this.onPopupClose,this)),BX.addCustomEvent(n,"onPopupDestroy",BX.delegate(this.onPopupDestroy,this)),this._popups.push(n),n},onPopupShow:function(t){null!==this._currentPopup&&this._currentPopup.close(),this._currentPopup=t},onPopupClose:function(){this._currentPopup=null},onPopupDestroy:function(t){var e=-1;-1!==(e=this._getPopupIndex(t.uniquePopupId))&&(this._popups=BX.util.deleteFromArray(this._popups,e))},getCurrentPopup:function(){return this._currentPopup},isPopupExists:function(t){return-1!==this._getPopupIndex(t)},_getPopupIndex:function(t){for(var e=-1,o=0;o<this._popups.length;o++)if(this._popups[o].uniquePopupId==t)return o;return e}},BX.PopupWindow=function(e,o,i){if(BX.onCustomEvent("onPopupWindowInit",[e,o,i]),this.uniquePopupId=e,this.params=i||{},this.params.zIndex=parseInt(this.params.zIndex),this.params.zIndex=isNaN(this.params.zIndex)?0:this.params.zIndex,this.buttons=this.params.buttons&&BX.type.isArray(this.params.buttons)?this.params.buttons:[],this.offsetTop=BX.PopupWindow.getOption("offsetTop"),this.offsetLeft=BX.PopupWindow.getOption("offsetLeft"),this.firstShow=!1,this.bordersWidth=20,this.bindElementPos=null,this.closeIcon=null,this.angle=null,this.overlay=null,this.titleBar=null,this.bindOptions="object"==typeof this.params.bindOptions?this.params.bindOptions:{},this.isAutoHideBinded=!1,this.closeByEsc=!!this.params.closeByEsc,this.isCloseByEscBinded=!1,this.dragged=!1,this.dragPageX=0,this.dragPageY=0,this.params.events)for(var n in this.params.events)BX.addCustomEvent(this,n,this.params.events[n]);this.popupContainer=document.createElement("DIV"),BX.adjust(this.popupContainer,{props:{id:e},style:{zIndex:this.getZindex(),position:"absolute",display:"none",top:"0px",left:"0px"}});var s="popup-window";i.lightShadow&&(s+=" popup-window-light"),i.titleBar&&(s+=i.lightShadow?" popup-window-titlebar-light":" popup-window-titlebar"),i.className&&BX.type.isNotEmptyString(i.className)&&(s+=" "+i.className),this.popupContainer.innerHTML=['<table class="',s,'" cellspacing="0"> 		<tr class="popup-window-top-row"> 			<td class="popup-window-left-column"><div class="popup-window-left-spacer"></div></td> 			<td class="popup-window-center-column">',i.titleBar?'<div class="popup-window-titlebar" id="popup-window-titlebar-'+e+'"></div>':"",'</td> 			<td class="popup-window-right-column"><div class="popup-window-right-spacer"></div></td> 		</tr> 		<tr class="popup-window-content-row"> 			<td class="popup-window-left-column"></td> 			<td class="popup-window-center-column"><div class="popup-window-content" id="popup-window-content-',e,'"> 			</div></td> 			<td class="popup-window-right-column"></td> 		</tr> 		<tr class="popup-window-bottom-row"> 			<td class="popup-window-left-column"></td> 			<td class="popup-window-center-column"></td> 			<td class="popup-window-right-column"></td> 		</tr> 	</table>'].join(""),document.body.appendChild(this.popupContainer),i.closeIcon&&(this.popupContainer.appendChild(this.closeIcon=BX.create("a",{props:{className:"popup-window-close-icon"+(i.titleBar?" popup-window-titlebar-close-icon":""),href:""},style:"object"==typeof i.closeIcon?i.closeIcon:{},events:{click:BX.proxy(this._onCloseIconClick,this)}})),BX.browser.IsIE()&&BX.adjust(this.closeIcon,{attrs:{hidefocus:"true"}})),this.contentContainer=BX("popup-window-content-"+e),this.titleBar=BX("popup-window-titlebar-"+e),this.buttonsContainer=this.buttonsHr=null,i.angle&&this.setAngle(i.angle),i.overlay&&this.setOverlay(i.overlay),this.setOffset(this.params),this.setBindElement(o),this.setTitleBar(this.params.titleBar),this.setContent(this.params.content),this.setButtons(this.params.buttons),this.params.bindOnResize!==!1&&BX.bind(t,"resize",BX.proxy(this._onResizeWindow,this))},BX.PopupWindow.prototype.setContent=function(t){this.contentContainer&&t&&(BX.type.isElementNode(t)?(BX.cleanNode(this.contentContainer),this.contentContainer.appendChild(t.parentNode?t.parentNode.removeChild(t):t),t.style.display="block"):BX.type.isString(t)?this.contentContainer.innerHTML=t:this.contentContainer.innerHTML="&nbsp;")},BX.PopupWindow.prototype.setButtons=function(t){if(this.buttons=t&&BX.type.isArray(t)?t:[],this.buttonsHr&&BX.remove(this.buttonsHr),this.buttonsContainer&&BX.remove(this.buttonsContainer),this.buttons.length>0&&this.contentContainer){for(var e=[],o=0;o<this.buttons.length;o++){var i=this.buttons[o];null!=i&&BX.is_subclass_of(i,BX.PopupWindowButton)&&(i.popupWindow=this,e.push(i.render()))}this.buttonsHr=this.contentContainer.parentNode.appendChild(BX.create("div",{props:{className:"popup-window-hr popup-window-buttons-hr"},children:[BX.create("i",{})]})),this.buttonsContainer=this.contentContainer.parentNode.appendChild(BX.create("div",{props:{className:"popup-window-buttons"},children:e}))}},BX.PopupWindow.prototype.setBindElement=function(t){t&&"object"==typeof t&&(BX.type.isDomNode(t)||BX.type.isNumber(t.top)&&BX.type.isNumber(t.left)?this.bindElement=t:BX.type.isNumber(t.clientX)&&BX.type.isNumber(t.clientY)&&(BX.fixEventPageXY(t),this.bindElement={left:t.pageX,top:t.pageY,bottom:t.pageY}))},BX.PopupWindow.prototype.getBindElementPos=function(t){if(BX.type.isDomNode(t))return BX.pos(t,!1);if(t&&"object"==typeof t)return BX.type.isNumber(t.bottom)||(t.bottom=t.top),t;var e=BX.GetWindowInnerSize(),o=BX.GetWindowScrollPos(),i=this.popupContainer.offsetWidth,n=this.popupContainer.offsetHeight;return{left:e.innerWidth/2-i/2+o.scrollLeft,top:e.innerHeight/2-n/2+o.scrollTop,bottom:e.innerHeight/2-n/2+o.scrollTop,windowSize:e,windowScroll:o,popupWidth:i,popupHeight:n}},BX.PopupWindow.prototype.setAngle=function(t){var e=this.params.lightShadow?"popup-window-light-angly":"popup-window-angly";if(null==this.angle){var o=this.bindOptions.position&&"top"==this.bindOptions.position?"bottom":"top",i=BX.PopupWindow.getOption("top"==o?"angleMinTop":"angleMinBottom"),n=BX.type.isNumber(t.offset)?t.offset:0,s=BX.PopupWindow.getOption("angleLeftOffset",null);n>0&&BX.type.isNumber(s)&&(n+=s-BX.PopupWindow.defaultOptions.angleLeftOffset),this.angle={element:BX.create("div",{props:{className:e+" "+e+"-"+o}}),position:o,offset:0,defaultOffset:Math.max(n,i)},this.popupContainer.appendChild(this.angle.element)}if("object"==typeof t&&t.position&&BX.util.in_array(t.position,["top","right","bottom","left","hide"])&&(BX.removeClass(this.angle.element,e+"-"+this.angle.position),BX.addClass(this.angle.element,e+"-"+t.position),this.angle.position=t.position),"object"==typeof t&&BX.type.isNumber(t.offset)){var p,a,u=t.offset;"top"==this.angle.position?(p=BX.PopupWindow.getOption("angleMinTop"),a=this.popupContainer.offsetWidth-BX.PopupWindow.getOption("angleMaxTop"),a=p>a?Math.max(p,u):a,this.angle.offset=Math.min(Math.max(p,u),a),this.angle.element.style.left=this.angle.offset+"px",this.angle.element.style.marginLeft="auto"):"bottom"==this.angle.position?(p=BX.PopupWindow.getOption("angleMinBottom"),a=this.popupContainer.offsetWidth-BX.PopupWindow.getOption("angleMaxBottom"),a=p>a?Math.max(p,u):a,this.angle.offset=Math.min(Math.max(p,u),a),this.angle.element.style.marginLeft=this.angle.offset+"px",this.angle.element.style.left="auto"):"right"==this.angle.position?(p=BX.PopupWindow.getOption("angleMinRight"),a=this.popupContainer.offsetHeight-BX.PopupWindow.getOption("angleMaxRight"),a=p>a?Math.max(p,u):a,this.angle.offset=Math.min(Math.max(p,u),a),this.angle.element.style.top=this.angle.offset+"px"):"left"==this.angle.position&&(p=BX.PopupWindow.getOption("angleMinLeft"),a=this.popupContainer.offsetHeight-BX.PopupWindow.getOption("angleMaxLeft"),a=p>a?Math.max(p,u):a,this.angle.offset=Math.min(Math.max(p,u),a),this.angle.element.style.top=this.angle.offset+"px")}},BX.PopupWindow.prototype.isTopAngle=function(){return null!=this.angle&&"top"==this.angle.position},BX.PopupWindow.prototype.isBottomAngle=function(){return null!=this.angle&&"bottom"==this.angle.position},BX.PopupWindow.prototype.isTopOrBottomAngle=function(){return null!=this.angle&&BX.util.in_array(this.angle.position,["top","bottom"])},BX.PopupWindow.prototype.getAngleHeight=function(){return this.isTopOrBottomAngle()?BX.PopupWindow.getOption("angleTopOffset"):0},BX.PopupWindow.prototype.setOffset=function(t){"object"==typeof t&&(t.offsetLeft&&BX.type.isNumber(t.offsetLeft)&&(this.offsetLeft=t.offsetLeft+BX.PopupWindow.getOption("offsetLeft")),t.offsetTop&&BX.type.isNumber(t.offsetTop)&&(this.offsetTop=t.offsetTop+BX.PopupWindow.getOption("offsetTop")))},BX.PopupWindow.prototype.setTitleBar=function(t){this.titleBar&&"object"==typeof t&&BX.type.isDomNode(t.content)&&(this.titleBar.innerHTML="",this.titleBar.appendChild(t.content),this.params.draggable&&(this.titleBar.parentNode.style.cursor="move",BX.bind(this.titleBar.parentNode,"mousedown",BX.proxy(this._startDrag,this))))},BX.PopupWindow.prototype.setClosingByEsc=function(t){t=!!t,t?(this.closeByEsc=!0,this.isCloseByEscBinded||(BX.bind(document,"keyup",BX.proxy(this._onKeyUp,this)),this.isCloseByEscBinded=!0)):(this.closeByEsc=!1,this.isCloseByEscBinded&&(BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this)),this.isCloseByEscBinded=!1))},BX.PopupWindow.prototype.setOverlay=function(t){null==this.overlay&&(this.overlay={element:BX.create("div",{props:{className:"popup-window-overlay",id:"popup-window-overlay-"+this.uniquePopupId}})},this.adjustOverlayZindex(),this.resizeOverlay(),document.body.appendChild(this.overlay.element)),t&&t.opacity&&BX.type.isNumber(t.opacity)&&t.opacity>=0&&t.opacity<=100&&(BX.browser.IsIE()&&!BX.browser.IsIE9()?this.overlay.element.style.filter="alpha(opacity="+t.opacity+")":(this.overlay.element.style.filter="none",this.overlay.element.style.opacity=parseFloat(t.opacity/100).toPrecision(3))),t&&t.backgroundColor&&(this.overlay.element.style.backgroundColor=t.backgroundColor)},BX.PopupWindow.prototype.removeOverlay=function(){null!=this.overlay&&null!=this.overlay.element&&BX.remove(this.overlay.element),this.overlay=null},BX.PopupWindow.prototype.hideOverlay=function(){null!=this.overlay&&null!=this.overlay.element&&(this.overlay.element.style.display="none")},BX.PopupWindow.prototype.showOverlay=function(){null!=this.overlay&&null!=this.overlay.element&&(this.overlay.element.style.display="block")},BX.PopupWindow.prototype.resizeOverlay=function(){if(null!=this.overlay&&null!=this.overlay.element){var t=BX.GetWindowScrollSize();this.overlay.element.style.width=t.scrollWidth+"px",this.overlay.element.style.height=t.scrollHeight+"px"}},BX.PopupWindow.prototype.getZindex=function(){return null!=this.overlay?BX.PopupWindow.getOption("popupOverlayZindex")+this.params.zIndex:BX.PopupWindow.getOption("popupZindex")+this.params.zIndex},BX.PopupWindow.prototype.adjustOverlayZindex=function(){null!=this.overlay&&null!=this.overlay.element&&(this.overlay.element.style.zIndex=parseInt(this.popupContainer.style.zIndex)-1)},BX.PopupWindow.prototype.show=function(){this.firstShow||(BX.onCustomEvent(this,"onPopupFirstShow",[this]),this.firstShow=!0),BX.onCustomEvent(this,"onPopupShow",[this]),this.showOverlay(),this.popupContainer.style.display="block",this.adjustPosition(),BX.onCustomEvent(this,"onAfterPopupShow",[this]),this.closeByEsc&&!this.isCloseByEscBinded&&(BX.bind(document,"keyup",BX.proxy(this._onKeyUp,this)),this.isCloseByEscBinded=!0),this.params.autoHide&&!this.isAutoHideBinded&&setTimeout(BX.proxy(function(){this.isAutoHideBinded=!0,BX.bind(this.popupContainer,"click",this.cancelBubble),BX.bind(document,"click",BX.proxy(this.close,this))},this),0)},BX.PopupWindow.prototype.isShown=function(){return"block"==this.popupContainer.style.display},BX.PopupWindow.prototype.cancelBubble=function(e){e||(e=t.event),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},BX.PopupWindow.prototype.close=function(t){if(this.isShown()){if(t&&!(BX.getEventButton(t)&BX.MSLEFT))return!0;BX.onCustomEvent(this,"onPopupClose",[this,t]),this.hideOverlay(),this.popupContainer.style.display="none",this.isCloseByEscBinded&&(BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this)),this.isCloseByEscBinded=!1),setTimeout(BX.proxy(this._close,this),0)}},BX.PopupWindow.prototype._close=function(){this.params.autoHide&&this.isAutoHideBinded&&(this.isAutoHideBinded=!1,BX.unbind(this.popupContainer,"click",this.cancelBubble),BX.unbind(document,"click",BX.proxy(this.close,this)))},BX.PopupWindow.prototype._onCloseIconClick=function(e){e=e||t.event,this.close(e),BX.PreventDefault(e)},BX.PopupWindow.prototype._onKeyUp=function(o){o=o||t.event,27==o.keyCode&&e(this.getZindex(),BX.proxy(this.close,this))},BX.PopupWindow.prototype.destroy=function(){BX.onCustomEvent(this,"onPopupDestroy",[this]),BX.unbindAll(this),BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this)),BX.unbind(document,"click",BX.proxy(this.close,this)),BX.unbind(document,"mousemove",BX.proxy(this._moveDrag,this)),BX.unbind(document,"mouseup",BX.proxy(this._stopDrag,this)),BX.unbind(t,"resize",BX.proxy(this._onResizeWindow,this)),BX.remove(this.popupContainer),this.removeOverlay()},BX.PopupWindow.prototype.adjustPosition=function(t){t&&"object"==typeof t&&(this.bindOptions=t);var e=this.getBindElementPos(this.bindElement);if(this.bindOptions.forceBindPosition||null==this.bindElementPos||e.top!=this.bindElementPos.top||e.left!=this.bindElementPos.left){this.bindElementPos=e;var o=e.windowSize?e.windowSize:BX.GetWindowInnerSize(),i=e.windowScroll?e.windowScroll:BX.GetWindowScrollPos(),n=e.popupWidth?e.popupWidth:this.popupContainer.offsetWidth,s=e.popupHeight?e.popupHeight:this.popupContainer.offsetHeight,p=BX.PopupWindow.getOption("angleTopOffset"),a=this.bindElementPos.left+this.offsetLeft-(this.isTopOrBottomAngle()?BX.PopupWindow.getOption("angleLeftOffset"):0);if(!this.bindOptions.forceLeft&&a+n+this.bordersWidth>=o.innerWidth+i.scrollLeft&&o.innerWidth+i.scrollLeft-n-this.bordersWidth>0){var u=a;a=o.innerWidth+i.scrollLeft-n-this.bordersWidth,this.isTopOrBottomAngle()&&this.setAngle({offset:u-a+this.angle.defaultOffset})}else this.isTopOrBottomAngle()&&this.setAngle({offset:this.angle.defaultOffset+(0>a?a:0)});0>a&&(a=0);var l=0;this.bindOptions.position&&"top"==this.bindOptions.position?(l=this.bindElementPos.top-s-this.offsetTop-(this.isBottomAngle()?p:0),0>l||!this.bindOptions.forceTop&&l<i.scrollTop?(l=this.bindElementPos.bottom+this.offsetTop,null!=this.angle&&(l+=p,this.setAngle({position:"top"}))):this.isTopAngle()?(l=l-p+BX.PopupWindow.getOption("positionTopXOffset"),this.setAngle({position:"bottom"})):l+=BX.PopupWindow.getOption("positionTopXOffset")):(l=this.bindElementPos.bottom+this.offsetTop+this.getAngleHeight(),!this.bindOptions.forceTop&&l+s>o.innerHeight+i.scrollTop&&this.bindElementPos.top-s-this.getAngleHeight()>=0?(l=this.bindElementPos.top-s,this.isTopOrBottomAngle()&&(l-=p,this.setAngle({position:"bottom"})),l+=BX.PopupWindow.getOption("positionTopXOffset")):this.isBottomAngle()&&(l+=p,this.setAngle({position:"top"}))),0>l&&(l=0),BX.adjust(this.popupContainer,{style:{top:l+"px",left:a+"px",zIndex:this.getZindex()}}),this.adjustOverlayZindex()}},BX.PopupWindow.prototype._onResizeWindow=function(){this.isShown()&&(this.adjustPosition(),null!=this.overlay&&this.resizeOverlay())},BX.PopupWindow.prototype.move=function(t,e){var o=parseInt(this.popupContainer.style.left)+t,i=parseInt(this.popupContainer.style.top)+e;if("object"==typeof this.params.draggable&&this.params.draggable.restrict){0>o&&(o=0);var n=BX.GetWindowScrollSize(),s=this.popupContainer.offsetWidth,p=this.popupContainer.offsetHeight;o>n.scrollWidth-s&&(o=n.scrollWidth-s),i>n.scrollHeight-p&&(i=n.scrollHeight-p),0>i&&(i=0)}this.popupContainer.style.left=o+"px",this.popupContainer.style.top=i+"px"},BX.PopupWindow.prototype._startDrag=function(e){return e=e||t.event,BX.fixEventPageXY(e),this.dragPageX=e.pageX,this.dragPageY=e.pageY,this.dragged=!1,BX.bind(document,"mousemove",BX.proxy(this._moveDrag,this)),BX.bind(document,"mouseup",BX.proxy(this._stopDrag,this)),document.body.setCapture&&document.body.setCapture(),document.body.ondrag=BX.False,document.body.onselectstart=BX.False,document.body.style.cursor="move",document.body.style.MozUserSelect="none",this.popupContainer.style.MozUserSelect="none",BX.PreventDefault(e)},BX.PopupWindow.prototype._moveDrag=function(e){e=e||t.event,BX.fixEventPageXY(e),this.dragPageX==e.pageX&&this.dragPageY==e.pageY||(this.move(e.pageX-this.dragPageX,e.pageY-this.dragPageY),this.dragPageX=e.pageX,this.dragPageY=e.pageY,this.dragged||(BX.onCustomEvent(this,"onPopupDragStart"),this.dragged=!0),BX.onCustomEvent(this,"onPopupDrag"))},BX.PopupWindow.prototype._stopDrag=function(t){return document.body.releaseCapture&&document.body.releaseCapture(),BX.unbind(document,"mousemove",BX.proxy(this._moveDrag,this)),BX.unbind(document,"mouseup",BX.proxy(this._stopDrag,this)),document.body.ondrag=null,document.body.onselectstart=null,document.body.style.cursor="",document.body.style.MozUserSelect="",this.popupContainer.style.MozUserSelect="",BX.onCustomEvent(this,"onPopupDragEnd"),this.dragged=!1,BX.PreventDefault(t)},BX.PopupWindow.options={},BX.PopupWindow.defaultOptions={angleLeftOffset:15,positionTopXOffset:0,angleTopOffset:8,popupZindex:1e3,popupOverlayZindex:1100,angleMinLeft:10,angleMaxLeft:10,angleMinRight:10,angleMaxRight:10,angleMinBottom:7,angleMaxBottom:25,angleMinTop:7,angleMaxTop:25,offsetLeft:0,offsetTop:0},BX.PopupWindow.setOptions=function(t){if(t&&"object"==typeof t)for(var e in t)BX.PopupWindow.options[e]=t[e]},BX.PopupWindow.getOption=function(t,e){return"undefined"!=typeof BX.PopupWindow.options[t]?BX.PopupWindow.options[t]:"undefined"!=typeof e?e:BX.PopupWindow.defaultOptions[t]},BX.PopupWindowButton=function(t){this.popupWindow=null,this.params=t||{},this.text=this.params.text||"",this.id=this.params.id||"",this.className=this.params.className||"",this.events=this.params.events||{},this.contextEvents={};for(var e in this.events)this.contextEvents[e]=BX.proxy(this.events[e],this);this.nameNode=BX.create("span",{props:{className:"popup-window-button-text"},text:this.text}),this.buttonNode=BX.create("span",{props:{className:"popup-window-button"+(this.className.length>0?" "+this.className:""),id:this.id},children:[BX.create("span",{props:{className:"popup-window-button-left"}}),this.nameNode,BX.create("span",{props:{className:"popup-window-button-right"}})],events:this.contextEvents})},BX.PopupWindowButton.prototype.render=function(){return this.buttonNode},BX.PopupWindowButton.prototype.setName=function(t){this.text=t||"",this.nameNode&&(BX.cleanNode(this.nameNode),BX.adjust(this.nameNode,{text:this.text}))},BX.PopupWindowButton.prototype.setClassName=function(t){this.buttonNode&&(BX.type.isString(this.className)&&""!=this.className&&BX.removeClass(this.buttonNode,this.className),BX.addClass(this.buttonNode,t)),this.className=t},BX.PopupWindowButtonLink=function(){BX.PopupWindowButtonLink.superclass.constructor.apply(this,arguments),this.nameNode=BX.create("span",{props:{className:"popup-window-button-link-text"},text:this.text,events:this.contextEvents}),this.buttonNode=BX.create("span",{props:{className:"popup-window-button popup-window-button-link"+(this.className.length>0?" "+this.className:""),id:this.id},children:[this.nameNode]})},BX.extend(BX.PopupWindowButtonLink,BX.PopupWindowButton),BX.PopupMenu={Data:{},currentItem:null,show:function(t,e,o,i){null!==this.currentItem&&this.currentItem.popupWindow.close(),this.currentItem=this.create(t,e,o,i),this.currentItem.popupWindow.show()},create:function(t,e,o,i){return this.Data[t]||(this.Data[t]=new BX.PopupMenuWindow(t,e,o,i)),this.Data[t]},getCurrentMenu:function(){return this.currentItem},getMenuById:function(t){return this.Data[t]?this.Data[t]:null},destroy:function(t){var e=this.getMenuById(t);e&&(this.currentItem==e&&(this.currentItem=null),e.popupWindow.destroy(),delete this.Data[t])}},BX.PopupMenuWindow=function(t,e,o,i){if(this.id=t,this.bindElement=e,this.menuItems=[],this.itemsContainer=null,o&&BX.type.isArray(o))for(var n=0;n<o.length;n++)this.__addMenuItem(o[n],null);this.params=i&&"object"==typeof i?i:{},this.popupWindow=this.__createPopup()},BX.PopupMenuWindow.prototype.__createItem=function(t,e){return e>0&&(t.layout.hr=BX.create("div",{props:{className:"popup-window-hr"},children:[BX.create("i",{})]})),t.delimiter?t.layout.item=BX.create("span",{props:{className:"popup-window-delimiter"},html:"<i></i>"}):(t.layout.item=BX.create(t.href?"a":"span",{props:{className:"menu-popup-item"+(BX.type.isNotEmptyString(t.className)?" "+t.className:" menu-popup-no-icon")},attrs:{title:t.title?t.title:"",onclick:t.onclick&&BX.type.isString(t.onclick)?t.onclick:""},events:t.onclick&&BX.type.isFunction(t.onclick)?{click:BX.proxy(this.onItemClick,{obj:this,item:t})}:null,children:[BX.create("span",{props:{className:"menu-popup-item-left"}}),BX.create("span",{props:{className:"menu-popup-item-icon"}}),t.layout.text=BX.create("span",{props:{className:"menu-popup-item-text"},html:t.text}),BX.create("span",{props:{className:"menu-popup-item-right"}})]}),t.href&&(t.layout.item.href=t.href)),t},BX.PopupMenuWindow.prototype.__createPopup=function(){for(var t=[],e=0;e<this.menuItems.length;e++)this.__createItem(this.menuItems[e],e),null!=this.menuItems[e].layout.hr&&t.push(this.menuItems[e].layout.hr),t.push(this.menuItems[e].layout.item);var o=new BX.PopupWindow("menu-popup-"+this.id,this.bindElement,{closeByEsc:"undefined"!=typeof this.params.closeByEsc?this.params.closeByEsc:!1,bindOptions:"object"==typeof this.params.bindOptions?this.params.bindOptions:{},angle:"undefined"!=typeof this.params.angle?this.params.angle:!1,zIndex:this.params.zIndex?this.params.zIndex:0,overlay:"object"==typeof this.params.overlay?this.params.overlay:null,autoHide:"undefined"!=typeof this.params.autoHide?this.params.autoHide:!0,offsetTop:this.params.offsetTop?this.params.offsetTop:1,offsetLeft:this.params.offsetLeft?this.params.offsetLeft:0,lightShadow:"undefined"!=typeof this.params.lightShadow?this.params.lightShadow:!0,content:BX.create("div",{props:{className:"menu-popup"},children:[this.itemsContainer=BX.create("div",{props:{className:"menu-popup-items"},children:t})]})});if(this.params&&this.params.events)for(var i in this.params.events)this.params.events.hasOwnProperty(i)&&BX.addCustomEvent(o,i,this.params.events[i]);return o},BX.PopupMenuWindow.prototype.onItemClick=function(e){e=e||t.event,this.item.onclick.call(this.obj,e,this.item)},BX.PopupMenuWindow.prototype.addMenuItem=function(t,e){var o=this.__addMenuItem(t,e);if(0>o)return!1;this.__createItem(t,o);var i=this.getMenuItem(e);return null!=i?(null==i.layout.hr&&(i.layout.hr=BX.create("div",{props:{className:"popup-window-hr"},children:[BX.create("i",{})]}),this.itemsContainer.insertBefore(i.layout.hr,i.layout.item)),null!=t.layout.hr&&this.itemsContainer.insertBefore(t.layout.hr,i.layout.hr),this.itemsContainer.insertBefore(t.layout.item,i.layout.hr)):(null!=t.layout.hr&&this.itemsContainer.appendChild(t.layout.hr),this.itemsContainer.appendChild(t.layout.item)),!0},BX.PopupMenuWindow.prototype.__addMenuItem=function(t,e){if(!t||!t.delimiter&&!BX.type.isNotEmptyString(t.text)||t.id&&null!=this.getMenuItem(t.id))return-1;t.layout={item:null,text:null,hr:null};var o=this.getMenuItemPosition(e);return o>=0?this.menuItems=BX.util.insertIntoArray(this.menuItems,o,t):(this.menuItems.push(t),o=this.menuItems.length-1),o},BX.PopupMenuWindow.prototype.removeMenuItem=function(t){var e=this.getMenuItem(t);if(e){for(var o=0;o<this.menuItems.length;o++)if(this.menuItems[o]==e){this.menuItems=BX.util.deleteFromArray(this.menuItems,o);break}0==o?this.menuItems[0]&&(this.menuItems[0].layout.hr.parentNode.removeChild(this.menuItems[0].layout.hr),this.menuItems[0].layout.hr=null):e.layout.hr.parentNode.removeChild(e.layout.hr),e.layout.item.parentNode.removeChild(e.layout.item),e.layout.item=null}},BX.PopupMenuWindow.prototype.getMenuItem=function(t){for(var e=0;e<this.menuItems.length;e++)if(this.menuItems[e].id&&this.menuItems[e].id==t)return this.menuItems[e];return null},BX.PopupMenuWindow.prototype.getMenuItemPosition=function(t){if(t)for(var e=0;e<this.menuItems.length;e++)if(this.menuItems[e].id&&this.menuItems[e].id==t)return e;return-1},t.BXInputPopup=function(t){this.id=t.id||"bx-inp-popup-"+Math.round(1e6*Math.random()),this.handler=t.handler||!1,this.values=t.values||!1,this.pInput=t.input,this.bValues=!!this.values,this.defaultValue=t.defaultValue||"",this.openTitle=t.openTitle||"",this.className=t.className||"",this.noMRclassName=t.noMRclassName||"ec-no-rm",this.emptyClassName=t.noMRclassName||"ec-label";var e=this;this.curInd=!1,this.bValues?(this.pInput.onfocus=this.pInput.onclick=function(t){return this.value==e.defaultValue&&(this.value="",this.className=e.className),e.ShowPopup(),BX.PreventDefault(t)},this.pInput.onblur=function(){e.bShowed&&setTimeout(function(){e.ClosePopup(!0)},200),e.OnChange()}):(this.pInput.className=this.noMRclassName,this.pInput.onblur=BX.proxy(this.OnChange,this))},BXInputPopup.prototype={ShowPopup:function(){if(!this.bShowed){var t=this;if(!this.oPopup){for(var e,o=BX.create("DIV",{props:{className:"bxecpl-loc-popup "+this.className}}),i=0,n=this.values.length;n>i;i++)e=o.appendChild(BX.create("DIV",{props:{id:"bxecmr_"+i},text:this.values[i].NAME,events:{mouseover:function(){BX.addClass(this,"bxecplloc-over")},mouseout:function(){BX.removeClass(this,"bxecplloc-over")},click:function(){var e=this.id.substr("bxecmr_".length);t.pInput.value=t.values[e].NAME,t.curInd=e,t.OnChange(),t.ClosePopup(!0)}}})),this.values[i].DESCRIPTION&&(e.title=this.values[i].DESCRIPTION),this.values[i].CLASS_NAME&&BX.addClass(e,this.values[i].CLASS_NAME),this.values[i].URL&&e.appendChild(BX.create("A",{props:{href:this.values[i].URL,className:"bxecplloc-view",target:"_blank",title:this.openTitle}}));this.oPopup=new BX.PopupWindow(this.id,this.pInput,{autoHide:!0,offsetTop:1,offsetLeft:0,lightShadow:!0,closeByEsc:!0,content:o}),BX.addCustomEvent(this.oPopup,"onPopupClose",BX.proxy(this.ClosePopup,this))}this.oPopup.show(),this.pInput.select(),this.bShowed=!0,BX.onCustomEvent(this,"onInputPopupShow",[this])}},ClosePopup:function(t){this.bShowed=!1,""==this.pInput.value&&this.OnChange(),BX.onCustomEvent(this,"onInputPopupClose",[this]),t===!0&&this.oPopup.close()},OnChange:function(){var t=this.pInput.value;this.bValues&&(""==this.pInput.value||this.pInput.value==this.defaultValue?(this.pInput.value=this.defaultValue,this.pInput.className=this.emptyClassName,t=""):this.pInput.className=""),isNaN(parseInt(this.curInd))||this.curInd!==!1&&t!=this.values[this.curInd].NAME?this.curInd=!1:this.curInd=parseInt(this.curInd),BX.onCustomEvent(this,"onInputPopupChanged",[this,this.curInd,t]),this.handler&&"function"==typeof this.handler&&this.handler({ind:this.curInd,value:t})},Set:function(t,e,o){this.curInd=t,this.curInd!==!1?this.pInput.value=this.values[this.curInd].NAME:this.pInput.value=e,o!==!1&&this.OnChange()},Get:function(t){var e=!1;return"undefined"==typeof t&&(t=this.curInd),t!==!1&&this.values[t]&&(e=this.values[t].ID),e},GetIndex:function(t){for(var e=0,o=this.values.length;o>e;e++)if(this.values[e].ID==t)return e;return!1},Deactivate:function(t){""!=this.pInput.value&&this.pInput.value!=this.defaultValue||(t?(this.pInput.value="",this.pInput.className=this.noMRclassName):this.oEC.bUseMR&&(this.pInput.value=this.defaultValue,this.pInput.className=this.emptyClassName)),this.pInput.disabled=t}};var o=-1,i=null}}(window);
/* End */
;
; /* Start:/bitrix/js/main/json/json2.min.js*/

var JSON;if(!JSON){JSON={};}
(function(){'use strict';function f(n){return n<10?'0'+n:n;}
if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+
f(this.getUTCMonth()+1)+'-'+
f(this.getUTCDate())+'T'+
f(this.getUTCHours())+':'+
f(this.getUTCMinutes())+':'+
f(this.getUTCSeconds())+'Z':null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf();};}
var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}
function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key);}
if(typeof rep==='function'){value=rep.call(holder,key,value);}
switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}
gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null';}
v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v;}
if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==='string'){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}
v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v;}}
if(typeof JSON.stringify!=='function'){JSON.stringify=function(value,replacer,space){var i;gap='';indent='';if(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' ';}}else if(typeof space==='string'){indent=space;}
rep=replacer;if(replacer&&typeof replacer!=='function'&&(typeof replacer!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify');}
return str('',{'':value});};}
if(typeof JSON.parse!=='function'){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}
return reviver.call(holder,key,value);}
text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\u'+
('0000'+a.charCodeAt(0).toString(16)).slice(-4);});}
if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j;}
throw new SyntaxError('JSON.parse');};}}());
/* End */
;
; /* Start:/bitrix/js/main/core/core_ls.js*/
;(function(window){
if (window.BX.localStorage) return;

var
	BX = window.BX,
	localStorageInstance = null,
	_prefix = null,
	_key = '_bxCurrentKey',
	_support = false;

BX.localStorage = function()
{
	this.keyChanges = {}; // flag to skip self changes in IE
	BX.bind(
		(BX.browser.IsIE() && !BX.browser.IsIE9()) ? document : window, // HATE!
		'storage',
		BX.proxy(this._onchange, this)
	);

	setInterval(BX.delegate(this._clear, this), 5000);
};

/* localStorage public interface */

BX.localStorage.checkBrowser = function()
{
	return _support;
};

BX.localStorage.set = function(key, value, ttl)
{
	return BX.localStorage.instance().set(key, value, ttl);
};

BX.localStorage.get = function(key)
{
	return BX.localStorage.instance().get(key);
};

BX.localStorage.remove = function(key)
{
	return BX.localStorage.instance().remove(key);
};

BX.localStorage.instance = function()
{
	if (!localStorageInstance)
	{
		var support = BX.localStorage.checkBrowser();
		if (support == 'native')
			localStorageInstance = new BX.localStorage();
		else if (support == 'ie8')
			localStorageInstance = new BX.localStorageIE8();
		else if (support == 'ie7')
			localStorageInstance = new BX.localStorageIE7();
		else
		{
			localStorageInstance = {
				'set' : BX.DoNothing,
				'get' : function(){return null},
				'remove' : BX.DoNothing
			};
		}
	}
	return localStorageInstance;
};

/* localStorage prototype */
BX.localStorage.prototype.prefix = function()
{
	if (!_prefix)
	{
		_prefix = 'bx' + BX.message('USER_ID') + '-' + (BX.message('SITE_ID')||'admin') + '-';
	}

	return _prefix;
};

BX.localStorage.prototype._onchange = function(e)
{
	e = e || window.event;

	if (!e.key)
		return;

	if (BX.browser.DetectIeVersion() > 0 && this.keyChanges[e.key])
	{
		this.keyChanges[e.key] = false;
		return;
	}

	if (!!e.key && e.key.substring(0,this.prefix().length) == this.prefix())
	{
		var d = {
			key: e.key.substring(this.prefix().length, e.key.length),
			value: !!e.newValue? this._decode(e.newValue.substring(11, e.newValue.length)): null,
			oldValue: !!e.oldValue? this._decode(e.oldValue.substring(11, e.oldValue.length)): null
		};

		switch(d.key)
		{
			case 'BXGCE': // BX Global Custom Event
				if (d.value)
				{
					BX.onCustomEvent(d.value.e, d.value.p);
				}
			break;
			default:
				// normal event handlers
				if (e.newValue)
					BX.onCustomEvent(window, 'onLocalStorageSet', [d]);
				if (e.oldValue && !e.newValue)
					BX.onCustomEvent(window, 'onLocalStorageRemove', [d]);

				BX.onCustomEvent(window, 'onLocalStorageChange', [d]);
			break;
		}
	}
};

BX.localStorage.prototype._clear = function()
{
	var curDate = +new Date(), key, i;

	for (i=0; i<localStorage.length; i++)
	{
		key = localStorage.key(i);
		if (key.substring(0,2) == 'bx')
		{
			var ttl = localStorage.getItem(key).split(':', 1)*1000;
			if (curDate >= ttl)
				localStorage.removeItem(key);
		}
	}
};

BX.localStorage.prototype._encode = function(value)
{
	if (typeof(value) == 'object')
		value = JSON.stringify(value);
	else
		value = value.toString();
	return value;
};

BX.localStorage.prototype._decode = function(value)
{
	var answer = null;
	if (!!value)
	{
		try {answer = JSON.parse(value);}
		catch(e) { answer = value; }
	}
	return answer;
};

BX.localStorage.prototype._trigger_error = function(e, key, value, ttl)
{
	BX.onCustomEvent(this, 'onLocalStorageError', [e, {key: key, value: value, ttl: ttl}]);
};

BX.localStorage.prototype.set = function(key, value, ttl)
{
	if (!ttl || ttl <= 0)
		ttl = 60;

	if (key == undefined || key == null || value == undefined)
		return false;

	this.keyChanges[this.prefix()+key] = true;
	try
	{
		localStorage.setItem(
			this.prefix()+key,
			(Math.round((+new Date())/1000)+ttl)+':'+this._encode(value)
		);
	}
	catch (e)
	{
		this._trigger_error(e, key, value, ttl);
	}
};

BX.localStorage.prototype.get = function(key)
{
	var storageAnswer = localStorage.getItem(this.prefix()+key);

	if (storageAnswer)
	{
		var ttl = storageAnswer.split(':', 1)*1000;
		if ((+new Date()) <= ttl)
		{
			storageAnswer = storageAnswer.substring(11, storageAnswer.length);
			return this._decode(storageAnswer);
		}
	}

	return null;
};

BX.localStorage.prototype.remove = function(key)
{
	this.keyChanges[this.prefix()+key] = true;
	localStorage.removeItem(this.prefix()+key);
};

/************** IE 7 ******************/

BX.localStorageIE7 = function()
{
	this.NS = 'BXLocalStorage';
	this.__current_state = {};
	this.keyChanges = {};

	BX.ready(BX.delegate(this._Init, this));
};

BX.extend(BX.localStorageIE7, BX.localStorage);

BX.localStorageIE7.prototype._Init = function()
{
	this.storage_element = document.body.appendChild(BX.create('DIV'));
	this.storage_element.addBehavior('#default#userData');
	this.storage_element.load(this.NS);

	var doc = this.storage_element.xmlDocument,
		len = doc.firstChild.attributes.length;

	for (var i = 0; i<len; i++)
	{
		if (!!doc.firstChild.attributes[i])
		{
			var k = doc.firstChild.attributes[i].nodeName;
			if (k.substring(0,this.prefix().length) == this.prefix())
			{
				this.__current_state[k] = doc.firstChild.attributes[i].nodeValue;
			}
		}
	}

	setInterval(BX.delegate(this._Listener, this), 500);
	setInterval(BX.delegate(this._clear, this), 5000);
};

BX.localStorageIE7.prototype._Listener = function(bInit)
{
	this.storage_element.load(this.NS);

	var doc = this.storage_element.xmlDocument,
		len = doc.firstChild.attributes.length,
		i,k,v;

	var new_state = {}, arChanges = [];

	for (i = 0; i<len; i++)
	{
		if (!!doc.firstChild.attributes[i])
		{
			k = doc.firstChild.attributes[i].nodeName;
			if (k.substring(0,this.prefix().length) == this.prefix())
			{
				v = doc.firstChild.attributes[i].nodeValue;

				if (this.__current_state[k] != v)
				{
					arChanges.push({
						key: k, newValue: v, oldValue: this.__current_state[k]
					});
				}

				new_state[k] = v;
				delete this.__current_state[k];
			}
		}
	}

	for (i in this.__current_state)
	{
		if(this.__current_state.hasOwnProperty(i))
		{
			arChanges.push({
				key: i, newValue: undefined, oldValue: this.__current_state[i]
			});
		}
	}

	this.__current_state = new_state;

	for (i=0; i<arChanges.length; i++)
	{
		this._onchange(arChanges[i]);
	}
};

BX.localStorageIE7.prototype._clear = function()
{
	this.storage_element.load(this.NS);

	var doc = this.storage_element.xmlDocument,
		len = doc.firstChild.attributes.length,
		curDate = +new Date(),
		i,k,v,ttl;

	for (i = 0; i<len; i++)
	{
		if (!!doc.firstChild.attributes[i])
		{
			k = doc.firstChild.attributes[i].nodeName;
			if (k.substring(0,2) == 'bx')
			{
				v = doc.firstChild.attributes[i].nodeValue;
				ttl = v.split(':', 1)*1000;
				if (curDate >= ttl)
				{
					doc.firstChild.removeAttribute(k)
				}
			}
		}
	}

	this.storage_element.save(this.NS);
};

BX.localStorageIE7.prototype.set = function(key, value, ttl)
{
	if (!ttl || ttl <= 0)
		ttl = 60;

	try
	{
		this.storage_element.load(this.NS);

		var doc = this.storage_element.xmlDocument;

		this.keyChanges[this.prefix()+key] = true;

		doc.firstChild.setAttribute(
			this.prefix()+key,
			(Math.round((+new Date())/1000)+ttl)+':'+this._encode(value)
		);

		this.storage_element.save(this.NS);
	}
	catch(e)
	{
		this._trigger_error(e, key, value, ttl);
	}
};

BX.localStorageIE7.prototype.get = function(key)
{
	this.storage_element.load(this.NS);
	var doc = this.storage_element.xmlDocument;

	var storageAnswer = doc.firstChild.getAttribute(this.prefix()+key);

	if (storageAnswer)
	{
		var ttl = storageAnswer.split(':', 1)*1000;
		if ((+new Date()) <= ttl)
		{
			storageAnswer = storageAnswer.substring(11, storageAnswer.length);
			return this._decode(storageAnswer);
		}
	}

	return null;
};

BX.localStorageIE7.prototype.remove = function(key)
{
	this.storage_element.load(this.NS);

	var doc = this.storage_element.xmlDocument;
	doc.firstChild.removeAttribute(this.prefix()+key);

	this.keyChanges[this.prefix()+key] = true;
	this.storage_element.save(this.NS);
};

/************** IE 8 & FF 3.6 ***************/

BX.localStorageIE8 = function()
{
	this.key = _key;

	this.currentKey = null;
	this.currentValue = null;

	BX.localStorageIE8.superclass.constructor.apply(this);
};
BX.extend(BX.localStorageIE8, BX.localStorage);

BX.localStorageIE8.prototype._onchange = function(e)
{
	if (null == this.currentKey)
	{
		this.currentKey = localStorage.getItem(this.key);
		if (this.currentKey)
		{
			this.currentValue = localStorage.getItem(this.prefix() + this.currentKey);
		}
	}
	else
	{
		e = {
			key: this.prefix() + this.currentKey,
			newValue: localStorage.getItem(this.prefix() + this.currentKey),
			oldValue: this.currentValue
		};

		this.currentKey = null;
		this.currentValue = null;

		// especially for FF3.6
		if (this.keyChanges[e.key])
		{
			this.keyChanges[e.key] = false;
			return;
		}

		BX.localStorageIE8.superclass._onchange.apply(this, [e]);
	}
};

BX.localStorageIE8.prototype.set = function(key, value, ttl)
{
	this.currentKey = null;
	this.keyChanges[this.prefix()+key] = true;

	try
	{
		localStorage.setItem(this.key, key);
		BX.localStorageIE8.superclass.set.apply(this, arguments);
	}
	catch(e)
	{
		this._trigger_error(e, key, value, ttl);
	}
};

BX.localStorageIE8.prototype.remove = function(key)
{
	this.currentKey = null;
	this.keyChanges[this.prefix()+key] = true;

	localStorage.setItem(this.key, key);
	BX.localStorageIE8.superclass.remove.apply(this, arguments);
};

/* additional functions */

BX.onGlobalCustomEvent = function(eventName, arEventParams, bSkipSelf)
{
	if (!!BX.localStorage.checkBrowser())
		BX.localStorage.set('BXGCE', {e:eventName,p:arEventParams}, 1);

	if (!bSkipSelf)
		BX.onCustomEvent(eventName, arEventParams);
};

/***************** initialize *********************/

try {
	_support = !!localStorage.setItem;
} catch(e) {}

if (_support)
{
	_support = 'native';

	// hack to check FF3.6 && IE8
	var _target = (BX.browser.IsIE() && !BX.browser.IsIE9()) ? document : window,
		_checkFFnIE8 = function(e) {
		if (typeof(e||window.event).key == 'undefined')
			_support = 'ie8';
		BX.unbind(_target, 'storage', _checkFFnIE8);
		BX.localStorage.instance();
	};
	BX.bind(_target, 'storage', _checkFFnIE8);
	localStorage.setItem(_key, null);
}
else if (BX.browser.IsIE7())
{
	_support = 'ie7';
	BX.localStorage.instance();
}

})(window);

/* End */
;